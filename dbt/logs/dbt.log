[0m14:12:51.782644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087F6D0E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882BFB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882081F70>]}


============================== 14:12:51.789644 | 36763b90-0407-4490-8f3e-7415c41a5621 ==============================
[0m14:12:51.789644 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:12:51.790643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:52.469923 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:12:52.469923 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:12:52.650921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36763b90-0407-4490-8f3e-7415c41a5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882DA4980>]}
[0m14:12:52.696920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36763b90-0407-4490-8f3e-7415c41a5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002087E9FBA70>]}
[0m14:12:52.698921 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m14:12:52.712921 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:12:52.713920 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:12:52.714921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36763b90-0407-4490-8f3e-7415c41a5621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020883709010>]}
[0m14:12:52.719922 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xc5 in position 0: invalid continuation byte
[0m14:12:52.738922 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 377, in load
    file_reader.read_files()
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 146, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 128, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt_common\clients\system.py", line 174, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc5 in position 0: invalid continuation byte

[0m14:12:52.740922 [debug] [MainThread]: Command `dbt seed` failed at 14:12:52.740922 after 1.04 seconds
[0m14:12:52.740922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882083410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882C33650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020882E4D130>]}
[0m14:12:52.741922 [debug] [MainThread]: Flushing usage events
[0m14:16:54.524732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D8D8BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9932A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9933AA0>]}


============================== 14:16:54.528729 | b05cfe6b-8822-42db-a862-85815fa0536f ==============================
[0m14:16:54.528729 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:54.529730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:54.726729 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:16:54.727730 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:16:54.868729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DA349DC0>]}
[0m14:16:54.914738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9BAE1E0>]}
[0m14:16:54.915738 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m14:16:54.926739 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:16:54.927738 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:54.928739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DA2E62A0>]}
[0m14:16:56.222498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.weather_tour_dbt.im
- models.weather_tour_dbt.dim
- models.weather_tour_dbt.analytics
[0m14:16:56.227497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DABE3D70>]}
[0m14:16:56.314498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DAB0A8A0>]}
[0m14:16:56.315498 [info ] [MainThread]: Found 3 models, 1 seed, 479 macros
[0m14:16:56.315498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D6CE1070>]}
[0m14:16:56.317497 [info ] [MainThread]: 
[0m14:16:56.318499 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:16:56.319497 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m14:16:56.386497 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:16:56.386497 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:16:56.386497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:56.390498 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:16:56.391496 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:16:56.966555 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:16:56.968557 [debug] [ThreadPool]: On list_dev: Close
[0m14:16:56.970553 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m14:16:56.976554 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:16:56.977554 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m14:16:56.977554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:56.978555 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:16:56.978555 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:16:57.168352 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.169354 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:16:57.169354 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m14:16:57.255542 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.257542 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m14:16:57.296542 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m14:16:57.307543 [debug] [MainThread]: Using redshift connection "master"
[0m14:16:57.307543 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.308544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:57.309544 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:16:57.309544 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:16:57.556849 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.557294 [debug] [MainThread]: Using redshift connection "master"
[0m14:16:57.557294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:16:57.748321 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.750322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9387140>]}
[0m14:16:57.750322 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:57.816466 [debug] [MainThread]: Using redshift connection "master"
[0m14:16:57.816466 [debug] [MainThread]: On master: BEGIN
[0m14:16:57.827515 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.828515 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.828515 [debug] [MainThread]: Using redshift connection "master"
[0m14:16:57.829515 [debug] [MainThread]: On master: COMMIT
[0m14:16:57.852559 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:57.852559 [debug] [MainThread]: On master: Close
[0m14:16:57.853571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:57.854569 [info ] [MainThread]: 
[0m14:16:57.858168 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m14:16:57.859168 [info ] [Thread-1 (]: 1 of 1 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m14:16:57.860170 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.tourist_spot'
[0m14:16:57.860170 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m14:16:57.861171 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m14:16:58.032916 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:16:58.033916 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m14:16:58.034917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:58.034917 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:16:58.035917 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:16:58.244228 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:58.245230 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:16:58.246229 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */

    create table "dev"."wnsldjqja"."tourist_spot" ("테마분류" varchar(4),"코스 아이디" integer,"관광지 아이디" integer,"지역 아이디" integer,"관광지명" varchar(64),"경도(도)" float8,"위도(도)" float8,"코스순서" integer,"이동시간" integer,"실내구분" varchar(6),"테마명" varchar(20))
[0m14:16:58.313288 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:16:59.237672 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:16:59.237672 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "지역 아이디", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s...
[0m14:17:06.165388 [debug] [Thread-1 (]: Redshift adapter: Redshift error: numeric value "4822051000" out of range for integer
[0m14:17:06.166387 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: ROLLBACK
[0m14:17:06.188390 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m14:17:06.214391 [debug] [Thread-1 (]: Database Error in seed tourist_spot (seeds\tourist_spot.csv)
  numeric value "4822051000" out of range for integer
[0m14:17:06.216389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b05cfe6b-8822-42db-a862-85815fa0536f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0DA34BB60>]}
[0m14:17:06.217389 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file wnsldjqja.tourist_spot .......................... [[31mERROR[0m in 8.36s]
[0m14:17:06.218388 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m14:17:06.219388 [debug] [MainThread]: Using redshift connection "master"
[0m14:17:06.220388 [debug] [MainThread]: On master: BEGIN
[0m14:17:06.220388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:06.221389 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:17:06.221389 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:17:06.412358 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:17:06.413359 [debug] [MainThread]: On master: COMMIT
[0m14:17:06.413359 [debug] [MainThread]: Using redshift connection "master"
[0m14:17:06.413359 [debug] [MainThread]: On master: COMMIT
[0m14:17:06.434586 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:17:06.434586 [debug] [MainThread]: On master: Close
[0m14:17:06.435586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:06.435586 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:17:06.435586 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m14:17:06.436586 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m14:17:06.436586 [info ] [MainThread]: 
[0m14:17:06.437586 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.12 seconds (10.12s).
[0m14:17:06.438587 [debug] [MainThread]: Command end result
[0m14:17:06.464817 [info ] [MainThread]: 
[0m14:17:06.465829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:06.465829 [info ] [MainThread]: 
[0m14:17:06.466830 [error] [MainThread]:   Database Error in seed tourist_spot (seeds\tourist_spot.csv)
  numeric value "4822051000" out of range for integer
[0m14:17:06.466830 [info ] [MainThread]: 
[0m14:17:06.467830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:06.468830 [debug] [MainThread]: Command `dbt seed` failed at 14:17:06.468830 after 12.03 seconds
[0m14:17:06.469830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9A80050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D9707EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0D8551EB0>]}
[0m14:17:06.469830 [debug] [MainThread]: Flushing usage events
[0m14:21:54.254256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DAADAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC206F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB883020>]}


============================== 14:21:54.258257 | 279f7687-33a6-4d3f-86c8-fae9441ac417 ==============================
[0m14:21:54.258257 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:21:54.259258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:54.457257 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:21:54.458258 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:21:54.599255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC10AA80>]}
[0m14:21:54.645256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DB11CCE0>]}
[0m14:21:54.646256 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m14:21:54.658257 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:21:54.820742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:21:54.821808 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://seeds\config.yml
[0m14:21:54.853824 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'seed_underscore_detected_as_int_example' in the 'seeds' section of file 'seeds\config.yml'
[0m14:21:54.907001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.weather_tour_dbt.im
- models.weather_tour_dbt.dim
- models.weather_tour_dbt.analytics
[0m14:21:54.912999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC160200>]}
[0m14:21:54.976999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DD512360>]}
[0m14:21:54.976999 [info ] [MainThread]: Found 3 models, 1 seed, 479 macros
[0m14:21:54.978000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC582870>]}
[0m14:21:54.980000 [info ] [MainThread]: 
[0m14:21:54.980999 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:21:54.980999 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m14:21:54.995998 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:21:54.995998 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:21:54.997000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:54.999999 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:21:55.000999 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:21:55.525947 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:21:55.528947 [debug] [ThreadPool]: On list_dev: Close
[0m14:21:55.529948 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m14:21:55.536947 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:21:55.536947 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m14:21:55.537949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:55.537949 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:21:55.537949 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:21:55.722556 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:55.723557 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:21:55.723557 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m14:21:55.782436 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:55.784437 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m14:21:55.810513 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m14:21:55.819514 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:55.819514 [debug] [MainThread]: On master: BEGIN
[0m14:21:55.820515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:55.820515 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:21:55.821514 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:21:56.023035 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:56.023035 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:56.024009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:21:56.144326 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:56.146325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DA2649E0>]}
[0m14:21:56.146325 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:56.190660 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:56.190660 [debug] [MainThread]: On master: BEGIN
[0m14:21:56.202496 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:56.202496 [debug] [MainThread]: On master: COMMIT
[0m14:21:56.203507 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:56.203507 [debug] [MainThread]: On master: COMMIT
[0m14:21:56.222660 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:56.222660 [debug] [MainThread]: On master: Close
[0m14:21:56.223660 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:56.224662 [info ] [MainThread]: 
[0m14:21:56.227661 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m14:21:56.228661 [info ] [Thread-1 (]: 1 of 1 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m14:21:56.228661 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.tourist_spot'
[0m14:21:56.229661 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m14:21:56.229661 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m14:21:56.397660 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:21:56.397660 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m14:21:56.398661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:56.398661 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:21:56.399661 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:21:56.577858 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:56.578861 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:21:56.578861 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */

    create table "dev"."wnsldjqja"."tourist_spot" ("테마분류" varchar(4),"코스 아이디" integer,"관광지 아이디" integer,"지역 아이디" integer,"관광지명" varchar(64),"경도(도)" float8,"위도(도)" float8,"코스순서" integer,"이동시간" integer,"실내구분" varchar(6),"테마명" varchar(20))
[0m14:21:56.631322 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:57.627889 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:21:57.628890 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "지역 아이디", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s...
[0m14:21:57.937646 [debug] [Thread-1 (]: Redshift adapter: Redshift error: numeric value "4822051000" out of range for integer
[0m14:21:57.938651 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: ROLLBACK
[0m14:21:57.957642 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m14:21:57.962648 [debug] [Thread-1 (]: Database Error in seed tourist_spot (seeds\tourist_spot.csv)
  numeric value "4822051000" out of range for integer
[0m14:21:57.963649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279f7687-33a6-4d3f-86c8-fae9441ac417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DD76A930>]}
[0m14:21:57.964646 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file wnsldjqja.tourist_spot .......................... [[31mERROR[0m in 1.73s]
[0m14:21:57.965650 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m14:21:57.966649 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:57.967648 [debug] [MainThread]: On master: BEGIN
[0m14:21:57.967648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:57.968647 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:21:57.968647 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:21:58.157610 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:58.158620 [debug] [MainThread]: On master: COMMIT
[0m14:21:58.158620 [debug] [MainThread]: Using redshift connection "master"
[0m14:21:58.159619 [debug] [MainThread]: On master: COMMIT
[0m14:21:58.181647 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:21:58.182650 [debug] [MainThread]: On master: Close
[0m14:21:58.183652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:58.183652 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:21:58.183652 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m14:21:58.184650 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m14:21:58.184650 [info ] [MainThread]: 
[0m14:21:58.185648 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m14:21:58.186652 [debug] [MainThread]: Command end result
[0m14:21:58.211648 [info ] [MainThread]: 
[0m14:21:58.212649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:21:58.213650 [info ] [MainThread]: 
[0m14:21:58.213650 [error] [MainThread]:   Database Error in seed tourist_spot (seeds\tourist_spot.csv)
  numeric value "4822051000" out of range for integer
[0m14:21:58.214650 [info ] [MainThread]: 
[0m14:21:58.214650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:21:58.216650 [debug] [MainThread]: Command `dbt seed` failed at 14:21:58.215650 after 4.04 seconds
[0m14:21:58.216650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DCE49D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC161E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189DC161D90>]}
[0m14:21:58.216650 [debug] [MainThread]: Flushing usage events
[0m14:32:47.578780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED5183560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED4D6A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED2A98860>]}


============================== 14:32:47.583783 | b9cf4174-9c75-4466-b7d0-a50db905e5e4 ==============================
[0m14:32:47.583783 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:32:47.584780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:47.821782 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:32:47.822781 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:32:47.988781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9cf4174-9c75-4466-b7d0-a50db905e5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED5EA5BE0>]}
[0m14:32:48.049568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9cf4174-9c75-4466-b7d0-a50db905e5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED45009B0>]}
[0m14:32:48.051718 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m14:32:48.066073 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:32:48.158098 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xc5 in position 0: invalid continuation byte
[0m14:32:48.161100 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 377, in load
    file_reader.read_files()
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 146, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 128, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt_common\clients\system.py", line 174, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc5 in position 0: invalid continuation byte

[0m14:32:48.163098 [debug] [MainThread]: Command `dbt seed` failed at 14:32:48.163098 after 0.69 seconds
[0m14:32:48.164097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED4887980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED57C79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ED6748110>]}
[0m14:32:48.164097 [debug] [MainThread]: Flushing usage events
[0m14:33:08.563224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CF9BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901D1FB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901D1F8E60>]}


============================== 14:33:08.568224 | a3c67458-4ef3-46c0-90a5-35e12e38d95e ==============================
[0m14:33:08.568224 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:33:08.569223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:08.795222 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:33:08.796226 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:33:08.957222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CF98BF0>]}
[0m14:33:09.009223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901D287D10>]}
[0m14:33:09.011222 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m14:33:09.024222 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:33:09.213750 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m14:33:09.214746 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://seeds\tourist_spot.csv
[0m14:33:09.398746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.weather_tour_dbt.dim
- models.weather_tour_dbt.analytics
- models.weather_tour_dbt.im
[0m14:33:09.404748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901E3F7F50>]}
[0m14:33:09.477746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901E425AF0>]}
[0m14:33:09.478745 [info ] [MainThread]: Found 3 models, 1 seed, 479 macros
[0m14:33:09.478745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901E43FC80>]}
[0m14:33:09.480746 [info ] [MainThread]: 
[0m14:33:09.481745 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:33:09.482746 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m14:33:09.500748 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:33:09.501747 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:33:09.501747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:09.505747 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:33:09.506745 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:33:10.079542 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m14:33:10.081542 [debug] [ThreadPool]: On list_dev: Close
[0m14:33:10.083543 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m14:33:10.090052 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:33:10.091051 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m14:33:10.091051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:10.092052 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:33:10.092052 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:33:10.287064 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.288067 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m14:33:10.288067 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m14:33:10.352064 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.353064 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m14:33:10.382064 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m14:33:10.395064 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:10.396063 [debug] [MainThread]: On master: BEGIN
[0m14:33:10.396063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:10.397064 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:33:10.397064 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:33:10.602064 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.603068 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:10.603068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m14:33:10.723066 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.725063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901E416B10>]}
[0m14:33:10.726063 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:10.769065 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:10.770064 [debug] [MainThread]: On master: BEGIN
[0m14:33:10.779063 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.779063 [debug] [MainThread]: On master: COMMIT
[0m14:33:10.780063 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:10.781064 [debug] [MainThread]: On master: COMMIT
[0m14:33:10.800063 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:10.800063 [debug] [MainThread]: On master: Close
[0m14:33:10.801063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:10.801063 [info ] [MainThread]: 
[0m14:33:10.804063 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m14:33:10.805063 [info ] [Thread-1 (]: 1 of 1 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m14:33:10.806065 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.tourist_spot'
[0m14:33:10.806065 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m14:33:10.807064 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m14:33:10.987064 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:10.988065 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m14:33:10.988065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:10.989063 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:33:10.989063 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:33:11.200228 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:11.201238 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:11.201238 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */

    create table "dev"."wnsldjqja"."tourist_spot" ("테마분류" varchar(4),"코스 아이디" integer,"관광지 아이디" integer,"시/군/구 코드" integer,"관광지명" varchar(64),"경도(도)" float8,"위도(도)" float8,"코스순서" integer,"이동시간" integer,"실내구분" varchar(6),"테마명" varchar(20))
[0m14:33:11.262171 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:12.390542 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:12.391547 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:12.666742 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:13.714751 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:13.714751 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:13.867531 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:15.044310 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:15.045309 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:15.187939 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:16.213937 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:16.213937 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:16.365437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:17.416082 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:17.417084 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:17.592769 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:18.169771 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:18.169771 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m14:33:18.348656 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:18.354657 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m14:33:18.378659 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m14:33:18.379656 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m14:33:18.380660 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m14:33:18.437401 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:18.439399 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m14:33:18.441399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c67458-4ef3-46c0-90a5-35e12e38d95e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029019DECA40>]}
[0m14:33:18.442400 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 7.64s]
[0m14:33:18.443402 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m14:33:18.445401 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:18.445401 [debug] [MainThread]: On master: BEGIN
[0m14:33:18.446405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:18.446405 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:33:18.447402 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:33:18.628725 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:18.629727 [debug] [MainThread]: On master: COMMIT
[0m14:33:18.629727 [debug] [MainThread]: Using redshift connection "master"
[0m14:33:18.630729 [debug] [MainThread]: On master: COMMIT
[0m14:33:18.648385 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m14:33:18.649383 [debug] [MainThread]: On master: Close
[0m14:33:18.650382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:18.650382 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:33:18.651384 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m14:33:18.651384 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m14:33:18.652383 [info ] [MainThread]: 
[0m14:33:18.652383 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 9.17 seconds (9.17s).
[0m14:33:18.653383 [debug] [MainThread]: Command end result
[0m14:33:18.765791 [info ] [MainThread]: 
[0m14:33:18.766854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:18.767910 [info ] [MainThread]: 
[0m14:33:18.768449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:33:18.770572 [debug] [MainThread]: Command `dbt seed` succeeded at 14:33:18.770053 after 10.30 seconds
[0m14:33:18.771162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901D26C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901D4795B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901F50FAA0>]}
[0m14:33:18.771687 [debug] [MainThread]: Flushing usage events
[0m23:22:46.304121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B73E88FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7469EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7469FC80>]}


============================== 23:22:46.311120 | db340ec0-c356-4369-ac9e-f005961d94ab ==============================
[0m23:22:46.311120 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:22:46.312123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:22:46.982259 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:22:46.983260 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:22:47.167260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7469CB90>]}
[0m23:22:47.214261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7470A6F0>]}
[0m23:22:47.216260 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m23:22:47.230261 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:22:47.295260 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:22:47.296261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B73B827E0>]}
[0m23:22:48.589702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B75A29D90>]}
[0m23:22:48.730704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B75A9EFC0>]}
[0m23:22:48.731703 [info ] [MainThread]: Found 7 models, 1 seed, 479 macros
[0m23:22:48.731703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B730DA2D0>]}
[0m23:22:48.734704 [info ] [MainThread]: 
[0m23:22:48.734704 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:22:48.739705 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m23:22:48.755702 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m23:22:48.756705 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m23:22:48.756705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:48.759703 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:48.760703 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:49.363573 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:22:49.365584 [debug] [ThreadPool]: On list_dev: Close
[0m23:22:49.368207 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m23:22:49.374206 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:22:49.375209 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m23:22:49.375209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:49.375209 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:49.376207 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:49.549899 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:49.549899 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:22:49.550900 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m23:22:49.610142 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:49.612141 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m23:22:49.639140 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m23:22:49.649142 [debug] [MainThread]: Using redshift connection "master"
[0m23:22:49.649142 [debug] [MainThread]: On master: BEGIN
[0m23:22:49.650145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:22:49.650145 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:49.651144 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:49.845699 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:49.845699 [debug] [MainThread]: Using redshift connection "master"
[0m23:22:49.846709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:22:49.971399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:49.973398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B752261B0>]}
[0m23:22:49.973398 [debug] [MainThread]: On master: ROLLBACK
[0m23:22:50.015045 [debug] [MainThread]: Using redshift connection "master"
[0m23:22:50.016046 [debug] [MainThread]: On master: BEGIN
[0m23:22:50.026319 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:50.026319 [debug] [MainThread]: On master: COMMIT
[0m23:22:50.027320 [debug] [MainThread]: Using redshift connection "master"
[0m23:22:50.027320 [debug] [MainThread]: On master: COMMIT
[0m23:22:50.045722 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:50.046724 [debug] [MainThread]: On master: Close
[0m23:22:50.047726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:22:50.048725 [info ] [MainThread]: 
[0m23:22:50.053723 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m23:22:50.053723 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_tour_api'
[0m23:22:50.054724 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m23:22:50.055723 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m23:22:50.057723 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m23:22:50.057723 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m23:22:50.058722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m23:22:50.058722 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m23:22:50.060722 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m23:22:50.061723 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m23:22:50.061723 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m23:22:50.062725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m23:22:50.062725 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m23:22:50.064724 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m23:22:50.065723 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m23:22:50.065723 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m23:22:50.066724 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m23:22:50.067722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m23:22:50.067722 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m23:22:50.073722 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:22:50.075723 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m23:22:50.120724 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:22:50.126821 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:22:50.127353 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:22:50.128383 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:22:50.128937 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:22:50.129470 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:22:50.329771 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:22:50.329771 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:22:50.330783 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), ta AS (
    SELECT
        signguCode,
        signguNm
    FROM __dbt__cte__src_tour_api
    GROUP BY signguCode, signguNm
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    ta.signguNm
FROM ts
LEFT JOIN ta ON ts.signguCode = ta.signguCode
GROUP BY ts.spotName, ts.thema, ta.signguNm
  );
[0m23:23:08.133457 [debug] [Thread-1 (]: SQL status: SUCCESS in 18.0 seconds
[0m23:23:08.139456 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.139456 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m23:23:08.207151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.225152 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:23:08.225152 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.226151 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:23:08.314285 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.315285 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.316285 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:23:08.337669 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.343669 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m23:23:08.348667 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.348667 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m23:23:08.370428 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.371430 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:23:08.372428 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.372428 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:23:08.393540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.393540 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:23:08.394549 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:23:08.406550 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.407549 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m23:23:08.426428 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m23:23:08.428428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B716E8D10>]}
[0m23:23:08.429429 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 18.36s]
[0m23:23:08.430429 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m23:23:08.430429 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m23:23:08.431428 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m23:23:08.431428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m23:23:08.432429 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m23:23:08.443428 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:23:08.444427 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m23:23:08.469427 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:23:08.476428 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:23:08.476428 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m23:23:08.477427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:08.477427 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:23:08.478428 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:23:08.681449 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.682461 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:23:08.682461 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        courseAreaId,
        spotAreaName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        signguCode,
        thema
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd in not NULL

  );
[0m23:23:08.698314 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "not"
[0m23:23:08.698314 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m23:23:08.722948 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m23:23:08.748161 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  syntax error at or near "not"
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m23:23:08.749160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db340ec0-c356-4369-ac9e-f005961d94ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B756908F0>]}
[0m23:23:08.750164 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.32s]
[0m23:23:08.751162 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m23:23:08.752162 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:23:08.753164 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m23:23:08.753164 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:23:08.754165 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:23:08.754165 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m23:23:08.755163 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:23:08.756163 [debug] [MainThread]: Using redshift connection "master"
[0m23:23:08.757164 [debug] [MainThread]: On master: BEGIN
[0m23:23:08.757164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:08.757164 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:23:08.758163 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:23:08.932170 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.933171 [debug] [MainThread]: On master: COMMIT
[0m23:23:08.933171 [debug] [MainThread]: Using redshift connection "master"
[0m23:23:08.934172 [debug] [MainThread]: On master: COMMIT
[0m23:23:08.952948 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:23:08.952948 [debug] [MainThread]: On master: Close
[0m23:23:08.953947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:08.953947 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m23:23:08.954947 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m23:23:08.954947 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m23:23:08.954947 [info ] [MainThread]: 
[0m23:23:08.955947 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 20.22 seconds (20.22s).
[0m23:23:08.956944 [debug] [MainThread]: Command end result
[0m23:23:08.985886 [info ] [MainThread]: 
[0m23:23:08.986886 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:23:08.986886 [info ] [MainThread]: 
[0m23:23:08.987887 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  syntax error at or near "not"
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m23:23:08.987887 [info ] [MainThread]: 
[0m23:23:08.988887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:23:08.990886 [debug] [MainThread]: Command `dbt run` failed at 23:23:08.990886 after 22.78 seconds
[0m23:23:08.990886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B73E88FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B746BFA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B7394F140>]}
[0m23:23:08.991887 [debug] [MainThread]: Flushing usage events
[0m23:29:48.961688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F6BC3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F5BEF860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F60CC740>]}


============================== 23:29:48.965687 | cb1fd171-6ac2-4114-9869-babaf32375ff ==============================
[0m23:29:48.965687 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:29:48.966687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:49.162687 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:29:49.163690 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:29:49.301687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F6ED4980>]}
[0m23:29:49.347689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F3AED9A0>]}
[0m23:29:49.348690 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m23:29:49.359690 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:29:49.512688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:49.513691 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m23:29:49.695688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F7FA4530>]}
[0m23:29:49.765636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F774EF30>]}
[0m23:29:49.766154 [info ] [MainThread]: Found 7 models, 1 seed, 479 macros
[0m23:29:49.766679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F7FA5B80>]}
[0m23:29:49.769194 [info ] [MainThread]: 
[0m23:29:49.770195 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:29:49.774205 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m23:29:49.790204 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m23:29:49.790204 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m23:29:49.791204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:49.794204 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:29:49.795998 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:29:50.321637 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:29:50.323639 [debug] [ThreadPool]: On list_dev: Close
[0m23:29:50.325638 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m23:29:50.331637 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:29:50.332637 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m23:29:50.332637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:50.332637 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:29:50.333638 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:29:50.524883 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:50.525885 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:29:50.525885 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m23:29:50.586048 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:50.588048 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m23:29:50.620676 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m23:29:50.631686 [debug] [MainThread]: Using redshift connection "master"
[0m23:29:50.631686 [debug] [MainThread]: On master: BEGIN
[0m23:29:50.631686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:50.632685 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:29:50.632685 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:29:50.852874 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:50.853877 [debug] [MainThread]: Using redshift connection "master"
[0m23:29:50.853877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:29:50.998793 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.000793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F777F560>]}
[0m23:29:51.000793 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:51.057310 [debug] [MainThread]: Using redshift connection "master"
[0m23:29:51.058320 [debug] [MainThread]: On master: BEGIN
[0m23:29:51.071319 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.071319 [debug] [MainThread]: On master: COMMIT
[0m23:29:51.072321 [debug] [MainThread]: Using redshift connection "master"
[0m23:29:51.072321 [debug] [MainThread]: On master: COMMIT
[0m23:29:51.101342 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.101342 [debug] [MainThread]: On master: Close
[0m23:29:51.102346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:51.103345 [info ] [MainThread]: 
[0m23:29:51.106343 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m23:29:51.106343 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_tour_api'
[0m23:29:51.107342 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m23:29:51.108343 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m23:29:51.109343 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m23:29:51.110343 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m23:29:51.110343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m23:29:51.111342 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m23:29:51.112341 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m23:29:51.113344 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m23:29:51.114344 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m23:29:51.114344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m23:29:51.115343 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m23:29:51.116342 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m23:29:51.117342 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m23:29:51.118342 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m23:29:51.118342 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m23:29:51.119342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m23:29:51.120344 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m23:29:51.125342 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.126343 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m23:29:51.170342 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.174344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.175342 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:29:51.175342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:51.176342 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:29:51.176342 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:29:51.391404 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.391404 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.392404 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), ta AS (
    SELECT
        signguCode,
        signguNm
    FROM __dbt__cte__src_tour_api
    GROUP BY signguCode, signguNm
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    ta.signguNm
FROM ts
LEFT JOIN ta ON ts.signguCode = ta.signguCode
GROUP BY ts.spotName, ts.thema, ta.signguNm
  );
[0m23:29:51.819048 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.825049 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.826050 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m23:29:51.892529 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.895530 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.896529 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m23:29:51.928403 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:51.950442 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:29:51.950968 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:51.951491 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:29:52.009053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.009574 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:52.010573 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:29:52.032166 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.038164 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m23:29:52.043164 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:52.043164 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m23:29:52.073164 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.074169 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:29:52.075167 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:52.075167 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:29:52.151935 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.151935 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:29:52.152941 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:29:52.163943 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.164955 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m23:29:52.186490 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m23:29:52.187499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F3AECAD0>]}
[0m23:29:52.188499 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 1.07s]
[0m23:29:52.189500 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m23:29:52.189500 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m23:29:52.190500 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m23:29:52.190500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m23:29:52.191501 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m23:29:52.202499 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:29:52.203500 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m23:29:52.228499 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:29:52.235499 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:29:52.236499 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m23:29:52.236499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:52.237503 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:29:52.237503 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:29:52.422493 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:29:52.423494 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:29:52.424496 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        courseAreaId,
        spotAreaName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        signguCode,
        thema
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m23:30:23.729952 [debug] [Thread-1 (]: SQL status: SUCCESS in 31.0 seconds
[0m23:30:23.731953 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m23:30:23.732953 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:30:23.732953 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m23:30:23.785045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:30:23.786046 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m23:30:23.787046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F8631F70>]}
[0m23:30:23.788046 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 31.60s]
[0m23:30:23.789046 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m23:30:23.790045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:30:23.790045 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m23:30:23.791046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m23:30:23.791046 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:30:23.797046 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:30:23.798046 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:30:23.801045 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:30:23.806044 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:30:23.807045 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m23:30:23.807045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:23.808045 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:30:23.808045 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:30:23.999192 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:30:23.999192 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:30:24.000204 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT
        baseYmd,
        tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m23:30:24.018032 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column reference "spotname" is ambiguous
[0m23:30:24.018032 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m23:30:24.041541 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m23:30:24.046545 [debug] [Thread-1 (]: Database Error in model analytics_tour_weather_by_city (models\analytics\analytics_tour_weather_by_city.sql)
  column reference "spotname" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city.sql
[0m23:30:24.046545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1fd171-6ac2-4114-9869-babaf32375ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F82ED1C0>]}
[0m23:30:24.047542 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model wnsldjqja.analytics_tour_weather_by_city . [[31mERROR[0m in 0.26s]
[0m23:30:24.048545 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:30:24.049546 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:30:24.050542 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m23:30:24.050542 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:30:24.052543 [debug] [MainThread]: Using redshift connection "master"
[0m23:30:24.053543 [debug] [MainThread]: On master: BEGIN
[0m23:30:24.053543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:24.053543 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:30:24.054542 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:30:24.228822 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:30:24.229344 [debug] [MainThread]: On master: COMMIT
[0m23:30:24.229874 [debug] [MainThread]: Using redshift connection "master"
[0m23:30:24.230403 [debug] [MainThread]: On master: COMMIT
[0m23:30:24.248933 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:30:24.248933 [debug] [MainThread]: On master: Close
[0m23:30:24.249934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:24.250934 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m23:30:24.250934 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m23:30:24.250934 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city' was properly closed.
[0m23:30:24.251934 [info ] [MainThread]: 
[0m23:30:24.251934 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 34.48 seconds (34.48s).
[0m23:30:24.253934 [debug] [MainThread]: Command end result
[0m23:30:24.281649 [info ] [MainThread]: 
[0m23:30:24.282183 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:24.282782 [info ] [MainThread]: 
[0m23:30:24.283847 [error] [MainThread]:   Database Error in model analytics_tour_weather_by_city (models\analytics\analytics_tour_weather_by_city.sql)
  column reference "spotname" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city.sql
[0m23:30:24.284377 [info ] [MainThread]: 
[0m23:30:24.284903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m23:30:24.286491 [debug] [MainThread]: Command `dbt run` failed at 23:30:24.286491 after 35.40 seconds
[0m23:30:24.287026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F6A0BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F54A0A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F6BDFB30>]}
[0m23:30:24.287653 [debug] [MainThread]: Flushing usage events
[0m23:32:17.926780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3D9123C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3D913A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3D913290>]}


============================== 23:32:17.930779 | 01d9d68f-7839-4c4a-87a6-50a33f30c887 ==============================
[0m23:32:17.930779 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:32:17.931782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:32:18.129780 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:32:18.130781 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:32:18.272781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3EE4DBE0>]}
[0m23:32:18.317780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3EDA1520>]}
[0m23:32:18.318779 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m23:32:18.329779 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:32:18.485940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:18.486978 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city.sql
[0m23:32:18.676376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3F674650>]}
[0m23:32:18.739377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3F645D60>]}
[0m23:32:18.739377 [info ] [MainThread]: Found 7 models, 1 seed, 479 macros
[0m23:32:18.740378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3E55F980>]}
[0m23:32:18.742378 [info ] [MainThread]: 
[0m23:32:18.743378 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:32:18.746376 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m23:32:18.760376 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m23:32:18.761377 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m23:32:18.761377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:18.765380 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:32:18.765380 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:32:19.265871 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:32:19.267869 [debug] [ThreadPool]: On list_dev: Close
[0m23:32:19.268871 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m23:32:19.276870 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:32:19.277871 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m23:32:19.277871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:19.278871 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:32:19.278871 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:32:19.450968 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.451968 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:32:19.451968 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m23:32:19.511059 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.513060 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m23:32:19.545972 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m23:32:19.555968 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:19.555968 [debug] [MainThread]: On master: BEGIN
[0m23:32:19.555968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:19.556969 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:32:19.556969 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:32:19.741817 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.742818 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:19.742818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:32:19.858644 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.861654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3EE7F8F0>]}
[0m23:32:19.861654 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:19.902707 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:19.903708 [debug] [MainThread]: On master: BEGIN
[0m23:32:19.911929 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.912933 [debug] [MainThread]: On master: COMMIT
[0m23:32:19.912933 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:19.912933 [debug] [MainThread]: On master: COMMIT
[0m23:32:19.930520 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:19.931521 [debug] [MainThread]: On master: Close
[0m23:32:19.931521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:19.932522 [info ] [MainThread]: 
[0m23:32:19.935520 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m23:32:19.936520 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_tour_api'
[0m23:32:19.936520 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m23:32:19.938521 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m23:32:19.939520 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m23:32:19.939520 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m23:32:19.940521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m23:32:19.940521 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m23:32:19.942523 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m23:32:19.943521 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m23:32:19.943521 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m23:32:19.943521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m23:32:19.944521 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m23:32:19.945523 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m23:32:19.946520 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m23:32:19.947521 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m23:32:19.947521 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m23:32:19.948523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m23:32:19.948523 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m23:32:19.954522 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:19.955520 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m23:32:19.998520 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.002520 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.002520 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:32:20.003521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:32:20.003521 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:32:20.004521 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:32:20.190077 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.190077 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.191079 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), ta AS (
    SELECT
        signguCode,
        signguNm
    FROM __dbt__cte__src_tour_api
    GROUP BY signguCode, signguNm
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    ta.signguNm
FROM ts
LEFT JOIN ta ON ts.signguCode = ta.signguCode
GROUP BY ts.spotName, ts.thema, ta.signguNm
  );
[0m23:32:20.367080 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.374080 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.375081 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m23:32:20.433919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.436920 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.437916 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m23:32:20.466284 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.485041 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:32:20.485041 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.486041 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:32:20.554486 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.555497 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.555497 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:32:20.574679 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.580681 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m23:32:20.585681 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.585681 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m23:32:20.606902 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.607902 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:32:20.608901 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.608901 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:32:20.664153 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.664153 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:32:20.665155 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:32:20.676151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.678243 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m23:32:20.698397 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m23:32:20.700521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3AEFC860>]}
[0m23:32:20.701080 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.75s]
[0m23:32:20.702736 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m23:32:20.703263 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m23:32:20.703802 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m23:32:20.704329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m23:32:20.704859 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m23:32:20.723565 [debug] [Thread-1 (]: Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:32:20.723565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d9d68f-7839-4c4a-87a6-50a33f30c887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3EECA900>]}
[0m23:32:20.724565 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.02s]
[0m23:32:20.725564 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m23:32:20.726564 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:32:20.727565 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m23:32:20.727565 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:32:20.728566 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:32:20.729565 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m23:32:20.729565 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:32:20.730565 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:20.731564 [debug] [MainThread]: On master: BEGIN
[0m23:32:20.731564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:20.732565 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:32:20.732565 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:32:20.924728 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.924728 [debug] [MainThread]: On master: COMMIT
[0m23:32:20.925740 [debug] [MainThread]: Using redshift connection "master"
[0m23:32:20.925740 [debug] [MainThread]: On master: COMMIT
[0m23:32:20.948947 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:32:20.949949 [debug] [MainThread]: On master: Close
[0m23:32:20.949949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:20.950948 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m23:32:20.950948 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m23:32:20.950948 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m23:32:20.951949 [info ] [MainThread]: 
[0m23:32:20.952948 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m23:32:20.953948 [debug] [MainThread]: Command end result
[0m23:32:20.981948 [info ] [MainThread]: 
[0m23:32:20.981948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:20.982948 [info ] [MainThread]: 
[0m23:32:20.983949 [error] [MainThread]:   Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:32:20.983949 [info ] [MainThread]: 
[0m23:32:20.984949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m23:32:20.985948 [debug] [MainThread]: Command `dbt run` failed at 23:32:20.985948 after 3.14 seconds
[0m23:32:20.986948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3D0522A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3D051DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3E1BCFE0>]}
[0m23:32:20.986948 [debug] [MainThread]: Flushing usage events
[0m23:35:21.310204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704AA39A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704A087830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027047B83A40>]}


============================== 23:35:21.314203 | 92cf956c-e84c-4b56-a1a7-0df5f2d30c44 ==============================
[0m23:35:21.314203 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:35:21.315208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:35:21.520204 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m23:35:21.521203 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m23:35:21.666558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704AA98A10>]}
[0m23:35:21.715533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704ACFB7D0>]}
[0m23:35:21.717118 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m23:35:21.728264 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:35:21.883666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:21.883666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:21.912665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704B7A34A0>]}
[0m23:35:21.977666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704BE1B620>]}
[0m23:35:21.978665 [info ] [MainThread]: Found 7 models, 1 seed, 479 macros
[0m23:35:21.979665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704BE1C170>]}
[0m23:35:21.980665 [info ] [MainThread]: 
[0m23:35:21.981665 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m23:35:21.984664 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m23:35:22.000664 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m23:35:22.000664 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m23:35:22.000664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:22.004664 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:22.005665 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:22.533727 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m23:35:22.535713 [debug] [ThreadPool]: On list_dev: Close
[0m23:35:22.537713 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m23:35:22.544714 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:35:22.544714 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m23:35:22.545712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:22.545712 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:22.546713 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:22.746168 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:22.746168 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m23:35:22.747178 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m23:35:22.813554 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:22.814554 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m23:35:22.843580 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m23:35:22.853581 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:22.854584 [debug] [MainThread]: On master: BEGIN
[0m23:35:22.854584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:22.854584 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:22.855584 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:23.035390 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.035390 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:23.036392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m23:35:23.152603 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.154603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704B71CE60>]}
[0m23:35:23.154603 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:23.196497 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:23.197507 [debug] [MainThread]: On master: BEGIN
[0m23:35:23.206181 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.206181 [debug] [MainThread]: On master: COMMIT
[0m23:35:23.207181 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:23.207181 [debug] [MainThread]: On master: COMMIT
[0m23:35:23.226030 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.227030 [debug] [MainThread]: On master: Close
[0m23:35:23.227030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:23.228030 [info ] [MainThread]: 
[0m23:35:23.232031 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m23:35:23.233031 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_tour_api'
[0m23:35:23.234033 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m23:35:23.236031 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m23:35:23.240031 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m23:35:23.241031 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m23:35:23.241031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m23:35:23.242031 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m23:35:23.244032 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m23:35:23.246031 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m23:35:23.246031 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m23:35:23.247031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m23:35:23.248031 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m23:35:23.250032 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m23:35:23.252031 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m23:35:23.252031 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m23:35:23.253030 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m23:35:23.254031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m23:35:23.255032 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m23:35:23.262031 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.263032 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m23:35:23.308029 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.312030 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.313029 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:35:23.313029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:35:23.314031 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:23.314031 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:23.507391 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.507391 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.508389 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), ta AS (
    SELECT
        signguCode,
        signguNm
    FROM __dbt__cte__src_tour_api
    GROUP BY signguCode, signguNm
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    ta.signguNm
FROM ts
LEFT JOIN ta ON ts.signguCode = ta.signguCode
GROUP BY ts.spotName, ts.thema, ta.signguNm
  );
[0m23:35:23.675424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.682429 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.682429 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m23:35:23.750935 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.753935 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.753935 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m23:35:23.785933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.805934 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:35:23.806935 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.806935 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:35:23.882702 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.883821 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.884354 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:35:23.906704 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.912708 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m23:35:23.919706 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.920706 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m23:35:23.945220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.946225 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:35:23.947225 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.947225 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m23:35:23.991251 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:23.992251 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m23:35:23.992251 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m23:35:24.003251 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:24.005252 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m23:35:24.024423 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m23:35:24.025423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704B74A810>]}
[0m23:35:24.026422 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.77s]
[0m23:35:24.027422 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m23:35:24.027422 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m23:35:24.028423 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m23:35:24.029424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m23:35:24.029424 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m23:35:24.043423 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:35:24.044425 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m23:35:24.070422 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m23:35:24.076422 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:35:24.076422 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m23:35:24.077422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:24.077422 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:24.078422 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:24.253217 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:24.253217 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:35:24.254219 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    signguNm,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        courseAreaId,
        spotAreaName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        signguCode,
        thema
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m23:35:29.920469 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m23:35:29.922473 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m23:35:29.923473 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m23:35:29.923473 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m23:35:29.975723 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:29.976728 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m23:35:29.977728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704BA0BAA0>]}
[0m23:35:29.978728 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 5.95s]
[0m23:35:29.979726 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m23:35:29.980726 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:35:29.980726 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m23:35:29.981727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m23:35:29.981727 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:35:29.985726 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:35:29.986727 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:35:29.989723 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:35:29.994726 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:35:29.994726 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m23:35:29.995723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:29.995723 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:29.996725 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:30.173821 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:30.173821 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m23:35:30.174820 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT
        baseYmd,
        tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        signguNm,
        baseYmd,
        tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m23:35:30.189831 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column reference "spotname" is ambiguous
[0m23:35:30.190846 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m23:35:30.208384 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m23:35:30.212384 [debug] [Thread-1 (]: Database Error in model analytics_tour_weather_by_city (models\analytics\analytics_tour_weather_by_city.sql)
  column reference "spotname" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city.sql
[0m23:35:30.212384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92cf956c-e84c-4b56-a1a7-0df5f2d30c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704BFA9220>]}
[0m23:35:30.213385 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model wnsldjqja.analytics_tour_weather_by_city . [[31mERROR[0m in 0.23s]
[0m23:35:30.214386 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m23:35:30.215385 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:35:30.216385 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m23:35:30.216385 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m23:35:30.218386 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:30.218386 [debug] [MainThread]: On master: BEGIN
[0m23:35:30.218386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:30.219387 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m23:35:30.219387 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m23:35:30.411094 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:30.412094 [debug] [MainThread]: On master: COMMIT
[0m23:35:30.412094 [debug] [MainThread]: Using redshift connection "master"
[0m23:35:30.412094 [debug] [MainThread]: On master: COMMIT
[0m23:35:30.431094 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m23:35:30.431094 [debug] [MainThread]: On master: Close
[0m23:35:30.432094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:30.432094 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m23:35:30.433094 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m23:35:30.433094 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city' was properly closed.
[0m23:35:30.433094 [info ] [MainThread]: 
[0m23:35:30.434094 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m23:35:30.435094 [debug] [MainThread]: Command end result
[0m23:35:30.464095 [info ] [MainThread]: 
[0m23:35:30.464095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:35:30.465096 [info ] [MainThread]: 
[0m23:35:30.465096 [error] [MainThread]:   Database Error in model analytics_tour_weather_by_city (models\analytics\analytics_tour_weather_by_city.sql)
  column reference "spotname" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city.sql
[0m23:35:30.466096 [info ] [MainThread]: 
[0m23:35:30.466096 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m23:35:30.467095 [debug] [MainThread]: Command `dbt run` failed at 23:35:30.467095 after 9.24 seconds
[0m23:35:30.468096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704A087830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704AB03A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027049DC0770>]}
[0m23:35:30.468096 [debug] [MainThread]: Flushing usage events
[0m23:35:36.076550 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m00:16:06.052660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59C9C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59D8A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59C3BA40>]}


============================== 00:16:06.056659 | 39e224e0-458e-4395-80ab-f9df06cc3348 ==============================
[0m00:16:06.056659 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:16:06.057659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:16:06.301422 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:16:06.302422 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:16:06.456075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59C9CD40>]}
[0m00:16:06.503074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5A14D5B0>]}
[0m00:16:06.504074 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m00:16:06.517089 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:16:06.693105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:16:06.694105 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://seeds\signgu.csv
[0m00:16:06.694105 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city.sql
[0m00:16:06.965126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5B47F020>]}
[0m00:16:07.043125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5B47F5C0>]}
[0m00:16:07.044125 [info ] [MainThread]: Found 7 models, 2 seeds, 479 macros
[0m00:16:07.045128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5B038E60>]}
[0m00:16:07.046126 [info ] [MainThread]: 
[0m00:16:07.047125 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:16:07.050126 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m00:16:07.065124 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m00:16:07.066126 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m00:16:07.066126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:07.069125 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:07.071126 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:07.617406 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:16:07.620407 [debug] [ThreadPool]: On list_dev: Close
[0m00:16:07.623409 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m00:16:07.630408 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m00:16:07.631407 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m00:16:07.631407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:07.632408 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:07.632408 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:07.811688 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:07.812689 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m00:16:07.812689 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m00:16:07.871580 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:07.873580 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m00:16:07.899902 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m00:16:07.909903 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:07.910902 [debug] [MainThread]: On master: BEGIN
[0m00:16:07.910902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:07.910902 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:07.911904 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:08.091923 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:08.092928 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:08.092928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:16:08.216681 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:08.218681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5B002120>]}
[0m00:16:08.218681 [debug] [MainThread]: On master: ROLLBACK
[0m00:16:08.260198 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:08.261197 [debug] [MainThread]: On master: BEGIN
[0m00:16:08.269663 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:08.270663 [debug] [MainThread]: On master: COMMIT
[0m00:16:08.270663 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:08.270663 [debug] [MainThread]: On master: COMMIT
[0m00:16:08.288699 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:08.288699 [debug] [MainThread]: On master: Close
[0m00:16:08.289666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:08.290673 [info ] [MainThread]: 
[0m00:16:08.293676 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m00:16:08.294675 [info ] [Thread-1 (]: 1 of 2 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m00:16:08.294675 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.signgu'
[0m00:16:08.295673 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m00:16:08.295673 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m00:16:08.743245 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:16:08.743245 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m00:16:08.744245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:16:08.744245 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:08.745247 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:08.940639 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:08.940639 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:16:08.941649 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */

    create table "dev"."wnsldjqja"."signgu" ("법정동코드" integer,"시도명" varchar(21),"시군구명" varchar(25),"읍면동명" varchar(18),"생성일자" integer)
[0m00:16:09.006417 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:09.444427 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:16:09.445427 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("법정동코드", "시도명", "시군구명", "읍면동명", "생성일자") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,...
[0m00:16:14.017289 [debug] [Thread-1 (]: Redshift adapter: Redshift error: numeric value "2600000000" out of range for integer
[0m00:16:14.018292 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: ROLLBACK
[0m00:16:14.040288 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m00:16:14.045291 [debug] [Thread-1 (]: Database Error in seed signgu (seeds\signgu.csv)
  numeric value "2600000000" out of range for integer
[0m00:16:14.046292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59183A10>]}
[0m00:16:14.046292 [error] [Thread-1 (]: 1 of 2 ERROR loading seed file wnsldjqja.signgu ................................ [[31mERROR[0m in 5.75s]
[0m00:16:14.048292 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m00:16:14.048292 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m00:16:14.049291 [info ] [Thread-1 (]: 2 of 2 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m00:16:14.050292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m00:16:14.050292 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m00:16:14.051290 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m00:16:14.167293 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:14.168293 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m00:16:14.168293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:14.169293 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:14.169293 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:14.367132 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:14.367132 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:14.368132 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m00:16:14.487212 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:15.417613 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:15.418614 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:15.722721 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:16.685722 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:16.686722 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:16.873573 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:17.785722 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:17.786725 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:17.972404 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:18.921026 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:18.921026 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:19.110758 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:20.012281 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:20.013284 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:20.217513 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:20.731519 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:20.732523 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:16:20.938504 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:20.944514 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m00:16:20.961515 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m00:16:20.962515 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:16:20.963515 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m00:16:20.981514 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:20.983517 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m00:16:20.984516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e224e0-458e-4395-80ab-f9df06cc3348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F56AEC980>]}
[0m00:16:20.985515 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 6.93s]
[0m00:16:20.986516 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m00:16:20.988514 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:20.988514 [debug] [MainThread]: On master: BEGIN
[0m00:16:20.989514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:20.989514 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:16:20.990515 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:16:21.171632 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:21.172634 [debug] [MainThread]: On master: COMMIT
[0m00:16:21.172634 [debug] [MainThread]: Using redshift connection "master"
[0m00:16:21.173634 [debug] [MainThread]: On master: COMMIT
[0m00:16:21.192692 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:16:21.192692 [debug] [MainThread]: On master: Close
[0m00:16:21.193692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:21.193692 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m00:16:21.194694 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m00:16:21.194694 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m00:16:21.194694 [info ] [MainThread]: 
[0m00:16:21.195694 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 14.15 seconds (14.15s).
[0m00:16:21.196693 [debug] [MainThread]: Command end result
[0m00:16:21.222692 [info ] [MainThread]: 
[0m00:16:21.223694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:21.223694 [info ] [MainThread]: 
[0m00:16:21.224693 [error] [MainThread]:   Database Error in seed signgu (seeds\signgu.csv)
  numeric value "2600000000" out of range for integer
[0m00:16:21.224693 [info ] [MainThread]: 
[0m00:16:21.225695 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m00:16:21.226694 [debug] [MainThread]: Command `dbt seed` failed at 00:16:21.226694 after 15.26 seconds
[0m00:16:21.226694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F54CE8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F5B032810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F59C61E50>]}
[0m00:16:21.227694 [debug] [MainThread]: Flushing usage events
[0m00:24:32.287401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F952480E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9521041A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F951095700>]}


============================== 00:24:32.291402 | 6bc06f1f-13e4-45b2-bd0a-dddfa66f7635 ==============================
[0m00:24:32.291402 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:24:32.292402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:32.496401 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:24:32.496401 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:24:32.639400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc06f1f-13e4-45b2-bd0a-dddfa66f7635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F952C31610>]}
[0m00:24:32.685401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc06f1f-13e4-45b2-bd0a-dddfa66f7635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F952275820>]}
[0m00:24:32.687401 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m00:24:32.697400 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:24:32.767401 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xbd in position 0: invalid start byte
[0m00:24:32.787400 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 377, in load
    file_reader.read_files()
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 146, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 128, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt_common\clients\system.py", line 174, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbd in position 0: invalid start byte

[0m00:24:32.788401 [debug] [MainThread]: Command `dbt seed` failed at 00:24:32.788401 after 0.58 seconds
[0m00:24:32.789401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F952480CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F952333470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F950ADB7D0>]}
[0m00:24:32.790402 [debug] [MainThread]: Flushing usage events
[0m00:24:52.763143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A3A6CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A4682120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A3850B30>]}


============================== 00:24:52.767146 | d6ea78e9-fba7-4ee1-9fbd-caa96671633d ==============================
[0m00:24:52.767146 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:24:52.768143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:52.972143 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:24:52.972143 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:24:53.116147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6ea78e9-fba7-4ee1-9fbd-caa96671633d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A15ED6A0>]}
[0m00:24:53.162146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6ea78e9-fba7-4ee1-9fbd-caa96671633d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5331550>]}
[0m00:24:53.163146 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m00:24:53.174142 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:24:53.245147 [error] [MainThread]: Encountered an error:
'utf-8' codec can't decode byte 0xbd in position 0: invalid start byte
[0m00:24:53.248147 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\manifest.py", line 377, in load
    file_reader.read_files()
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 210, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 217, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 165, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 146, in get_source_files
    fb_list.append(load_seed_source_file(fp, project.project_name))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt\parser\read_files.py", line 128, in load_seed_source_file
    file_contents = load_file_contents(match.absolute_path, strip=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\skqlt\Desktop\develop\dbt\dbt-env\Lib\site-packages\dbt_common\clients\system.py", line 174, in load_file_contents
    to_return = handle.read().decode("utf-8")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbd in position 0: invalid start byte

[0m00:24:53.250143 [debug] [MainThread]: Command `dbt seed` failed at 00:24:53.250143 after 0.57 seconds
[0m00:24:53.250143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A3851DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A541B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5A7C2C0>]}
[0m00:24:53.251147 [debug] [MainThread]: Flushing usage events
[0m00:25:03.507586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D89A1DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D8983A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D89A0F80>]}


============================== 00:25:03.511585 | c6b4d025-7de3-4daf-9b89-725b1fdae79d ==============================
[0m00:25:03.511585 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:25:03.512585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:25:03.716585 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:25:03.717586 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:25:03.861586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9830AA0>]}
[0m00:25:03.907585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D80CAD20>]}
[0m00:25:03.908585 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m00:25:03.919585 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:25:04.077586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:04.078587 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://seeds\signgu.csv
[0m00:25:04.248574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DA0F1100>]}
[0m00:25:04.315576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DA0F2EA0>]}
[0m00:25:04.315576 [info ] [MainThread]: Found 7 models, 2 seeds, 479 macros
[0m00:25:04.316574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DA001D60>]}
[0m00:25:04.318576 [info ] [MainThread]: 
[0m00:25:04.319577 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:25:04.322575 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m00:25:04.338575 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m00:25:04.339576 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m00:25:04.339576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:04.342575 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:04.343576 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:04.851402 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:25:04.853401 [debug] [ThreadPool]: On list_dev: Close
[0m00:25:04.854404 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m00:25:04.861404 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m00:25:04.862402 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m00:25:04.862402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:04.863402 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:04.863402 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:05.046530 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.047532 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m00:25:05.047532 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m00:25:05.105529 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.107528 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m00:25:05.136403 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m00:25:05.146401 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:05.146401 [debug] [MainThread]: On master: BEGIN
[0m00:25:05.147403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:05.147403 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:05.148403 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:05.325435 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.326435 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:05.326435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:25:05.442177 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.444179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D991BF80>]}
[0m00:25:05.445178 [debug] [MainThread]: On master: ROLLBACK
[0m00:25:05.487910 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:05.488919 [debug] [MainThread]: On master: BEGIN
[0m00:25:05.497918 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.498922 [debug] [MainThread]: On master: COMMIT
[0m00:25:05.498922 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:05.499919 [debug] [MainThread]: On master: COMMIT
[0m00:25:05.518520 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.519522 [debug] [MainThread]: On master: Close
[0m00:25:05.519522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:05.520521 [info ] [MainThread]: 
[0m00:25:05.523520 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m00:25:05.523520 [info ] [Thread-1 (]: 1 of 2 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m00:25:05.524521 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.signgu'
[0m00:25:05.525522 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m00:25:05.525522 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m00:25:05.555522 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:25:05.556520 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m00:25:05.556520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:25:05.557520 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:05.557520 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:05.766938 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.766938 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:25:05.767938 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */

    create table "dev"."wnsldjqja"."signgu" ("시군구코드" integer,"시도명" varchar(21),"시군구명" varchar(25))
[0m00:25:05.836937 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:05.999939 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:25:06.000936 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("시군구코드", "시도명", "시군구명") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m00:25:10.487644 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m00:25:10.493649 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.signgu"
[0m00:25:10.512654 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m00:25:10.513650 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m00:25:10.513650 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m00:25:10.593998 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:10.596712 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m00:25:10.599475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D59ECA70>]}
[0m00:25:10.600529 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file wnsldjqja.signgu .................................... [[32mINSERT 286[0m in 5.07s]
[0m00:25:10.601586 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m00:25:10.602116 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m00:25:10.603180 [info ] [Thread-1 (]: 2 of 2 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m00:25:10.604226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m00:25:10.604834 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m00:25:10.605359 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m00:25:10.786475 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:10.787479 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m00:25:10.787479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:10.788476 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:10.788476 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:10.973405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:10.973405 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:10.974405 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m00:25:11.068948 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:11.987948 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:11.988950 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:12.358887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:13.312557 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:13.312557 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:13.491182 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:14.478183 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:14.479183 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:14.666291 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:15.616073 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:15.617071 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:15.819632 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:16.760576 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:16.761574 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:16.979240 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:17.522667 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:17.523666 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m00:25:17.754338 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:17.755336 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m00:25:17.757336 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m00:25:17.758337 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m00:25:17.758337 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m00:25:17.779354 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:17.780354 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m00:25:17.781355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b4d025-7de3-4daf-9b89-725b1fdae79d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D991B260>]}
[0m00:25:17.781355 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 7.18s]
[0m00:25:17.782355 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m00:25:17.784355 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:17.784355 [debug] [MainThread]: On master: BEGIN
[0m00:25:17.785357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:17.785357 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:25:17.785357 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:25:17.964017 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:17.964017 [debug] [MainThread]: On master: COMMIT
[0m00:25:17.965020 [debug] [MainThread]: Using redshift connection "master"
[0m00:25:17.965020 [debug] [MainThread]: On master: COMMIT
[0m00:25:17.984058 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:25:17.985059 [debug] [MainThread]: On master: Close
[0m00:25:17.986059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:17.986059 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m00:25:17.987059 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m00:25:17.987059 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m00:25:17.987059 [info ] [MainThread]: 
[0m00:25:17.988059 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 13.67 seconds (13.67s).
[0m00:25:17.990058 [debug] [MainThread]: Command end result
[0m00:25:18.082060 [info ] [MainThread]: 
[0m00:25:18.083058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:18.084059 [info ] [MainThread]: 
[0m00:25:18.084059 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:25:18.086058 [debug] [MainThread]: Command `dbt seed` succeeded at 00:25:18.085059 after 14.66 seconds
[0m00:25:18.086058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D92D3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D5CE0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DA8BCA40>]}
[0m00:25:18.087059 [debug] [MainThread]: Flushing usage events
[0m01:44:42.316135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF19A3B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF19A3AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF19017200>]}


============================== 01:44:42.320138 | eeb45058-eec2-4f41-ba0f-6e412cb61930 ==============================
[0m01:44:42.320138 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:44:42.321135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:44:42.517137 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:44:42.518138 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:44:42.657137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF19A63440>]}
[0m01:44:42.702138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF163A2210>]}
[0m01:44:42.704138 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m01:44:42.715133 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:44:42.867138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m01:44:42.868138 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://models\src\src_signgu.sql
[0m01:44:42.868138 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\dim\dim_tourist_spot.sql
[0m01:44:42.868138 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city.sql
[0m01:44:42.869138 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m01:44:42.869138 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m01:44:42.870138 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m01:44:43.064134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1AA2A5A0>]}
[0m01:44:43.132477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1AF00FB0>]}
[0m01:44:43.132998 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m01:44:43.133526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1AE9F260>]}
[0m01:44:43.135667 [info ] [MainThread]: 
[0m01:44:43.136208 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:44:43.140720 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:44:43.155798 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:44:43.155798 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:44:43.156817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:43.159811 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:44:43.160811 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:44:43.664098 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m01:44:43.666097 [debug] [ThreadPool]: On list_dev: Close
[0m01:44:43.667098 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m01:44:43.673098 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m01:44:43.674098 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m01:44:43.674098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:43.675098 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:44:43.675098 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:44:43.871376 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:43.871376 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m01:44:43.872388 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m01:44:43.929271 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:43.931273 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m01:44:43.968347 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m01:44:43.978348 [debug] [MainThread]: Using redshift connection "master"
[0m01:44:43.979347 [debug] [MainThread]: On master: BEGIN
[0m01:44:43.979347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:43.980346 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:44:43.980346 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:44:44.174379 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:44.175382 [debug] [MainThread]: Using redshift connection "master"
[0m01:44:44.176381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:44:44.297253 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:44.299252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1AF09460>]}
[0m01:44:44.299252 [debug] [MainThread]: On master: ROLLBACK
[0m01:44:44.343500 [debug] [MainThread]: Using redshift connection "master"
[0m01:44:44.343500 [debug] [MainThread]: On master: BEGIN
[0m01:44:44.355510 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:44.355510 [debug] [MainThread]: On master: COMMIT
[0m01:44:44.356514 [debug] [MainThread]: Using redshift connection "master"
[0m01:44:44.356514 [debug] [MainThread]: On master: COMMIT
[0m01:44:44.375378 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:44.375378 [debug] [MainThread]: On master: Close
[0m01:44:44.376379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:44.377379 [info ] [MainThread]: 
[0m01:44:44.380379 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m01:44:44.381379 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m01:44:44.381379 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m01:44:44.383380 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m01:44:44.384379 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m01:44:44.385380 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m01:44:44.385380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m01:44:44.386379 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m01:44:44.387379 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m01:44:44.388378 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m01:44:44.389379 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m01:44:44.389379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m01:44:44.389379 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m01:44:44.391378 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m01:44:44.392378 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m01:44:44.392378 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m01:44:44.393379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m01:44:44.393379 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m01:44:44.395381 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m01:44:44.396382 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m01:44:44.397380 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m01:44:44.397380 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m01:44:44.398380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m01:44:44.399379 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m01:44:44.406379 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:44.407381 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m01:44:44.449378 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:44.453378 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:44.453378 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m01:44:44.454378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:44:44.454378 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:44:44.455378 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:44:44.643280 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:44.643280 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:44.644282 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m01:44:58.806566 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m01:44:58.812577 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:58.812577 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m01:44:58.876451 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:58.896451 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m01:44:58.897453 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:58.897453 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m01:44:58.952421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:58.953430 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:58.953430 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m01:44:58.976584 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:58.981481 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m01:44:58.986482 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:58.986482 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m01:44:59.007980 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:59.008991 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m01:44:59.008991 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:59.009989 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m01:44:59.028012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:59.029016 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m01:44:59.029016 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m01:44:59.039017 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:59.041036 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m01:44:59.061473 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m01:44:59.063474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF16AECB30>]}
[0m01:44:59.063474 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 14.66s]
[0m01:44:59.064986 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m01:44:59.065474 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m01:44:59.065474 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m01:44:59.066693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m01:44:59.067474 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m01:44:59.078473 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m01:44:59.079472 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m01:44:59.104474 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m01:44:59.112473 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m01:44:59.113473 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m01:44:59.113473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:59.114474 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:44:59.114474 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:44:59.292441 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:44:59.293454 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m01:44:59.293454 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        courseAreaId,
        spotAreaName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m01:45:04.802606 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m01:45:04.804605 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m01:45:04.804605 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m01:45:04.805622 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m01:45:04.862947 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:04.863951 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m01:45:04.864951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1B631DF0>]}
[0m01:45:04.865951 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 5.80s]
[0m01:45:04.865951 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m01:45:04.866949 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m01:45:04.867949 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m01:45:04.867949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m01:45:04.868949 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m01:45:04.871948 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:04.872950 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m01:45:04.876947 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:04.880947 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:04.881949 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m01:45:04.881949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:04.881949 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:45:04.882949 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:45:05.061861 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:05.062862 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:05.062862 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m01:45:22.122303 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m01:45:22.125302 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.126303 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m01:45:22.182328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.184327 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m01:45:22.185327 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.186328 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m01:45:22.247589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.248589 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.248589 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m01:45:22.269540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.271255 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m01:45:22.272255 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.273254 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m01:45:22.292270 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.293275 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m01:45:22.294274 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.294274 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m01:45:22.313472 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.314498 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m01:45:22.314498 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m01:45:22.323496 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.324497 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m01:45:22.341375 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m01:45:22.342376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1B630BC0>]}
[0m01:45:22.343376 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 17.47s]
[0m01:45:22.344377 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m01:45:22.345376 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m01:45:22.345376 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m01:45:22.346377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m01:45:22.346377 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m01:45:22.349377 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:22.350376 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m01:45:22.353376 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:22.356378 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:22.356378 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m01:45:22.357377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:22.357377 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:45:22.358376 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:45:22.547339 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:22.548339 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:22.548339 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m01:45:33.855177 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m01:45:33.858180 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:33.858180 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m01:45:33.921421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:33.923421 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m01:45:33.923421 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:33.924423 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m01:45:33.981097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:33.982100 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:33.983100 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m01:45:34.005129 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.007128 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m01:45:34.008127 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:34.008127 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m01:45:34.028728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.030729 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m01:45:34.030729 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:34.031728 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m01:45:34.051419 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.052424 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m01:45:34.053424 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m01:45:34.062419 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.063424 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m01:45:34.082983 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m01:45:34.083983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eeb45058-eec2-4f41-ba0f-6e412cb61930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1AE9D580>]}
[0m01:45:34.083983 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 11.74s]
[0m01:45:34.085983 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m01:45:34.086984 [debug] [MainThread]: Using redshift connection "master"
[0m01:45:34.086984 [debug] [MainThread]: On master: BEGIN
[0m01:45:34.086984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:34.087984 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:45:34.087984 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m01:45:34.286959 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.287960 [debug] [MainThread]: On master: COMMIT
[0m01:45:34.287960 [debug] [MainThread]: Using redshift connection "master"
[0m01:45:34.288959 [debug] [MainThread]: On master: COMMIT
[0m01:45:34.311437 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m01:45:34.311437 [debug] [MainThread]: On master: Close
[0m01:45:34.312437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:34.313437 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m01:45:34.313437 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m01:45:34.313437 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m01:45:34.314441 [info ] [MainThread]: 
[0m01:45:34.315437 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 51.18 seconds (51.18s).
[0m01:45:34.316439 [debug] [MainThread]: Command end result
[0m01:45:34.346775 [info ] [MainThread]: 
[0m01:45:34.347752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:34.347752 [info ] [MainThread]: 
[0m01:45:34.348752 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:45:34.349753 [debug] [MainThread]: Command `dbt run` succeeded at 01:45:34.349753 after 52.11 seconds
[0m01:45:34.350752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF19D310A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF15944BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF184DB860>]}
[0m01:45:34.350752 [debug] [MainThread]: Flushing usage events
[0m11:02:46.311354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B90FFB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B8CC454F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B90FFB680>]}


============================== 11:02:46.320492 | 3882d3ce-c5d3-40c1-9376-83e20ad2cff2 ==============================
[0m11:02:46.320492 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:02:46.320492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:47.238215 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:02:47.239217 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:02:47.474215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B8FA00E30>]}
[0m11:02:47.525214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B90D98B00>]}
[0m11:02:47.527215 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m11:02:47.542214 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:02:48.040031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:48.041177 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m11:02:48.285968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B922A9190>]}
[0m11:02:48.395770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B91B32EA0>]}
[0m11:02:48.395770 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m11:02:48.396770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B904591C0>]}
[0m11:02:48.398770 [info ] [MainThread]: 
[0m11:02:48.399770 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:02:48.403770 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m11:02:48.421871 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m11:02:48.422870 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m11:02:48.422870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:48.428871 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:02:48.429870 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:02:49.064126 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:02:49.067128 [debug] [ThreadPool]: On list_dev: Close
[0m11:02:49.069127 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m11:02:49.077126 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:02:49.078127 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m11:02:49.078127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:49.078127 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:02:49.079128 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:02:49.278363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.279365 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:02:49.279365 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m11:02:49.339364 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.341365 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m11:02:49.370363 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m11:02:49.382363 [debug] [MainThread]: Using redshift connection "master"
[0m11:02:49.383362 [debug] [MainThread]: On master: BEGIN
[0m11:02:49.383362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:49.383362 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:02:49.384363 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:02:49.608929 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.608929 [debug] [MainThread]: Using redshift connection "master"
[0m11:02:49.609928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:02:49.727788 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.729788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B91A986B0>]}
[0m11:02:49.729788 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:49.771020 [debug] [MainThread]: Using redshift connection "master"
[0m11:02:49.772020 [debug] [MainThread]: On master: BEGIN
[0m11:02:49.782021 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.782021 [debug] [MainThread]: On master: COMMIT
[0m11:02:49.782021 [debug] [MainThread]: Using redshift connection "master"
[0m11:02:49.783020 [debug] [MainThread]: On master: COMMIT
[0m11:02:49.802174 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:49.802174 [debug] [MainThread]: On master: Close
[0m11:02:49.803172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:49.804173 [info ] [MainThread]: 
[0m11:02:49.809173 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m11:02:49.810169 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m11:02:49.810169 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m11:02:49.812173 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m11:02:49.815309 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m11:02:49.816311 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m11:02:49.817311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m11:02:49.817311 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m11:02:49.819313 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m11:02:49.820311 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m11:02:49.821311 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m11:02:49.821311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m11:02:49.821311 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m11:02:49.823309 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m11:02:49.824455 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m11:02:49.825466 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m11:02:49.825466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m11:02:49.825466 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m11:02:49.827467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m11:02:49.828466 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m11:02:49.829468 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m11:02:49.830466 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m11:02:49.831466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m11:02:49.831466 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m11:02:49.838469 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:02:49.841594 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m11:02:49.892973 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:02:49.898973 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:02:49.898973 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:02:49.899974 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:49.899974 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:02:49.900974 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:02:50.103059 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:02:50.104060 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:02:50.104060 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m11:03:04.173180 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m11:03:04.179180 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.180180 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m11:03:04.247718 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.250718 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.251718 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m11:03:04.286879 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.307191 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:03:04.307191 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.308191 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:03:04.392864 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.393919 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.394921 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:03:04.418154 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.424272 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m11:03:04.429272 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.430272 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m11:03:04.455433 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.457434 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:03:04.457434 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.458435 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:03:04.501796 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.502797 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:03:04.502797 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:03:04.512797 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.515911 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m11:03:04.534970 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m11:03:04.536967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B8DBEC860>]}
[0m11:03:04.537968 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 14.70s]
[0m11:03:04.537968 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m11:03:04.538969 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m11:03:04.538969 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m11:03:04.539969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m11:03:04.541081 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m11:03:04.557279 [debug] [Thread-1 (]: Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:03:04.558280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3882d3ce-c5d3-40c1-9376-83e20ad2cff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B92727440>]}
[0m11:03:04.558280 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.02s]
[0m11:03:04.559281 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m11:03:04.561283 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:03:04.561283 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m11:03:04.562280 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:03:04.563281 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:03:04.563281 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m11:03:04.564280 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:03:04.565413 [debug] [MainThread]: Using redshift connection "master"
[0m11:03:04.565413 [debug] [MainThread]: On master: BEGIN
[0m11:03:04.566414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:04.566414 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:03:04.567507 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:03:04.763784 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.763784 [debug] [MainThread]: On master: COMMIT
[0m11:03:04.764783 [debug] [MainThread]: Using redshift connection "master"
[0m11:03:04.764783 [debug] [MainThread]: On master: COMMIT
[0m11:03:04.786871 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:03:04.786871 [debug] [MainThread]: On master: Close
[0m11:03:04.787868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:04.787868 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m11:03:04.787868 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m11:03:04.788868 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m11:03:04.788868 [info ] [MainThread]: 
[0m11:03:04.789869 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 16.39 seconds (16.39s).
[0m11:03:04.790871 [debug] [MainThread]: Command end result
[0m11:03:04.822575 [info ] [MainThread]: 
[0m11:03:04.822575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:03:04.823576 [info ] [MainThread]: 
[0m11:03:04.824575 [error] [MainThread]:   Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:03:04.825574 [info ] [MainThread]: 
[0m11:03:04.825574 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m11:03:04.827574 [debug] [MainThread]: Command `dbt run` failed at 11:03:04.827574 after 18.61 seconds
[0m11:03:04.827574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B904831A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B90FF9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B90FF9CA0>]}
[0m11:03:04.828575 [debug] [MainThread]: Flushing usage events
[0m11:03:10.447920 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:04:18.694010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FAC81040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156F9A2ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156F9A0AB40>]}


============================== 11:04:18.698012 | 36e6265b-50ae-43ea-bf13-8144ee46ab24 ==============================
[0m11:04:18.698012 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:04:18.699012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:04:18.890995 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:04:18.892056 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:04:19.028652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FA898E00>]}
[0m11:04:19.072836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156F7927110>]}
[0m11:04:19.074837 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m11:04:19.084837 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:04:19.232405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:19.233405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:19.262482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FB8080E0>]}
[0m11:04:19.328125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FBA1B290>]}
[0m11:04:19.328125 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m11:04:19.329122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FAED0170>]}
[0m11:04:19.330123 [info ] [MainThread]: 
[0m11:04:19.331123 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:04:19.335123 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m11:04:19.350248 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m11:04:19.350248 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m11:04:19.351249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:19.354248 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:19.355248 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:19.908148 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:04:19.910149 [debug] [ThreadPool]: On list_dev: Close
[0m11:04:19.912149 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m11:04:19.919408 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:04:19.919408 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m11:04:19.920409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:19.920409 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:19.920409 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:20.095944 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.095944 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:04:20.096956 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m11:04:20.154851 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.155862 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m11:04:20.181512 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m11:04:20.193514 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:20.193514 [debug] [MainThread]: On master: BEGIN
[0m11:04:20.194514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:20.194514 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:20.195513 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:20.376508 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.377509 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:20.377509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:04:20.487283 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.489282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FB808050>]}
[0m11:04:20.490282 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:20.537464 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:20.537464 [debug] [MainThread]: On master: BEGIN
[0m11:04:20.547919 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.548920 [debug] [MainThread]: On master: COMMIT
[0m11:04:20.548920 [debug] [MainThread]: Using redshift connection "master"
[0m11:04:20.549920 [debug] [MainThread]: On master: COMMIT
[0m11:04:20.566158 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.567159 [debug] [MainThread]: On master: Close
[0m11:04:20.567159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:20.568189 [info ] [MainThread]: 
[0m11:04:20.572291 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m11:04:20.573292 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m11:04:20.573952 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m11:04:20.574952 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m11:04:20.575951 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m11:04:20.576952 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m11:04:20.576952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m11:04:20.576952 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m11:04:20.578950 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m11:04:20.579951 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m11:04:20.579951 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m11:04:20.580950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m11:04:20.580950 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m11:04:20.582950 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m11:04:20.583951 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m11:04:20.583951 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m11:04:20.584951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m11:04:20.584951 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m11:04:20.585956 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m11:04:20.586951 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m11:04:20.587950 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m11:04:20.587950 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m11:04:20.588951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m11:04:20.588951 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m11:04:20.595196 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:20.596194 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m11:04:20.638341 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:20.641416 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:20.642450 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:04:20.642450 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:20.643452 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:20.643452 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:20.829481 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:20.830806 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:20.830806 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m11:04:21.108982 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.114984 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.114984 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m11:04:21.175985 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.193220 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:04:21.194465 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.194465 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:04:21.273779 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.274780 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.275779 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:04:21.292746 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.299747 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m11:04:21.304747 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.304747 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m11:04:21.323916 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.324932 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:04:21.325926 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.325926 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:04:21.345047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.345047 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:04:21.346045 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:04:21.355694 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.357703 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m11:04:21.376436 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m11:04:21.378448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FBEA80E0>]}
[0m11:04:21.378448 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.79s]
[0m11:04:21.379447 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m11:04:21.380451 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m11:04:21.380451 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m11:04:21.381450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m11:04:21.381450 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m11:04:21.395450 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m11:04:21.397513 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m11:04:21.422885 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m11:04:21.429885 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m11:04:21.429885 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m11:04:21.430887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:21.430887 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:21.431887 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:21.601727 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:21.601727 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m11:04:21.601727 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m11:04:44.792798 [debug] [Thread-1 (]: SQL status: SUCCESS in 23.0 seconds
[0m11:04:44.794804 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m11:04:44.795804 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m11:04:44.795804 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m11:04:44.852338 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:44.853337 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m11:04:44.854336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FB3DC7D0>]}
[0m11:04:44.854336 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 23.47s]
[0m11:04:44.855338 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m11:04:44.856339 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:04:44.857339 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m11:04:44.857339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m11:04:44.858337 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:04:44.861336 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:04:44.863782 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:04:44.866855 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:04:44.871944 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:04:44.872943 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m11:04:44.872943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:44.873944 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:04:44.873944 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:04:45.063249 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:04:45.063249 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:04:45.064259 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m11:05:06.079426 [debug] [Thread-1 (]: SQL status: SUCCESS in 21.0 seconds
[0m11:05:06.082502 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.083502 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m11:05:06.153334 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.154357 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m11:05:06.155357 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.156357 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m11:05:06.212661 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.212661 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.213672 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m11:05:06.238261 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.240284 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m11:05:06.241332 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.242344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m11:05:06.264541 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.265588 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m11:05:06.266620 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.266662 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m11:05:06.287433 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.287433 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m11:05:06.288456 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m11:05:06.303160 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.304184 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m11:05:06.326387 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m11:05:06.327375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FB869040>]}
[0m11:05:06.328473 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 21.47s]
[0m11:05:06.329486 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:05:06.330605 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:06.330605 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m11:05:06.331618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m11:05:06.331618 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:06.336620 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:06.337621 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:06.341943 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:06.345648 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:06.346650 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m11:05:06.346650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:05:06.347650 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:06.347650 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:06.519952 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:06.520956 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:06.520956 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m11:05:17.949551 [debug] [Thread-1 (]: SQL status: SUCCESS in 11.0 seconds
[0m11:05:17.953574 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:17.953574 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.007662 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.009734 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m11:05:18.009734 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.010737 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m11:05:18.062407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.062407 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.063430 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m11:05:18.080574 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.083657 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m11:05:18.084659 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.084659 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m11:05:18.103710 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.104731 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m11:05:18.104731 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.105733 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m11:05:18.123600 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.123600 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m11:05:18.124621 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m11:05:18.134845 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.134845 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m11:05:18.153005 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m11:05:18.153005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e6265b-50ae-43ea-bf13-8144ee46ab24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FBBA6DB0>]}
[0m11:05:18.154137 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 11.82s]
[0m11:05:18.155145 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:18.156135 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:18.157145 [debug] [MainThread]: On master: BEGIN
[0m11:05:18.157145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:18.157145 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:18.158145 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:18.333597 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.333597 [debug] [MainThread]: On master: COMMIT
[0m11:05:18.334620 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:18.334620 [debug] [MainThread]: On master: COMMIT
[0m11:05:18.353433 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:18.354440 [debug] [MainThread]: On master: Close
[0m11:05:18.355439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:18.355439 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m11:05:18.355439 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m11:05:18.356439 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m11:05:18.356439 [info ] [MainThread]: 
[0m11:05:18.357441 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 59.03 seconds (59.03s).
[0m11:05:18.358440 [debug] [MainThread]: Command end result
[0m11:05:18.386862 [info ] [MainThread]: 
[0m11:05:18.387862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:18.387862 [info ] [MainThread]: 
[0m11:05:18.388863 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:05:18.389983 [debug] [MainThread]: Command `dbt run` succeeded at 11:05:18.389983 after 59.77 seconds
[0m11:05:18.391015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FAA151C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156F74C94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156FA0121E0>]}
[0m11:05:18.391015 [debug] [MainThread]: Flushing usage events
[0m11:05:33.879448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001494C7D1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001494C6A38F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001494FDFB920>]}


============================== 11:05:33.883446 | b86e2e54-6e10-4098-8abd-f32e97056f55 ==============================
[0m11:05:33.883446 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:05:33.884447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:05:34.075841 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:05:34.076840 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:05:34.215309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014950733D70>]}
[0m11:05:34.260659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001494FCBF170>]}
[0m11:05:34.261659 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m11:05:34.271847 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:05:34.421158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:34.422158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:34.450490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149508C9AF0>]}
[0m11:05:34.517085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014950F21880>]}
[0m11:05:34.517085 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m11:05:34.518167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014950049460>]}
[0m11:05:34.520167 [info ] [MainThread]: 
[0m11:05:34.521170 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m11:05:34.524167 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m11:05:34.539390 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m11:05:34.540547 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m11:05:34.540547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:34.543574 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:34.544575 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:35.051534 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m11:05:35.054544 [debug] [ThreadPool]: On list_dev: Close
[0m11:05:35.055545 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m11:05:35.061722 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:05:35.062724 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m11:05:35.062724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:35.063725 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:35.063725 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:35.241874 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.241874 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m11:05:35.242908 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m11:05:35.298788 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.299800 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m11:05:35.326463 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m11:05:35.337538 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:35.338537 [debug] [MainThread]: On master: BEGIN
[0m11:05:35.338537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:35.338537 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:35.339538 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:35.512331 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.513332 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:35.513332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m11:05:35.623571 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.625792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149508CA450>]}
[0m11:05:35.626793 [debug] [MainThread]: On master: ROLLBACK
[0m11:05:35.668459 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:35.668459 [debug] [MainThread]: On master: BEGIN
[0m11:05:35.677599 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.678596 [debug] [MainThread]: On master: COMMIT
[0m11:05:35.678596 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:35.679596 [debug] [MainThread]: On master: COMMIT
[0m11:05:35.699014 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.700015 [debug] [MainThread]: On master: Close
[0m11:05:35.701015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:35.701015 [info ] [MainThread]: 
[0m11:05:35.706016 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m11:05:35.707014 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m11:05:35.707014 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m11:05:35.709218 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m11:05:35.710218 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m11:05:35.711221 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m11:05:35.711221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m11:05:35.712219 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m11:05:35.713219 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m11:05:35.714219 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m11:05:35.715324 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m11:05:35.715324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m11:05:35.716325 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m11:05:35.717325 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m11:05:35.718323 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m11:05:35.719392 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m11:05:35.719559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m11:05:35.720558 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m11:05:35.721557 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m11:05:35.722557 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m11:05:35.723557 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m11:05:35.723557 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m11:05:35.724558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m11:05:35.724558 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m11:05:35.730792 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:35.731791 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m11:05:35.774338 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:35.778338 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:35.779338 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:05:35.779338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:35.780338 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:35.780338 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:35.975212 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:35.976214 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:35.976214 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m11:05:36.073428 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.080430 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.080430 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m11:05:36.147580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.150577 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.150577 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m11:05:36.182849 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.203045 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:05:36.203045 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.204046 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:05:36.284812 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.285813 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.286814 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:05:36.307062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.313192 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m11:05:36.318305 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.318305 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m11:05:36.343460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.344471 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:05:36.345470 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.345470 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m11:05:36.389843 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.389843 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m11:05:36.390897 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m11:05:36.400014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.402015 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m11:05:36.419668 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m11:05:36.421668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149511BD010>]}
[0m11:05:36.422668 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.70s]
[0m11:05:36.422668 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m11:05:36.423671 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m11:05:36.423671 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m11:05:36.424669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m11:05:36.425701 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m11:05:36.436976 [debug] [Thread-1 (]: Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:05:36.436976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86e2e54-6e10-4098-8abd-f32e97056f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149510A7E00>]}
[0m11:05:36.437976 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.01s]
[0m11:05:36.438980 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m11:05:36.439978 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:05:36.439978 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m11:05:36.441075 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m11:05:36.442075 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:36.442075 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m11:05:36.443075 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m11:05:36.444181 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:36.444181 [debug] [MainThread]: On master: BEGIN
[0m11:05:36.445181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:05:36.445181 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:05:36.446181 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m11:05:36.632176 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.632176 [debug] [MainThread]: On master: COMMIT
[0m11:05:36.633177 [debug] [MainThread]: Using redshift connection "master"
[0m11:05:36.633177 [debug] [MainThread]: On master: COMMIT
[0m11:05:36.651352 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m11:05:36.652354 [debug] [MainThread]: On master: Close
[0m11:05:36.653354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:36.653354 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m11:05:36.653354 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m11:05:36.654354 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m11:05:36.654354 [info ] [MainThread]: 
[0m11:05:36.655354 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m11:05:36.656353 [debug] [MainThread]: Command end result
[0m11:05:36.684725 [info ] [MainThread]: 
[0m11:05:36.684725 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:05:36.685727 [info ] [MainThread]: 
[0m11:05:36.686727 [error] [MainThread]:   Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:05:36.686727 [info ] [MainThread]: 
[0m11:05:36.687727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m11:05:36.688727 [debug] [MainThread]: Command `dbt run` failed at 11:05:36.688727 after 2.88 seconds
[0m11:05:36.689751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001494E4DA8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149506DE1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014950700740>]}
[0m11:05:36.689840 [debug] [MainThread]: Flushing usage events
[0m04:22:50.741629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8c1ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8a31b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8a32c10>]}


============================== 04:22:50.748284 | 31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3 ==============================
[0m04:22:50.748284 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:22:50.749677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ls', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:22:50.823314 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:22:50.824377 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:22:50.950694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8abe690>]}
[0m04:22:51.001233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcea93f390>]}
[0m04:22:51.002810 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:22:51.019108 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:22:51.102749 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m04:22:51.104231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcea1ed290>]}
[0m04:22:52.569257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce79a7150>]}
[0m04:22:52.687234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce6c23a10>]}
[0m04:22:52.688600 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:22:52.689582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31147c4d-6ca6-4fd5-b553-dec7a0d9bdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce792f090>]}
[0m04:22:52.691692 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.005031, "process_user_time": 2.765571, "process_kernel_time": 0.079872, "process_mem_max_rss": "110548", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:22:52.692791 [debug] [MainThread]: Command `dbt ls` succeeded at 04:22:52.692691 after 2.01 seconds
[0m04:22:52.693632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8a72d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce6c4bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce8abc890>]}
[0m04:22:52.694574 [debug] [MainThread]: Flushing usage events
[0m13:25:56.204915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB53CF8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB537A0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB52F8EC30>]}


============================== 13:25:56.212917 | b9b707ef-d7c5-49ac-9300-b2279faccc73 ==============================
[0m13:25:56.212917 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:25:56.213914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:56.889437 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:25:56.890438 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:25:57.114867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB53CDB200>]}
[0m13:25:57.161867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB52F2F020>]}
[0m13:25:57.163547 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m13:25:57.177543 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:25:57.243544 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:25:57.244544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54B74F80>]}
[0m13:25:58.543404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54EB8050>]}
[0m13:25:58.696084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55224200>]}
[0m13:25:58.697084 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m13:25:58.698083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4EA36030>]}
[0m13:25:58.700087 [info ] [MainThread]: 
[0m13:25:58.701084 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:25:58.704083 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m13:25:58.720083 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m13:25:58.720083 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m13:25:58.721082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:58.724083 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:25:58.725082 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:25:59.309687 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:25:59.312686 [debug] [ThreadPool]: On list_dev: Close
[0m13:25:59.314691 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m13:25:59.320699 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:25:59.321697 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m13:25:59.321697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:59.322697 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:25:59.322697 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:25:59.502750 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:25:59.502750 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:25:59.503762 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m13:25:59.561150 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:25:59.563150 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m13:25:59.588153 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m13:25:59.598151 [debug] [MainThread]: Using redshift connection "master"
[0m13:25:59.599151 [debug] [MainThread]: On master: BEGIN
[0m13:25:59.599151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:59.600151 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:25:59.600151 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:25:59.957341 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:25:59.957341 [debug] [MainThread]: Using redshift connection "master"
[0m13:25:59.958160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:26:00.089023 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.091033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54BB2390>]}
[0m13:26:00.091033 [debug] [MainThread]: On master: ROLLBACK
[0m13:26:00.134174 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:00.134703 [debug] [MainThread]: On master: BEGIN
[0m13:26:00.143647 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.144170 [debug] [MainThread]: On master: COMMIT
[0m13:26:00.144688 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:00.145213 [debug] [MainThread]: On master: COMMIT
[0m13:26:00.164177 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.164177 [debug] [MainThread]: On master: Close
[0m13:26:00.165178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:00.166179 [info ] [MainThread]: 
[0m13:26:00.171062 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m13:26:00.171062 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m13:26:00.172062 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m13:26:00.174061 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m13:26:00.175060 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m13:26:00.176063 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m13:26:00.176063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m13:26:00.176063 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m13:26:00.178062 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m13:26:00.179060 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m13:26:00.179060 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m13:26:00.180063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m13:26:00.180063 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m13:26:00.182062 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m13:26:00.183063 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m13:26:00.184062 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m13:26:00.184062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m13:26:00.185061 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m13:26:00.187060 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m13:26:00.189062 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m13:26:00.189062 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m13:26:00.190059 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m13:26:00.190059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m13:26:00.191060 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m13:26:00.197061 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.198225 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m13:26:00.240060 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.244686 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.245698 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:26:00.245698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:00.246698 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:26:00.246698 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:26:00.420856 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.421918 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.421918 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m13:26:00.525970 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.532972 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.533973 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m13:26:00.590260 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.594259 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.594259 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m13:26:00.620637 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.638649 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:26:00.639647 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.640649 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:26:00.709799 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.710812 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.710812 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:26:00.728729 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.733729 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m13:26:00.738730 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.739731 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m13:26:00.761729 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.762729 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:26:00.762729 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.763729 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:26:00.815857 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.815857 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:26:00.816857 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:26:00.825134 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:00.827143 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m13:26:00.844809 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m13:26:00.846811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB508EC920>]}
[0m13:26:00.846811 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.66s]
[0m13:26:00.848035 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m13:26:00.848810 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m13:26:00.848810 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m13:26:00.849812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m13:26:00.849812 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m13:26:00.865216 [debug] [Thread-1 (]: Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:26:00.865216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b707ef-d7c5-49ac-9300-b2279faccc73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54799BB0>]}
[0m13:26:00.866216 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.02s]
[0m13:26:00.867215 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m13:26:00.868217 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:26:00.869216 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m13:26:00.869216 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:26:00.870215 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:26:00.871216 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m13:26:00.871216 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:26:00.872217 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:00.873216 [debug] [MainThread]: On master: BEGIN
[0m13:26:00.873216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:00.874215 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:26:00.874215 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:26:01.046138 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:01.047138 [debug] [MainThread]: On master: COMMIT
[0m13:26:01.047314 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:01.047314 [debug] [MainThread]: On master: COMMIT
[0m13:26:01.066269 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:26:01.066269 [debug] [MainThread]: On master: Close
[0m13:26:01.067418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:01.067418 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:26:01.068270 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m13:26:01.068270 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m13:26:01.069270 [info ] [MainThread]: 
[0m13:26:01.069270 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m13:26:01.070272 [debug] [MainThread]: Command end result
[0m13:26:01.100270 [info ] [MainThread]: 
[0m13:26:01.101270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:01.102270 [info ] [MainThread]: 
[0m13:26:01.102270 [error] [MainThread]:   Compilation Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  'fact_tour_weather' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:26:01.104270 [info ] [MainThread]: 
[0m13:26:01.104270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m13:26:01.106268 [debug] [MainThread]: Command `dbt run` failed at 13:26:01.105270 after 4.99 seconds
[0m13:26:01.106268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB537596D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB53759880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB52886570>]}
[0m13:26:01.106268 [debug] [MainThread]: Flushing usage events
[0m13:27:59.952123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEB817680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBED5B14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEDEC2060>]}


============================== 13:27:59.959123 | 2444fec6-62f3-4807-8fad-a841d1ee8a9a ==============================
[0m13:27:59.959123 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:27:59.960125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:28:00.271478 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:28:00.272478 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:28:00.459752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEEBD4350>]}
[0m13:28:00.519329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEF3E37D0>]}
[0m13:28:00.520329 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m13:28:00.534331 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:00.745547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:00.745547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:00.784545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEF4A44D0>]}
[0m13:28:00.866687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEFB1FD40>]}
[0m13:28:00.867688 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m13:28:00.867688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEDE5D3D0>]}
[0m13:28:00.869687 [info ] [MainThread]: 
[0m13:28:00.870686 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:28:00.874687 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m13:28:00.892686 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m13:28:00.893686 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m13:28:00.893686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:00.897212 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:00.898211 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:01.502945 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:28:01.504945 [debug] [ThreadPool]: On list_dev: Close
[0m13:28:01.507942 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m13:28:01.515940 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:28:01.516942 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m13:28:01.516942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:01.516942 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:01.517942 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:01.725022 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:01.726022 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:28:01.727024 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m13:28:01.783023 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:01.785023 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m13:28:01.813552 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m13:28:01.825551 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:01.825551 [debug] [MainThread]: On master: BEGIN
[0m13:28:01.826554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:01.826554 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:01.827552 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:02.024187 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.025189 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:02.026187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:28:02.146159 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.148160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEF47E8A0>]}
[0m13:28:02.148160 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:02.189043 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:02.190044 [debug] [MainThread]: On master: BEGIN
[0m13:28:02.199145 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.199145 [debug] [MainThread]: On master: COMMIT
[0m13:28:02.200144 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:02.200144 [debug] [MainThread]: On master: COMMIT
[0m13:28:02.219084 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.219084 [debug] [MainThread]: On master: Close
[0m13:28:02.220035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:02.221044 [info ] [MainThread]: 
[0m13:28:02.226044 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m13:28:02.227044 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m13:28:02.227044 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m13:28:02.229043 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m13:28:02.230044 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m13:28:02.231044 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m13:28:02.231044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m13:28:02.232042 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m13:28:02.233044 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m13:28:02.234042 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m13:28:02.234042 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m13:28:02.235042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m13:28:02.235042 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m13:28:02.237043 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m13:28:02.238042 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m13:28:02.238042 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m13:28:02.239042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m13:28:02.239042 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m13:28:02.241042 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m13:28:02.242042 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m13:28:02.242042 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m13:28:02.243043 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m13:28:02.243043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m13:28:02.244043 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m13:28:02.250042 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.251042 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m13:28:02.294620 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.298621 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.299620 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:28:02.299620 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:02.300623 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:02.300623 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:02.474733 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.475734 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.476736 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m13:28:02.573523 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.579534 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.580533 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m13:28:02.635139 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.638152 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.639149 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m13:28:02.667050 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.686631 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:28:02.687631 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.687631 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:28:02.755955 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.756955 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.756955 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:28:02.774609 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.780610 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m13:28:02.784610 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.785610 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m13:28:02.806167 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.808169 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:28:02.808169 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.809170 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:28:02.859585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.860596 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:28:02.860596 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:28:02.868618 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:02.870617 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m13:28:02.889169 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m13:28:02.891169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEDE83BC0>]}
[0m13:28:02.891169 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.65s]
[0m13:28:02.892169 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m13:28:02.893171 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m13:28:02.893171 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m13:28:02.894171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m13:28:02.895171 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m13:28:02.909170 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m13:28:02.910170 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m13:28:02.935169 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m13:28:02.942170 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:28:02.943172 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m13:28:02.943172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:02.944169 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:02.944169 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:03.142658 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:03.143831 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:28:03.144365 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m13:28:22.734541 [debug] [Thread-1 (]: SQL status: SUCCESS in 20.0 seconds
[0m13:28:22.736539 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m13:28:22.736539 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:28:22.737541 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m13:28:22.816624 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:22.817623 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m13:28:22.819627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEF562360>]}
[0m13:28:22.820624 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 19.92s]
[0m13:28:22.821624 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m13:28:22.823624 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:28:22.824622 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m13:28:22.825622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m13:28:22.825622 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:28:22.832625 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:22.833623 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:28:22.839672 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:22.848238 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:22.848888 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:28:22.849413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:22.849413 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:22.850418 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:23.082368 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:23.082902 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:23.083993 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m13:28:44.205292 [debug] [Thread-1 (]: SQL status: SUCCESS in 21.0 seconds
[0m13:28:44.208293 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.209292 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m13:28:44.276238 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.281237 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.281237 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m13:28:44.318429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.320428 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:28:44.320428 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.321430 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:28:44.388764 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.389763 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.390763 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:28:44.411567 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.414567 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m13:28:44.415568 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.415568 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m13:28:44.441292 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.442292 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:28:44.442292 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.443294 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:28:44.511402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.512402 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:28:44.512402 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:28:44.524402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.526406 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m13:28:44.549405 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m13:28:44.550402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBF02184D0>]}
[0m13:28:44.552404 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 21.73s]
[0m13:28:44.553402 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:28:44.554403 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:28:44.555403 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m13:28:44.556406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m13:28:44.557402 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:28:44.560402 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:44.562402 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:28:44.566401 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:44.570402 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:44.571402 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:28:44.571402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:44.572402 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:44.572402 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:44.763151 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:44.764151 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:44.764151 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m13:28:54.343439 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m13:28:54.347435 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.348436 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m13:28:54.408956 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.412957 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.413956 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.450485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.454486 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:28:54.455483 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.456483 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:28:54.535711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.536712 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.536712 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:28:54.559711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.561714 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m13:28:54.562711 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.563711 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m13:28:54.589715 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.591712 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:28:54.591712 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.592713 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:28:54.649272 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.649272 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:28:54.650273 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:28:54.660791 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.662791 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m13:28:54.683789 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m13:28:54.684790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2444fec6-62f3-4807-8fad-a841d1ee8a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEFB53A70>]}
[0m13:28:54.685791 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 10.13s]
[0m13:28:54.686789 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:28:54.688792 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:54.689790 [debug] [MainThread]: On master: BEGIN
[0m13:28:54.689790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:54.690791 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:28:54.690791 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:28:54.943580 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.944579 [debug] [MainThread]: On master: COMMIT
[0m13:28:54.945581 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:54.946585 [debug] [MainThread]: On master: COMMIT
[0m13:28:54.971583 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:28:54.972579 [debug] [MainThread]: On master: Close
[0m13:28:54.973580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:54.973580 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:28:54.974581 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m13:28:54.974581 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m13:28:54.975580 [info ] [MainThread]: 
[0m13:28:54.976581 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 54.10 seconds (54.10s).
[0m13:28:54.978579 [debug] [MainThread]: Command end result
[0m13:28:55.016581 [info ] [MainThread]: 
[0m13:28:55.017579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:55.019580 [info ] [MainThread]: 
[0m13:28:55.019580 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:28:55.021582 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:55.021582 after 55.17 seconds
[0m13:28:55.021582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEB817680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEE6A6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBEDE80DA0>]}
[0m13:28:55.022580 [debug] [MainThread]: Flushing usage events
[0m13:29:45.531639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF5A81EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF5A81F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF2265250>]}


============================== 13:29:45.535639 | a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604 ==============================
[0m13:29:45.535639 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:29:45.536639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:45.755762 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m13:29:45.756858 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m13:29:45.916564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF639CD40>]}
[0m13:29:45.964167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF7017320>]}
[0m13:29:45.965167 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m13:29:45.976167 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:29:46.133726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:46.134727 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m13:29:46.349020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF78A8F50>]}
[0m13:29:46.431838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF7628860>]}
[0m13:29:46.432371 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m13:29:46.433454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF666C3E0>]}
[0m13:29:46.435596 [info ] [MainThread]: 
[0m13:29:46.436119 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m13:29:46.440432 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m13:29:46.456433 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m13:29:46.456433 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m13:29:46.457432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:46.462217 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:29:46.463850 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:29:47.017953 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m13:29:47.019955 [debug] [ThreadPool]: On list_dev: Close
[0m13:29:47.021954 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m13:29:47.028952 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:29:47.028952 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m13:29:47.029951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:47.029951 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:29:47.030951 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:29:47.247091 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.247979 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m13:29:47.247979 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m13:29:47.328920 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.330920 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m13:29:47.368920 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m13:29:47.379919 [debug] [MainThread]: Using redshift connection "master"
[0m13:29:47.380920 [debug] [MainThread]: On master: BEGIN
[0m13:29:47.380920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:47.381919 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:29:47.381919 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:29:47.601578 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.602578 [debug] [MainThread]: Using redshift connection "master"
[0m13:29:47.602578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m13:29:47.790337 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.793338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF7017AA0>]}
[0m13:29:47.794336 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:47.855912 [debug] [MainThread]: Using redshift connection "master"
[0m13:29:47.856911 [debug] [MainThread]: On master: BEGIN
[0m13:29:47.872568 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.873569 [debug] [MainThread]: On master: COMMIT
[0m13:29:47.874568 [debug] [MainThread]: Using redshift connection "master"
[0m13:29:47.874568 [debug] [MainThread]: On master: COMMIT
[0m13:29:47.906449 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:47.906449 [debug] [MainThread]: On master: Close
[0m13:29:47.907448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:47.908451 [info ] [MainThread]: 
[0m13:29:47.912446 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m13:29:47.912446 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m13:29:47.913447 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m13:29:47.915447 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m13:29:47.916447 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m13:29:47.917448 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m13:29:47.918450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m13:29:47.918450 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m13:29:47.920628 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m13:29:47.921626 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m13:29:47.922627 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m13:29:47.922627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m13:29:47.923627 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m13:29:47.925627 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m13:29:47.926627 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m13:29:47.927627 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m13:29:47.927627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m13:29:47.928629 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m13:29:47.930628 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m13:29:47.932631 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m13:29:47.932631 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m13:29:47.933630 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m13:29:47.934630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m13:29:47.934630 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m13:29:47.941650 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:47.942652 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m13:29:47.993025 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:47.997027 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:47.997027 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:29:47.998028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:47.999026 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:29:47.999026 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:29:48.185852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.186853 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.186853 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m13:29:48.315566 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.322566 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.322566 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m13:29:48.393347 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.396848 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.397375 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m13:29:48.434122 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.456793 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:29:48.457861 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.458391 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:29:48.545605 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.545605 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.546605 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:29:48.564606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.570603 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m13:29:48.575604 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.575604 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m13:29:48.597142 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.599143 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:29:48.599143 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.599143 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m13:29:48.655149 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.656162 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m13:29:48.656162 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m13:29:48.665139 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:29:48.667146 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m13:29:48.685538 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m13:29:48.687539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF7872DE0>]}
[0m13:29:48.688539 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.75s]
[0m13:29:48.689540 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m13:29:48.689540 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m13:29:48.690539 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m13:29:48.690539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m13:29:48.691541 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m13:29:48.705127 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m13:29:48.706129 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m13:29:48.739128 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:29:48.740128 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp132948726128"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m13:29:48.740128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:48.741128 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:29:48.741128 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:30:10.529224 [debug] [Thread-1 (]: SQL status: SUCCESS in 22.0 seconds
[0m13:30:10.545234 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:10.545234 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m13:30:10.570342 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:10.571344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:10.571344 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp132948726128'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp132948726128'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp132948726128'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:30:10.830607 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:10.844604 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:10.845606 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m13:30:11.049724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:11.072723 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:11.072723 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp132948726128'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp132948726128'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp132948726128'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m13:30:11.273528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:11.288260 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:11.288260 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m13:30:11.478822 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:11.489823 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:30:11.501824 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:11.505822 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:11.505822 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp132948726128"
            );
[0m13:30:19.844596 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m13:30:19.845592 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:19.846593 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp132948726128"
    )
[0m13:30:28.584434 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m13:30:28.587435 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m13:30:28.588433 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m13:30:28.589435 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m13:30:28.641435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:28.642435 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m13:30:28.643436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF773D4F0>]}
[0m13:30:28.644435 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 39.95s]
[0m13:30:28.645435 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m13:30:28.646432 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:30:28.647435 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m13:30:28.648434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m13:30:28.648434 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:30:28.651436 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:28.652435 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:30:28.656960 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:28.661958 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:28.662960 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:30:28.662960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:28.663958 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:30:28.663958 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:30:28.855617 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:28.856617 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:28.856617 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m13:30:34.412718 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m13:30:34.416481 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.417016 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m13:30:34.483724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.487724 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.487724 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m13:30:34.521623 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.523623 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:30:34.524623 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.524623 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:30:34.579809 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.580811 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.580811 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:30:34.603579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.605577 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m13:30:34.606579 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.607578 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m13:30:34.632711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.633722 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:30:34.634721 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.634721 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m13:30:34.687289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.688291 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m13:30:34.688291 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m13:30:34.698807 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.699807 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m13:30:34.718732 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m13:30:34.719733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF8066510>]}
[0m13:30:34.719733 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 6.07s]
[0m13:30:34.720732 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m13:30:34.721733 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:30:34.721733 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m13:30:34.722731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m13:30:34.722731 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:30:34.725734 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:34.726733 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:30:34.729732 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:34.732730 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:34.733733 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:30:34.733733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:34.734732 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:30:34.734732 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:30:34.907780 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:34.908784 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:34.908784 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m13:30:35.144246 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.149470 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.149989 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m13:30:35.206012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.210028 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.210028 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.240606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.242608 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:30:35.243608 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.243608 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:30:35.326017 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.327016 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.328019 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:30:35.350021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.353021 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m13:30:35.354021 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.354021 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m13:30:35.384021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.385021 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:30:35.386021 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.387021 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m13:30:35.439604 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.439604 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m13:30:35.440604 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m13:30:35.450603 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.451604 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m13:30:35.470616 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m13:30:35.471619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a12c8b-ef61-4edd-bfaf-3caf9c7b1604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF809D460>]}
[0m13:30:35.472619 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 0.75s]
[0m13:30:35.472619 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m13:30:35.474617 [debug] [MainThread]: Using redshift connection "master"
[0m13:30:35.474617 [debug] [MainThread]: On master: BEGIN
[0m13:30:35.475617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:35.475617 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m13:30:35.476618 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m13:30:35.659207 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.659207 [debug] [MainThread]: On master: COMMIT
[0m13:30:35.660207 [debug] [MainThread]: Using redshift connection "master"
[0m13:30:35.660207 [debug] [MainThread]: On master: COMMIT
[0m13:30:35.679207 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m13:30:35.680207 [debug] [MainThread]: On master: Close
[0m13:30:35.681207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:35.681207 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m13:30:35.681207 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m13:30:35.682208 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m13:30:35.682208 [info ] [MainThread]: 
[0m13:30:35.683207 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 49.25 seconds (49.25s).
[0m13:30:35.685208 [debug] [MainThread]: Command end result
[0m13:30:35.713856 [info ] [MainThread]: 
[0m13:30:35.714856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:35.715856 [info ] [MainThread]: 
[0m13:30:35.715856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:30:35.717857 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:35.716856 after 50.27 seconds
[0m13:30:35.717857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF53FC320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF3ABDA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF8097FE0>]}
[0m13:30:35.717857 [debug] [MainThread]: Flushing usage events
[0m04:30:57.772765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d483e3f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d486e3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d483e2710>]}


============================== 04:30:57.779617 | 69454852-7628-4cf7-b06b-f1ece71abcf8 ==============================
[0m04:30:57.779617 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:30:57.780918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:57.860058 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:30:57.861522 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:30:58.015196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d47407990>]}
[0m04:30:58.071051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4a123750>]}
[0m04:30:58.072769 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:30:58.091395 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:30:58.211385 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m04:30:58.217103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d499c9210>]}
[0m04:31:00.051677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4711a6d0>]}
[0m04:31:00.192782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d463d6510>]}
[0m04:31:00.194525 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:31:00.195904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69454852-7628-4cf7-b06b-f1ece71abcf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d470fffd0>]}
[0m04:31:00.199399 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.488438, "process_user_time": 3.255872, "process_kernel_time": 0.190343, "process_mem_max_rss": "110476", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:31:00.200769 [debug] [MainThread]: Command `dbt ls` succeeded at 04:31:00.200635 after 2.49 seconds
[0m04:31:00.202322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d486e3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4820f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d472fd1d0>]}
[0m04:31:00.203784 [debug] [MainThread]: Flushing usage events
[0m04:31:49.812894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f114acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f114a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0f5ff90>]}


============================== 04:31:49.818768 | 7d3a8c6e-71ba-44bb-baa9-1776269d0bc7 ==============================
[0m04:31:49.818768 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:31:49.820522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:49.905030 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:31:49.906792 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:31:50.050073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d3a8c6e-71ba-44bb-baa9-1776269d0bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0f98090>]}
[0m04:31:50.106122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d3a8c6e-71ba-44bb-baa9-1776269d0bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0f78f90>]}
[0m04:31:50.108179 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:31:50.128015 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:31:50.511896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:50.513147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:50.556408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d3a8c6e-71ba-44bb-baa9-1776269d0bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f00d40d0>]}
[0m04:31:50.691574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d3a8c6e-71ba-44bb-baa9-1776269d0bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1efc13dd0>]}
[0m04:31:50.692850 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:31:50.694367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d3a8c6e-71ba-44bb-baa9-1776269d0bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f00b5a10>]}
[0m04:31:50.697283 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.9418742, "process_user_time": 1.814477, "process_kernel_time": 0.166735, "process_mem_max_rss": "108020", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:31:50.699219 [debug] [MainThread]: Command `dbt ls` succeeded at 04:31:50.698899 after 0.94 seconds
[0m04:31:50.700810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f0f9f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f47f0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1f00b5c50>]}
[0m04:31:50.702192 [debug] [MainThread]: Flushing usage events
[0m04:32:19.328787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500ef09fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f3cfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500ef093d0>]}


============================== 04:32:19.334486 | 3967ae22-8dae-4009-8110-e01b6c680d9a ==============================
[0m04:32:19.334486 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:32:19.335673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m04:32:19.415291 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:32:19.416465 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:32:19.541014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3967ae22-8dae-4009-8110-e01b6c680d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500eef6a10>]}
[0m04:32:19.588594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3967ae22-8dae-4009-8110-e01b6c680d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5010dfbad0>]}
[0m04:32:19.590089 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:32:19.604520 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:32:19.926735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:32:19.927726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:32:19.961343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3967ae22-8dae-4009-8110-e01b6c680d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500ded1a90>]}
[0m04:32:20.062972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3967ae22-8dae-4009-8110-e01b6c680d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500db7fc90>]}
[0m04:32:20.063972 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:32:20.064928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3967ae22-8dae-4009-8110-e01b6c680d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500f48ee10>]}
[0m04:32:20.066881 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7908627, "process_user_time": 1.464642, "process_kernel_time": 0.214814, "process_mem_max_rss": "107812", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:32:20.067981 [debug] [MainThread]: Command `dbt ls` succeeded at 04:32:20.067888 after 0.79 seconds
[0m04:32:20.068869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500ef1fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5012798590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50128f4250>]}
[0m04:32:20.069788 [debug] [MainThread]: Flushing usage events
[0m04:35:12.379599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235c723250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2359722990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235a095110>]}


============================== 04:35:12.385354 | 5fff569c-b270-4abf-9da0-228f76e22a0c ==============================
[0m04:35:12.385354 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:35:12.386760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:35:12.458213 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:35:12.459659 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:35:12.582426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fff569c-b270-4abf-9da0-228f76e22a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23583987d0>]}
[0m04:35:12.629280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fff569c-b270-4abf-9da0-228f76e22a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235b09b9d0>]}
[0m04:35:12.630840 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:35:12.645220 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:35:12.946997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:35:12.948226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:35:12.982628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fff569c-b270-4abf-9da0-228f76e22a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2358c4e110>]}
[0m04:35:13.083445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fff569c-b270-4abf-9da0-228f76e22a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2357e23c10>]}
[0m04:35:13.084487 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:35:13.085504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fff569c-b270-4abf-9da0-228f76e22a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23582bf750>]}
[0m04:35:13.087412 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7588728, "process_user_time": 1.561458, "process_kernel_time": 0.118591, "process_mem_max_rss": "108064", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:35:13.088409 [debug] [MainThread]: Command `dbt ls` succeeded at 04:35:13.088314 after 0.76 seconds
[0m04:35:13.089422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235b0e9f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2359186310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235c9f8890>]}
[0m04:35:13.090315 [debug] [MainThread]: Flushing usage events
[0m04:43:45.968473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548731a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486e93710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486e932d0>]}


============================== 04:43:45.974748 | 8728813c-db6a-4dfb-aea1-d6ca62aa3b2b ==============================
[0m04:43:45.974748 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:43:45.976068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:43:46.057703 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:43:46.059043 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:43:46.196784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8728813c-db6a-4dfb-aea1-d6ca62aa3b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54860ad190>]}
[0m04:43:46.246912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8728813c-db6a-4dfb-aea1-d6ca62aa3b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5488d9f890>]}
[0m04:43:46.248750 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:43:46.263172 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:43:46.620594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:43:46.621676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:43:46.656428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8728813c-db6a-4dfb-aea1-d6ca62aa3b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486ebf310>]}
[0m04:43:46.758977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8728813c-db6a-4dfb-aea1-d6ca62aa3b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5485fd9f10>]}
[0m04:43:46.760008 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:43:46.761153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8728813c-db6a-4dfb-aea1-d6ca62aa3b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5485f3cdd0>]}
[0m04:43:46.763098 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.8498845, "process_user_time": 1.629199, "process_kernel_time": 0.211192, "process_mem_max_rss": "108016", "process_out_blocks": "1064", "process_in_blocks": "0"}
[0m04:43:46.764153 [debug] [MainThread]: Command `dbt ls` succeeded at 04:43:46.764054 after 0.85 seconds
[0m04:43:46.765329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548a6fc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5486088ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f548a880450>]}
[0m04:43:46.766340 [debug] [MainThread]: Flushing usage events
[0m04:44:23.707491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb427ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb451ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb46363d0>]}


============================== 04:44:23.714850 | 024b91fe-6d89-492b-be22-06e30d2815a2 ==============================
[0m04:44:23.714850 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:44:23.716352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:44:23.819459 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:44:23.821026 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:44:24.008992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb411c7d0>]}
[0m04:44:24.074855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb5fc7650>]}
[0m04:44:24.077279 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:44:24.096555 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:44:24.495007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:44:24.496335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:44:24.532559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb30400d0>]}
[0m04:44:24.621915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb317db10>]}
[0m04:44:24.623156 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:44:24.624119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb318ff90>]}
[0m04:44:24.626681 [info ] [MainThread]: 
[0m04:44:24.628106 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m04:44:24.632649 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m04:44:24.650432 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:44:24.651565 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m04:44:24.652392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:24.656479 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:24.658061 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:24.885358 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:24.888304 [debug] [ThreadPool]: On list_dev: Close
[0m04:44:24.890920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_wnsldjqja)
[0m04:44:24.898584 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m04:44:24.899644 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m04:44:24.900477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:24.901460 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:24.902347 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:25.040851 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.042166 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m04:44:25.043020 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m04:44:25.100717 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.103465 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m04:44:25.133340 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m04:44:25.145804 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:25.147108 [debug] [MainThread]: On master: BEGIN
[0m04:44:25.148027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:44:25.149130 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:25.149993 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:25.281911 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.283202 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:25.284079 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m04:44:25.410204 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.413528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb3310810>]}
[0m04:44:25.414676 [debug] [MainThread]: On master: ROLLBACK
[0m04:44:25.459129 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:25.460267 [debug] [MainThread]: On master: BEGIN
[0m04:44:25.471503 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.472624 [debug] [MainThread]: On master: COMMIT
[0m04:44:25.473731 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:25.474579 [debug] [MainThread]: On master: COMMIT
[0m04:44:25.493778 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.494924 [debug] [MainThread]: On master: Close
[0m04:44:25.496250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:25.497372 [info ] [MainThread]: 
[0m04:44:25.505634 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m04:44:25.506819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_wnsldjqja, now model.weather_tour_dbt.src_signgu)
[0m04:44:25.507885 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m04:44:25.511027 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m04:44:25.520066 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m04:44:25.521195 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m04:44:25.522233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m04:44:25.523203 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m04:44:25.525985 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m04:44:25.534348 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m04:44:25.535315 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m04:44:25.536440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m04:44:25.537623 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m04:44:25.540828 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m04:44:25.548775 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m04:44:25.549756 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m04:44:25.550813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m04:44:25.551665 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m04:44:25.554344 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m04:44:25.562234 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m04:44:25.563175 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m04:44:25.564248 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m04:44:25.565355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m04:44:25.566270 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m04:44:25.574007 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.581981 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m04:44:25.627795 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.638756 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.639751 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:44:25.640764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:25.641878 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:25.642873 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:25.796221 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.797539 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.798712 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m04:44:25.908282 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.917760 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.919008 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m04:44:25.971668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:25.977055 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:25.978141 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m04:44:26.016623 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.036697 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:44:26.037969 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:26.038763 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:44:26.131993 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.133512 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:26.134884 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:44:26.161258 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.168959 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m04:44:26.174732 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:26.175736 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m04:44:26.206009 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.208002 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:44:26.209035 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:26.209895 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:44:26.266886 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.268506 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:44:26.269426 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:44:26.284138 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.286868 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m04:44:26.314112 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m04:44:26.317048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb3216090>]}
[0m04:44:26.318663 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.75s]
[0m04:44:26.320404 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m04:44:26.321740 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m04:44:26.322852 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m04:44:26.324177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m04:44:26.325335 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m04:44:26.341384 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m04:44:26.349580 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m04:44:26.378624 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m04:44:26.391476 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:44:26.392633 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m04:44:26.393560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:26.394542 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:26.395376 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:26.527909 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:26.529488 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:44:26.530675 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m04:44:33.315605 [debug] [Thread-1 (]: SQL status: SUCCESS in 7.0 seconds
[0m04:44:33.318924 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m04:44:33.320337 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:44:33.321996 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m04:44:33.394244 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:33.396374 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m04:44:33.397930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb322e590>]}
[0m04:44:33.399973 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 7.07s]
[0m04:44:33.401901 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m04:44:33.404141 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:44:33.405254 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m04:44:33.406726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m04:44:33.407923 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:44:33.412181 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:33.421817 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:44:33.428160 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:33.440990 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:33.442257 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:44:33.443174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:33.444378 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:33.445667 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:33.591763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:33.593275 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:33.594486 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m04:44:34.036089 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.043703 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.045500 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m04:44:34.096440 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.099943 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:44:34.101675 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.103711 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:44:34.176189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.177755 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.179315 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:44:34.209429 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.213697 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m04:44:34.216249 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.217484 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m04:44:34.257941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.260161 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:44:34.261646 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.262889 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:44:34.284671 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.286354 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:44:34.287850 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:44:34.301537 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.303863 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m04:44:34.330301 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m04:44:34.332653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb0c05dd0>]}
[0m04:44:34.335010 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 0.93s]
[0m04:44:34.337657 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:44:34.340457 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:44:34.342285 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m04:44:34.343997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m04:44:34.345317 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:44:34.352626 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.363706 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:44:34.370335 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.383760 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.384930 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:44:34.386214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:34.387683 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:34.388814 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:34.533140 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.534991 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.536557 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m04:44:34.811906 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.816700 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.817692 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.864764 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.867645 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:44:34.868889 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.869758 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:44:34.933355 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.935318 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.936817 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:44:34.961756 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.965786 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m04:44:34.969407 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.970887 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m04:44:34.994794 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:34.996957 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:44:34.998129 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:34.999281 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:44:35.021847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:35.023204 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:44:35.024212 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:44:35.037047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:35.039016 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m04:44:35.061806 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m04:44:35.063931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b91fe-6d89-492b-be22-06e30d2815a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb0c65610>]}
[0m04:44:35.065515 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 0.72s]
[0m04:44:35.067265 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:44:35.070099 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:35.071163 [debug] [MainThread]: On master: BEGIN
[0m04:44:35.072142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:44:35.073181 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:44:35.074077 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:44:35.204549 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:35.205788 [debug] [MainThread]: On master: COMMIT
[0m04:44:35.206876 [debug] [MainThread]: Using redshift connection "master"
[0m04:44:35.207916 [debug] [MainThread]: On master: COMMIT
[0m04:44:35.232456 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:44:35.233965 [debug] [MainThread]: On master: Close
[0m04:44:35.235647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:35.236627 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m04:44:35.237802 [info ] [MainThread]: 
[0m04:44:35.239003 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m04:44:35.241040 [debug] [MainThread]: Command end result
[0m04:44:35.363552 [info ] [MainThread]: 
[0m04:44:35.364737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:44:35.365846 [info ] [MainThread]: 
[0m04:44:35.369934 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:44:35.372283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.72271, "process_user_time": 2.569999, "process_kernel_time": 0.25215, "process_mem_max_rss": "112632", "process_out_blocks": "1160", "process_in_blocks": "0"}
[0m04:44:35.373752 [debug] [MainThread]: Command `dbt run` succeeded at 04:44:35.373511 after 11.72 seconds
[0m04:44:35.374673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb7920790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb7aa4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bb7aa5150>]}
[0m04:44:35.375970 [debug] [MainThread]: Flushing usage events
[0m04:45:57.829957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bbc9e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bbe8b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bc1977d0>]}


============================== 04:45:57.836509 | 097e3a25-0cfb-4816-b1f0-118a1df085ed ==============================
[0m04:45:57.836509 [info ] [MainThread]: Running with dbt=1.8.0
[0m04:45:57.838027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:45:57.916038 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m04:45:57.917636 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m04:45:58.059240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bbd31390>]}
[0m04:45:58.109055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bdbab5d0>]}
[0m04:45:58.111021 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m04:45:58.129055 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m04:45:58.470018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:45:58.471199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:45:58.509633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bac7c310>]}
[0m04:45:58.619457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bad86950>]}
[0m04:45:58.620597 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m04:45:58.621534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bb6bb6d0>]}
[0m04:45:58.624088 [info ] [MainThread]: 
[0m04:45:58.625646 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m04:45:58.630718 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m04:45:58.649297 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:45:58.650448 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m04:45:58.651368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:58.655603 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:45:58.657466 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:45:58.919363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:58.922737 [debug] [ThreadPool]: On list_dev: Close
[0m04:45:58.926138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_wnsldjqja)
[0m04:45:58.934787 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m04:45:58.936280 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m04:45:58.937444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:45:58.938971 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:45:58.940175 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:45:59.085324 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.086656 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m04:45:59.087907 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m04:45:59.256078 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.258848 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m04:45:59.291375 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m04:45:59.303322 [debug] [MainThread]: Using redshift connection "master"
[0m04:45:59.304336 [debug] [MainThread]: On master: BEGIN
[0m04:45:59.305067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:45:59.306014 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:45:59.306814 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:45:59.441801 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.443015 [debug] [MainThread]: Using redshift connection "master"
[0m04:45:59.444101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m04:45:59.593865 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.598720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bac6a7d0>]}
[0m04:45:59.600814 [debug] [MainThread]: On master: ROLLBACK
[0m04:45:59.647629 [debug] [MainThread]: Using redshift connection "master"
[0m04:45:59.649000 [debug] [MainThread]: On master: BEGIN
[0m04:45:59.659524 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.660700 [debug] [MainThread]: On master: COMMIT
[0m04:45:59.661752 [debug] [MainThread]: Using redshift connection "master"
[0m04:45:59.662459 [debug] [MainThread]: On master: COMMIT
[0m04:45:59.682352 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.683640 [debug] [MainThread]: On master: Close
[0m04:45:59.685013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:45:59.686279 [info ] [MainThread]: 
[0m04:45:59.694602 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m04:45:59.695879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_wnsldjqja, now model.weather_tour_dbt.src_signgu)
[0m04:45:59.696693 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m04:45:59.700328 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m04:45:59.708677 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m04:45:59.709820 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m04:45:59.711063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m04:45:59.711973 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m04:45:59.715323 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m04:45:59.724742 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m04:45:59.726373 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m04:45:59.727682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m04:45:59.728952 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m04:45:59.731788 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m04:45:59.741656 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m04:45:59.742797 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m04:45:59.744325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m04:45:59.745463 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m04:45:59.748877 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m04:45:59.759296 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m04:45:59.760887 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m04:45:59.762415 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m04:45:59.763941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m04:45:59.765219 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m04:45:59.774928 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m04:45:59.784128 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m04:45:59.838985 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m04:45:59.850235 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:45:59.851418 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:45:59.852471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:45:59.853618 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:45:59.854522 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:45:59.979488 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:45:59.980938 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:45:59.982373 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m04:46:00.082019 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.091742 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.092876 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m04:46:00.131957 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.136859 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.138198 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m04:46:00.179706 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.209282 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:46:00.210865 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.211963 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:46:00.276440 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.278156 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.279394 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:46:00.300340 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.308263 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m04:46:00.314439 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.315824 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m04:46:00.347913 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.350193 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:46:00.351305 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.352181 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m04:46:00.416405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.418117 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m04:46:00.419131 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m04:46:00.430239 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:00.432954 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m04:46:00.452815 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m04:46:00.455780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ba18e290>]}
[0m04:46:00.457298 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.69s]
[0m04:46:00.458717 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m04:46:00.459778 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m04:46:00.460888 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m04:46:00.462238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m04:46:00.463277 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m04:46:00.483201 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:00.502050 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m04:46:00.536154 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:00.537761 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp044600524957"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName, 
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m04:46:00.539036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:00.540918 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:46:00.542080 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:46:02.328642 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m04:46:02.347804 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:02.349096 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m04:46:02.371578 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:02.373207 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:02.374557 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp044600524957'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp044600524957'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp044600524957'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m04:46:02.648117 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:02.669209 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:02.671037 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m04:46:02.922055 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:02.946258 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:02.948153 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp044600524957'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp044600524957'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp044600524957'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m04:46:03.160395 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:03.179858 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:03.181717 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m04:46:03.378622 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:03.390189 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:46:03.405025 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:03.419849 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:03.421295 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp044600524957"
            );
[0m04:46:03.695504 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:03.696878 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:03.698070 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp044600524957"
    )
[0m04:46:03.838867 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:03.841861 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m04:46:03.843061 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m04:46:03.844145 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m04:46:03.953878 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:03.957110 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m04:46:03.959534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b86e86d0>]}
[0m04:46:03.961416 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 3.50s]
[0m04:46:03.963474 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m04:46:03.966295 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:46:03.968346 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m04:46:03.970436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m04:46:03.972124 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:46:04.110349 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:04.132013 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:46:04.141006 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:04.155868 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:04.157300 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:46:04.158355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:04.159726 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:46:04.160897 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:46:04.318724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:04.320168 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:04.321453 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m04:46:05.289722 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m04:46:05.294983 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.296446 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m04:46:05.340608 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.345915 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.347041 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m04:46:05.379245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.382039 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:46:05.383396 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.384382 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:46:05.452447 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.454512 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.455781 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:46:05.479110 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.483501 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m04:46:05.485159 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.486047 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m04:46:05.512531 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.514970 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:46:05.516225 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.517617 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m04:46:05.631585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.633278 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m04:46:05.634769 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m04:46:05.647314 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.649023 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m04:46:05.668694 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m04:46:05.670550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bacb1f90>]}
[0m04:46:05.672083 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 1.70s]
[0m04:46:05.673483 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m04:46:05.675690 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:46:05.676908 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m04:46:05.678278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m04:46:05.679398 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:46:05.683857 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:05.692651 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:46:05.697851 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:05.708813 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:05.710759 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:46:05.711800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:05.713100 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:46:05.714166 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:46:05.863519 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:05.864646 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:05.865596 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m04:46:06.301858 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.307925 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.309845 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m04:46:06.373079 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.380699 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.383001 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.423656 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.427493 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:46:06.429131 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.430464 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:46:06.505161 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.506997 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.508305 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:46:06.532512 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.539216 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m04:46:06.541345 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.542301 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m04:46:06.571448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.573894 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:46:06.575171 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.576414 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m04:46:06.661174 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.662680 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m04:46:06.663599 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m04:46:06.676539 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.678220 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m04:46:06.699105 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m04:46:06.700912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e3a25-0cfb-4816-b1f0-118a1df085ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ba1e2b90>]}
[0m04:46:06.702376 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 1.02s]
[0m04:46:06.703954 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m04:46:06.706743 [debug] [MainThread]: Using redshift connection "master"
[0m04:46:06.708017 [debug] [MainThread]: On master: BEGIN
[0m04:46:06.709249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:46:06.710564 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:46:06.711629 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:46:06.830747 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.831821 [debug] [MainThread]: On master: COMMIT
[0m04:46:06.832762 [debug] [MainThread]: Using redshift connection "master"
[0m04:46:06.833575 [debug] [MainThread]: On master: COMMIT
[0m04:46:06.852921 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m04:46:06.854023 [debug] [MainThread]: On master: Close
[0m04:46:06.855255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:06.856059 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m04:46:06.856935 [info ] [MainThread]: 
[0m04:46:06.858144 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m04:46:06.860035 [debug] [MainThread]: Command end result
[0m04:46:06.908331 [info ] [MainThread]: 
[0m04:46:06.909744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:06.910840 [info ] [MainThread]: 
[0m04:46:06.911873 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:46:06.913358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.144742, "process_user_time": 2.688537, "process_kernel_time": 0.284553, "process_mem_max_rss": "113020", "process_out_blocks": "1160", "process_in_blocks": "0"}
[0m04:46:06.914437 [debug] [MainThread]: Command `dbt run` succeeded at 04:46:06.914337 after 9.15 seconds
[0m04:46:06.915330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bf508710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ba1c7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bf68c450>]}
[0m04:46:06.916168 [debug] [MainThread]: Flushing usage events
[0m06:14:33.972261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4994aa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4999a37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4994aa850>]}


============================== 06:14:33.980645 | 5ea44c0f-15e3-4ac7-b0a8-c04650357c5c ==============================
[0m06:14:33.980645 [info ] [MainThread]: Running with dbt=1.8.0
[0m06:14:33.982125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:14:34.111660 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m06:14:34.113585 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m06:14:34.286966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb499553550>]}
[0m06:14:34.336976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49b3bb890>]}
[0m06:14:34.338860 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m06:14:34.357540 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m06:14:34.718063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:14:34.719587 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models/src/src_tourist_spot.sql
[0m06:14:34.922308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498705b10>]}
[0m06:14:35.015272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4982eeb10>]}
[0m06:14:35.016260 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m06:14:35.017323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4982c1690>]}
[0m06:14:35.020135 [info ] [MainThread]: 
[0m06:14:35.021509 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m06:14:35.025701 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m06:14:35.045861 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m06:14:35.046992 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m06:14:35.047951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:35.052204 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:14:35.053610 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:14:35.311534 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.315422 [debug] [ThreadPool]: On list_dev: Close
[0m06:14:35.321347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_wnsldjqja)
[0m06:14:35.333310 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m06:14:35.334567 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m06:14:35.335854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:35.337081 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:14:35.338009 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:14:35.465161 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.466394 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m06:14:35.467344 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m06:14:35.526402 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.529168 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m06:14:35.560595 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m06:14:35.574189 [debug] [MainThread]: Using redshift connection "master"
[0m06:14:35.575557 [debug] [MainThread]: On master: BEGIN
[0m06:14:35.576812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:35.577990 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:14:35.579029 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:14:35.726228 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.727438 [debug] [MainThread]: Using redshift connection "master"
[0m06:14:35.728554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m06:14:35.858464 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.862810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498458c50>]}
[0m06:14:35.864890 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:35.909937 [debug] [MainThread]: Using redshift connection "master"
[0m06:14:35.911475 [debug] [MainThread]: On master: BEGIN
[0m06:14:35.924305 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.925415 [debug] [MainThread]: On master: COMMIT
[0m06:14:35.926464 [debug] [MainThread]: Using redshift connection "master"
[0m06:14:35.927289 [debug] [MainThread]: On master: COMMIT
[0m06:14:35.951831 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:35.952857 [debug] [MainThread]: On master: Close
[0m06:14:35.954154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:14:35.955222 [info ] [MainThread]: 
[0m06:14:35.964557 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m06:14:35.965937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_wnsldjqja, now model.weather_tour_dbt.src_signgu)
[0m06:14:35.967003 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m06:14:35.970099 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m06:14:35.979044 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m06:14:35.980192 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m06:14:35.981190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m06:14:35.982237 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m06:14:35.984958 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m06:14:35.994349 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m06:14:35.995359 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m06:14:35.996362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m06:14:35.997308 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m06:14:36.000290 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m06:14:36.009122 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m06:14:36.010322 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m06:14:36.011533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m06:14:36.012597 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m06:14:36.015363 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m06:14:36.023359 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m06:14:36.024435 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m06:14:36.025572 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m06:14:36.026997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m06:14:36.028069 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m06:14:36.036192 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.044860 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m06:14:36.097412 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.108417 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.109960 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m06:14:36.111743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:36.113534 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:14:36.115022 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:14:36.264257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.265734 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.266835 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m06:14:36.377095 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.387964 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.389498 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m06:14:36.439413 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.445111 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.446498 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m06:14:36.484293 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.508002 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m06:14:36.509364 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.510522 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m06:14:36.587388 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.588726 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.589481 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m06:14:36.612174 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.621275 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m06:14:36.626778 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.627701 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m06:14:36.654240 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.656288 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m06:14:36.657311 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.658254 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m06:14:36.703606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.704862 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m06:14:36.705676 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m06:14:36.717091 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:36.719467 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m06:14:36.742752 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m06:14:36.745159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498569450>]}
[0m06:14:36.746440 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.72s]
[0m06:14:36.747604 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m06:14:36.748640 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m06:14:36.749694 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m06:14:36.750797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m06:14:36.751567 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m06:14:36.769970 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:36.776571 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m06:14:36.874294 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:36.876022 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp061436800629"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m06:14:36.877622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:36.879222 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:14:36.880335 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:14:53.556587 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m06:14:53.577796 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:53.579064 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m06:14:53.603975 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:53.605423 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:53.606420 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp061436800629'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp061436800629'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp061436800629'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m06:14:53.975861 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:53.993479 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:53.994715 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m06:14:54.277745 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:54.301585 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:54.302886 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp061436800629'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp061436800629'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp061436800629'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m06:14:54.521299 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:54.536458 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:54.537876 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m06:14:54.782359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:14:54.795706 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:14:54.815285 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:54.827959 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:14:54.830037 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp061436800629"
            );
[0m06:15:03.691766 [debug] [Thread-1 (]: SQL status: SUCCESS in 9.0 seconds
[0m06:15:03.693092 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:15:03.694168 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp061436800629"
    )
[0m06:15:04.617446 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m06:15:04.619912 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m06:15:04.620960 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m06:15:04.621849 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m06:15:04.683525 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:04.685951 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m06:15:04.687549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4986ae210>]}
[0m06:15:04.689103 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 27.94s]
[0m06:15:04.690991 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m06:15:04.693239 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m06:15:04.694454 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m06:15:04.695681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m06:15:04.696617 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m06:15:04.701372 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:04.710760 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m06:15:04.715950 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:04.728833 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:04.730067 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m06:15:04.731111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:04.732292 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:15:04.733207 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:15:04.879600 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:04.881212 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:04.882291 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m06:15:06.281218 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m06:15:06.286556 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.287634 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m06:15:06.348636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.353726 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.354676 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m06:15:06.394854 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.398382 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m06:15:06.399762 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.400580 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m06:15:06.467758 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.470104 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.471467 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m06:15:06.497006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.502481 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m06:15:06.504220 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.505432 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m06:15:06.539503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.542023 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m06:15:06.543410 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.544452 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m06:15:06.606066 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.607964 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m06:15:06.609682 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m06:15:06.621724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.623917 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m06:15:06.648675 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m06:15:06.651381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb498640a90>]}
[0m06:15:06.652973 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 1.96s]
[0m06:15:06.654529 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m06:15:06.657478 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m06:15:06.659585 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m06:15:06.661001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m06:15:06.662352 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m06:15:06.666809 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:06.675523 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m06:15:06.683993 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:06.700842 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:06.702123 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m06:15:06.703570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:06.705121 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:15:06.706175 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:15:06.838905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:06.840186 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:06.841149 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m06:15:07.227692 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.233773 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.235021 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m06:15:07.272913 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.279144 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.280188 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.309187 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.313248 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m06:15:07.314715 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.315824 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m06:15:07.378289 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.380242 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.381342 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m06:15:07.401529 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.405318 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m06:15:07.407072 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.407928 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m06:15:07.436752 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.441270 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m06:15:07.443144 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.444520 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m06:15:07.498577 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.499890 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m06:15:07.500767 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m06:15:07.511128 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.512809 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m06:15:07.531205 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m06:15:07.533258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea44c0f-15e3-4ac7-b0a8-c04650357c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4985ecf50>]}
[0m06:15:07.534775 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 0.87s]
[0m06:15:07.536293 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m06:15:07.538976 [debug] [MainThread]: Using redshift connection "master"
[0m06:15:07.540116 [debug] [MainThread]: On master: BEGIN
[0m06:15:07.541114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:15:07.542264 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m06:15:07.543242 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m06:15:07.710441 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.712599 [debug] [MainThread]: On master: COMMIT
[0m06:15:07.714091 [debug] [MainThread]: Using redshift connection "master"
[0m06:15:07.715434 [debug] [MainThread]: On master: COMMIT
[0m06:15:07.740532 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m06:15:07.742208 [debug] [MainThread]: On master: Close
[0m06:15:07.744213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:07.745877 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m06:15:07.747451 [info ] [MainThread]: 
[0m06:15:07.748859 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 32.73 seconds (32.73s).
[0m06:15:07.752213 [debug] [MainThread]: Command end result
[0m06:15:07.828559 [info ] [MainThread]: 
[0m06:15:07.830199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:15:07.831902 [info ] [MainThread]: 
[0m06:15:07.833576 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:15:07.836043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.923183, "process_user_time": 2.819816, "process_kernel_time": 0.659309, "process_mem_max_rss": "115192", "process_out_blocks": "1160", "process_in_blocks": "0"}
[0m06:15:07.837304 [debug] [MainThread]: Command `dbt run` succeeded at 06:15:07.837196 after 33.92 seconds
[0m06:15:07.838903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49d00d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49cd14710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49ce98450>]}
[0m06:15:07.840332 [debug] [MainThread]: Flushing usage events
[0m17:07:03.933049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1408F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A10845550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A10844E90>]}


============================== 17:07:03.942372 | d0d3487e-03be-444c-bced-8deccd945f9b ==============================
[0m17:07:03.942372 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:07:03.943372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:04.805196 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:07:04.806198 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:07:05.039577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1567F350>]}
[0m17:07:05.116735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1408F050>]}
[0m17:07:05.119733 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:07:05.143739 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:07:05.248511 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:07:05.250500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1408E420>]}
[0m17:07:07.110221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15F350A0>]}
[0m17:07:07.304747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15EA7B90>]}
[0m17:07:07.304747 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m17:07:07.305748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15CEA600>]}
[0m17:07:07.307749 [info ] [MainThread]: 
[0m17:07:07.308746 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:07:07.312747 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:07:07.329803 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:07:07.329803 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:07:07.330802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:07.333803 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:07.334803 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:08.092692 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:07:08.097573 [debug] [ThreadPool]: On list_dev: Close
[0m17:07:08.100329 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:07:08.111254 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:07:08.112255 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:07:08.112255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:08.113255 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:08.114257 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:08.361366 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.362365 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:07:08.362365 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:07:08.420171 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.422172 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:07:08.452701 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:07:08.469701 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:08.470703 [debug] [MainThread]: On master: BEGIN
[0m17:07:08.471704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:08.472704 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:08.473704 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:08.703315 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.703315 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:08.704314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:07:08.867281 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.869281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15D9CE30>]}
[0m17:07:08.869281 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:08.916304 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:08.917304 [debug] [MainThread]: On master: BEGIN
[0m17:07:08.928842 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.929840 [debug] [MainThread]: On master: COMMIT
[0m17:07:08.930841 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:08.930841 [debug] [MainThread]: On master: COMMIT
[0m17:07:08.953835 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:08.954836 [debug] [MainThread]: On master: Close
[0m17:07:08.955834 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:08.956839 [info ] [MainThread]: 
[0m17:07:08.963835 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m17:07:08.964837 [info ] [Thread-1 (]: 1 of 2 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m17:07:08.965837 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.signgu'
[0m17:07:08.966837 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m17:07:08.966837 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m17:07:09.007018 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:07:09.008100 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m17:07:09.008647 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:09.009192 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:09.009737 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:09.260868 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:09.261866 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:07:09.262866 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */
truncate table "dev"."wnsldjqja"."signgu"
[0m17:07:09.404437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:09.579639 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:07:09.580641 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("시군구코드", "시도명", "시군구명") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m17:07:14.016905 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m17:07:14.024905 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.signgu"
[0m17:07:14.042428 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:07:14.043428 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:07:14.043428 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:07:14.076439 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:14.080049 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m17:07:14.082563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A1408F740>]}
[0m17:07:14.083563 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file wnsldjqja.signgu .................................... [[32mINSERT 230[0m in 5.12s]
[0m17:07:14.086564 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m17:07:14.087562 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m17:07:14.088562 [info ] [Thread-1 (]: 2 of 2 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m17:07:14.090562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m17:07:14.091562 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m17:07:14.092562 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m17:07:14.261052 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:14.262052 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m17:07:14.263052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:14.263052 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:14.264052 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:14.501628 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:14.503625 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:14.504629 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m17:07:14.648724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:15.879861 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:15.879861 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:29.067195 [debug] [Thread-1 (]: SQL status: SUCCESS in 13.0 seconds
[0m17:07:30.140188 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:30.141276 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:30.484128 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:31.633584 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:31.634584 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:31.923904 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:33.043012 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:33.043533 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:33.281605 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:34.407146 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:34.408145 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:34.671763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:35.402302 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:35.403305 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:07:35.907213 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:07:35.909215 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m17:07:35.911212 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:07:35.912212 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:07:35.913211 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:07:35.933906 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:35.934907 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m17:07:35.935908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d3487e-03be-444c-bced-8deccd945f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15EF8830>]}
[0m17:07:35.936907 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 21.85s]
[0m17:07:35.938906 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m17:07:35.939906 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:35.940905 [debug] [MainThread]: On master: BEGIN
[0m17:07:35.941905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:35.941905 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:07:35.942905 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:07:36.183750 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:36.184817 [debug] [MainThread]: On master: COMMIT
[0m17:07:36.184853 [debug] [MainThread]: Using redshift connection "master"
[0m17:07:36.185411 [debug] [MainThread]: On master: COMMIT
[0m17:07:36.208733 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:07:36.209273 [debug] [MainThread]: On master: Close
[0m17:07:36.210345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:36.210869 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:07:36.211410 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:07:36.211933 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m17:07:36.212464 [info ] [MainThread]: 
[0m17:07:36.213182 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 28.90 seconds (28.90s).
[0m17:07:36.214799 [debug] [MainThread]: Command end result
[0m17:07:36.250416 [info ] [MainThread]: 
[0m17:07:36.251416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:36.252418 [info ] [MainThread]: 
[0m17:07:36.253418 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:07:36.255416 [debug] [MainThread]: Command `dbt seed` succeeded at 17:07:36.254418 after 32.45 seconds
[0m17:07:36.255416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A14A52DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A15DC1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A13D6FB00>]}
[0m17:07:36.256417 [debug] [MainThread]: Flushing usage events
[0m17:08:42.599571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B972D9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B988BCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98583860>]}


============================== 17:08:42.604911 | 8345cbf1-73e5-4210-bbdc-5aef49989c0f ==============================
[0m17:08:42.604911 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:08:42.605447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:42.836812 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:08:42.837813 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:08:42.986515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B994CF2C0>]}
[0m17:08:43.034119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B94C99B20>]}
[0m17:08:43.035118 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:08:43.047118 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:08:43.205118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:43.206118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:43.234692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B994E5640>]}
[0m17:08:43.302692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B99829700>]}
[0m17:08:43.303692 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m17:08:43.304692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B95A3C110>]}
[0m17:08:43.306692 [info ] [MainThread]: 
[0m17:08:43.307691 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:08:43.310692 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:08:43.327692 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:08:43.328692 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:08:43.328692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:43.332693 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:43.332693 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:43.876901 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:08:43.878901 [debug] [ThreadPool]: On list_dev: Close
[0m17:08:43.880901 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:08:43.886901 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:08:43.886901 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:08:43.887901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:43.887901 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:43.888901 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:44.076356 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.076356 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:08:44.077366 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:08:44.133497 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.134496 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:08:44.164425 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:08:44.175425 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:44.176426 [debug] [MainThread]: On master: BEGIN
[0m17:08:44.176426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:44.176426 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:44.177426 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:44.365896 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.366448 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:44.366991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:08:44.484914 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.488915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98DD87A0>]}
[0m17:08:44.488915 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:44.529918 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:44.530916 [debug] [MainThread]: On master: BEGIN
[0m17:08:44.539916 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.540918 [debug] [MainThread]: On master: COMMIT
[0m17:08:44.541915 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:44.541915 [debug] [MainThread]: On master: COMMIT
[0m17:08:44.560554 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.561567 [debug] [MainThread]: On master: Close
[0m17:08:44.562568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:44.562568 [info ] [MainThread]: 
[0m17:08:44.568127 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m17:08:44.568127 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m17:08:44.569127 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m17:08:44.571127 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m17:08:44.572128 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m17:08:44.573127 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m17:08:44.573127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m17:08:44.574127 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m17:08:44.576127 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m17:08:44.576741 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m17:08:44.577753 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m17:08:44.577753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m17:08:44.578752 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m17:08:44.579753 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m17:08:44.581753 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m17:08:44.581753 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m17:08:44.582753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m17:08:44.583752 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m17:08:44.584752 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m17:08:44.586753 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m17:08:44.586753 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m17:08:44.587753 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m17:08:44.588755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m17:08:44.588755 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m17:08:44.595754 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:44.596755 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m17:08:44.658873 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:44.665244 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:44.665788 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:08:44.666329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:44.666867 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:44.667407 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:44.875853 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:44.876853 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:44.877856 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m17:08:44.997556 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.004558 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.005558 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m17:08:45.061555 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.083313 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:08:45.083313 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.084313 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:08:45.172087 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.173088 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.174088 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:08:45.195535 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.206999 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m17:08:45.216003 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.217003 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m17:08:45.240800 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.242755 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:08:45.244754 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.245756 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:08:45.263754 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.264753 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:08:45.265754 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:08:45.275752 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.278753 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m17:08:45.299752 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m17:08:45.302754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9A0894C0>]}
[0m17:08:45.303754 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.71s]
[0m17:08:45.305753 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m17:08:45.306753 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m17:08:45.307754 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m17:08:45.308753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m17:08:45.308753 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m17:08:45.329753 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:08:45.331754 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m17:08:45.376998 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:08:45.384000 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:08:45.384998 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m17:08:45.384998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:45.385999 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:45.385999 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:45.574719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:45.575720 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:08:45.576719 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m17:08:53.415626 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m17:08:53.417669 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m17:08:53.418737 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:08:53.419284 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m17:08:53.481524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:53.482601 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m17:08:53.483687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98AFB5C0>]}
[0m17:08:53.484235 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 8.18s]
[0m17:08:53.485341 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m17:08:53.486418 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:08:53.486961 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m17:08:53.488133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m17:08:53.488676 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:08:53.492995 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:53.494040 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:08:53.498370 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:53.505422 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:53.505948 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:08:53.506474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:53.506995 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:53.507521 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:53.682877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:53.683396 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:53.684469 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m17:08:54.724959 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:08:54.728959 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.728959 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m17:08:54.788153 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.790151 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:08:54.791152 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.791152 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:08:54.857477 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.858477 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.859477 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:08:54.878477 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.881477 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m17:08:54.883477 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.883477 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m17:08:54.903061 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.904060 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:08:54.905060 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.905060 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:08:54.926060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.926060 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:08:54.927059 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:08:54.937060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:54.938060 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m17:08:54.960063 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m17:08:54.961062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9A151370>]}
[0m17:08:54.962062 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 1.47s]
[0m17:08:54.963062 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:08:54.964062 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:08:54.965060 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m17:08:54.966063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m17:08:54.967062 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:08:54.969059 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:54.971060 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:08:54.976061 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:54.981057 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:54.981057 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:08:54.982058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:54.982058 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:54.983058 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:55.179448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.180449 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.181448 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m17:08:55.573328 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.577327 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.578327 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.637023 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.639023 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:08:55.640024 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.640024 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:08:55.711185 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.712275 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.712814 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:08:55.731641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.734641 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m17:08:55.735641 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.735641 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m17:08:55.753636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.755639 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:08:55.755639 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.756638 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:08:55.775641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.776642 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:08:55.776642 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:08:55.787659 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.788659 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m17:08:55.806659 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m17:08:55.807658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8345cbf1-73e5-4210-bbdc-5aef49989c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B9A150CE0>]}
[0m17:08:55.808659 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 0.84s]
[0m17:08:55.809659 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:08:55.810659 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:55.811659 [debug] [MainThread]: On master: BEGIN
[0m17:08:55.811659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:55.812659 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:08:55.812659 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:08:55.995379 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:55.996379 [debug] [MainThread]: On master: COMMIT
[0m17:08:55.996379 [debug] [MainThread]: Using redshift connection "master"
[0m17:08:55.997380 [debug] [MainThread]: On master: COMMIT
[0m17:08:56.015377 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:08:56.016377 [debug] [MainThread]: On master: Close
[0m17:08:56.017376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:56.017376 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:08:56.018377 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:08:56.018377 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m17:08:56.018377 [info ] [MainThread]: 
[0m17:08:56.019377 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 12.71 seconds (12.71s).
[0m17:08:56.022376 [debug] [MainThread]: Command end result
[0m17:08:56.052377 [info ] [MainThread]: 
[0m17:08:56.053378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:56.054377 [info ] [MainThread]: 
[0m17:08:56.056377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:08:56.057376 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:56.057376 after 13.57 seconds
[0m17:08:56.057376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B972D9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98860770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B98861CA0>]}
[0m17:08:56.058376 [debug] [MainThread]: Flushing usage events
[0m17:31:11.897178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A5FB5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A5FB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A5FB560>]}


============================== 17:31:11.901174 | ee229b4d-d95e-410e-8e81-0ef21b17b228 ==============================
[0m17:31:11.901174 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:31:11.902175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:12.400489 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:31:12.400489 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:31:12.564433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A9D35F0>]}
[0m17:31:12.610093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A2C0B00>]}
[0m17:31:12.612091 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:31:12.625093 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:31:12.946715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:12.947715 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://seeds\signgu.csv
[0m17:31:13.149281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B7F5760>]}
[0m17:31:13.241724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B7F2FC0>]}
[0m17:31:13.242249 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m17:31:13.242776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B845850>]}
[0m17:31:13.244885 [info ] [MainThread]: 
[0m17:31:13.245426 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:31:13.249115 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:31:13.266783 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:31:13.267304 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:31:13.267827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:13.272234 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:13.273807 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:13.834659 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:31:13.836660 [debug] [ThreadPool]: On list_dev: Close
[0m17:31:13.838656 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:31:13.845767 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:31:13.846767 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:31:13.846767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:13.847764 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:13.847764 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:14.042795 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.042795 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:31:14.043796 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:31:14.100863 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.102872 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:31:14.132391 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:31:14.143401 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:14.144402 [debug] [MainThread]: On master: BEGIN
[0m17:31:14.144402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:14.145403 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:14.145403 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:14.342001 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.342001 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:14.342997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:31:14.470899 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.472547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B76BDA0>]}
[0m17:31:14.473546 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:14.516550 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:14.517561 [debug] [MainThread]: On master: BEGIN
[0m17:31:14.525913 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.526913 [debug] [MainThread]: On master: COMMIT
[0m17:31:14.526913 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:14.527913 [debug] [MainThread]: On master: COMMIT
[0m17:31:14.545664 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.546663 [debug] [MainThread]: On master: Close
[0m17:31:14.547664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:14.548665 [info ] [MainThread]: 
[0m17:31:14.551664 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m17:31:14.552664 [info ] [Thread-1 (]: 1 of 2 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m17:31:14.553664 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.signgu'
[0m17:31:14.553664 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m17:31:14.553664 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m17:31:14.582664 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:14.582664 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m17:31:14.583664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:14.583664 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:14.584664 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:14.768562 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:14.769563 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:14.769563 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */
truncate table "dev"."wnsldjqja"."signgu"
[0m17:31:14.873686 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:15.021687 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:15.022687 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("시군구코드", "시도명", "시군구명") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m17:31:15.284937 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:15.290935 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.signgu"
[0m17:31:15.305507 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:31:15.306506 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:15.306506 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:31:15.327988 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:15.329988 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m17:31:15.331988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278571EC920>]}
[0m17:31:15.331988 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file wnsldjqja.signgu .................................... [[32mINSERT 250[0m in 0.78s]
[0m17:31:15.332988 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m17:31:15.333988 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m17:31:15.334988 [info ] [Thread-1 (]: 2 of 2 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m17:31:15.334988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m17:31:15.335988 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m17:31:15.335988 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m17:31:15.443988 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:15.444988 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m17:31:15.444988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:15.445989 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:15.445989 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:15.635405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:15.635941 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:15.637004 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m17:31:15.739763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:16.759616 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:16.760615 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:17.094846 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:18.063204 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:18.063204 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:18.269337 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:19.229508 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:19.230511 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:19.448500 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:20.427088 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:20.427088 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:20.610920 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:21.530675 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:21.531674 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:21.722112 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:22.245457 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:22.246458 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:31:22.518047 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:22.519112 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m17:31:22.521373 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:31:22.521908 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:31:22.522450 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:31:22.542097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:22.543664 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m17:31:22.544725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee229b4d-d95e-410e-8e81-0ef21b17b228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B9C31A0>]}
[0m17:31:22.545810 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 7.21s]
[0m17:31:22.546872 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m17:31:22.548530 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:22.548553 [debug] [MainThread]: On master: BEGIN
[0m17:31:22.548553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:22.549444 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:22.549961 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:22.732014 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:22.733015 [debug] [MainThread]: On master: COMMIT
[0m17:31:22.733015 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:22.734015 [debug] [MainThread]: On master: COMMIT
[0m17:31:22.752015 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:22.753015 [debug] [MainThread]: On master: Close
[0m17:31:22.754015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:22.754015 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:31:22.755015 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:31:22.755015 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m17:31:22.755015 [info ] [MainThread]: 
[0m17:31:22.756017 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m17:31:22.759014 [debug] [MainThread]: Command end result
[0m17:31:22.788015 [info ] [MainThread]: 
[0m17:31:22.789015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:22.790016 [info ] [MainThread]: 
[0m17:31:22.790016 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:31:22.792016 [debug] [MainThread]: Command `dbt seed` succeeded at 17:31:22.792016 after 10.98 seconds
[0m17:31:22.792016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A5D95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859000E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859000D40>]}
[0m17:31:22.793015 [debug] [MainThread]: Flushing usage events
[0m17:31:55.237172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E2FB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E2F98B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754D781F70>]}


============================== 17:31:55.242566 | 34681cd7-c538-47bb-bb27-b6e3814fbff9 ==============================
[0m17:31:55.242566 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:31:55.243662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:55.504481 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:31:55.505481 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:31:55.686606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275493DAE10>]}
[0m17:31:55.746984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754CC04890>]}
[0m17:31:55.747984 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:31:55.761983 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:31:55.951027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:55.952028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:55.984026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754ED482F0>]}
[0m17:31:56.064265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E615100>]}
[0m17:31:56.064265 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m17:31:56.065262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E4A5DC0>]}
[0m17:31:56.067263 [info ] [MainThread]: 
[0m17:31:56.068264 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:31:56.072262 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:31:56.088262 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:31:56.089263 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:31:56.090263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:56.093263 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:56.094263 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:56.676951 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:31:56.678950 [debug] [ThreadPool]: On list_dev: Close
[0m17:31:56.680949 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:31:56.686951 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:31:56.687950 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:31:56.687950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:56.688951 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:56.688951 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:56.901754 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:56.901754 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:31:56.902754 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:31:57.032626 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.034629 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:31:57.068151 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:31:57.080150 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:57.080150 [debug] [MainThread]: On master: BEGIN
[0m17:31:57.081153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:57.081153 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:57.082153 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:57.271352 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.272352 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:57.273352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:31:57.470999 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.474000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754F5A6180>]}
[0m17:31:57.474999 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:57.538335 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:57.539335 [debug] [MainThread]: On master: BEGIN
[0m17:31:57.553332 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.553332 [debug] [MainThread]: On master: COMMIT
[0m17:31:57.554332 [debug] [MainThread]: Using redshift connection "master"
[0m17:31:57.554332 [debug] [MainThread]: On master: COMMIT
[0m17:31:57.573331 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.573331 [debug] [MainThread]: On master: Close
[0m17:31:57.574331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:57.575332 [info ] [MainThread]: 
[0m17:31:57.579334 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m17:31:57.580332 [info ] [Thread-1 (]: 1 of 2 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m17:31:57.581334 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.signgu'
[0m17:31:57.582333 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m17:31:57.582333 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m17:31:57.615335 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:57.616337 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m17:31:57.616337 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:57.617336 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:31:57.617336 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:57.826060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:57.827135 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:57.827667 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */

    create table "dev"."wnsldjqja"."signgu" ("시군구코드" integer,"시도명" varchar(6),"시군구명" varchar(12))
[0m17:31:57.883872 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:31:58.030547 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:31:58.031549 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("시군구코드", "시도명", "시군구명") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m17:32:02.178559 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m17:32:02.184558 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.signgu"
[0m17:32:02.202558 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:32:02.202558 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m17:32:02.203558 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m17:32:02.263349 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:02.265354 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m17:32:02.267355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754ADEC740>]}
[0m17:32:02.267355 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file wnsldjqja.signgu .................................... [[32mINSERT 250[0m in 4.69s]
[0m17:32:02.268351 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m17:32:02.269352 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m17:32:02.269352 [info ] [Thread-1 (]: 2 of 2 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m17:32:02.270352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m17:32:02.270352 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m17:32:02.271351 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m17:32:02.383354 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:02.384354 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m17:32:02.384354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:02.385354 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:02.385354 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:02.581831 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:02.582832 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:02.583830 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m17:32:02.683653 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:03.698617 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:03.699615 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:04.040376 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:04.947798 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:04.947798 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:05.149016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:06.162970 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:06.163485 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:06.356147 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:07.273290 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:07.274292 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:07.459755 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:08.382013 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:08.383013 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:08.623823 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:09.143950 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:09.144953 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m17:32:09.370086 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:09.371085 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m17:32:09.373085 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:32:09.373085 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m17:32:09.373085 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m17:32:09.396391 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:09.397391 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m17:32:09.398392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34681cd7-c538-47bb-bb27-b6e3814fbff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754F8E0D40>]}
[0m17:32:09.399392 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 7.13s]
[0m17:32:09.399392 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m17:32:09.401392 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:09.401392 [debug] [MainThread]: On master: BEGIN
[0m17:32:09.402393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:09.403391 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:09.403391 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:09.611414 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:09.611414 [debug] [MainThread]: On master: COMMIT
[0m17:32:09.612415 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:09.612415 [debug] [MainThread]: On master: COMMIT
[0m17:32:09.636091 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:09.636091 [debug] [MainThread]: On master: Close
[0m17:32:09.637103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:09.637103 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:32:09.638101 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:32:09.638101 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m17:32:09.638101 [info ] [MainThread]: 
[0m17:32:09.639103 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 13.57 seconds (13.57s).
[0m17:32:09.640105 [debug] [MainThread]: Command end result
[0m17:32:09.727103 [info ] [MainThread]: 
[0m17:32:09.727103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:09.728104 [info ] [MainThread]: 
[0m17:32:09.729104 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:32:09.730103 [debug] [MainThread]: Command `dbt seed` succeeded at 17:32:09.730103 after 14.61 seconds
[0m17:32:09.731102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E36CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E36C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754E36CF80>]}
[0m17:32:09.731102 [debug] [MainThread]: Flushing usage events
[0m17:32:15.790195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE57667B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE4EBDE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE1654D10>]}


============================== 17:32:15.796194 | a381b6dd-288c-4225-869d-6a8e10a84fe3 ==============================
[0m17:32:15.796194 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:32:15.797194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:16.009104 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:32:16.010102 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:32:16.170011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE4400A40>]}
[0m17:32:16.225092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE5A87E00>]}
[0m17:32:16.226092 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:32:16.238090 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:32:16.400711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:16.401710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:16.432713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE565A000>]}
[0m17:32:16.507712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6B1D940>]}
[0m17:32:16.508713 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m17:32:16.509711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE63A1F40>]}
[0m17:32:16.511709 [info ] [MainThread]: 
[0m17:32:16.512711 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:32:16.515711 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:32:16.532710 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:32:16.533710 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:32:16.533710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:16.537711 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:16.538710 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:17.110719 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:32:17.113618 [debug] [ThreadPool]: On list_dev: Close
[0m17:32:17.116261 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:32:17.123743 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:32:17.124271 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:32:17.124794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:17.125320 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:17.125857 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:17.320275 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:17.321276 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:32:17.321276 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:32:17.378743 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:17.380745 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:32:17.407299 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:32:17.418302 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:17.419303 [debug] [MainThread]: On master: BEGIN
[0m17:32:17.419303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:17.420303 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:17.420303 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:17.935044 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m17:32:17.936050 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:17.936050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:32:18.055829 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:18.059827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6CA5F40>]}
[0m17:32:18.059827 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:18.105033 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:18.106036 [debug] [MainThread]: On master: BEGIN
[0m17:32:18.117107 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:18.117107 [debug] [MainThread]: On master: COMMIT
[0m17:32:18.118106 [debug] [MainThread]: Using redshift connection "master"
[0m17:32:18.118106 [debug] [MainThread]: On master: COMMIT
[0m17:32:18.137554 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:18.137554 [debug] [MainThread]: On master: Close
[0m17:32:18.138565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:18.139565 [info ] [MainThread]: 
[0m17:32:18.142565 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m17:32:18.143567 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m17:32:18.143567 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m17:32:18.145566 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m17:32:18.147568 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m17:32:18.147568 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m17:32:18.148564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m17:32:18.148564 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m17:32:18.150564 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m17:32:18.150564 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m17:32:18.151566 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m17:32:18.151566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m17:32:18.152565 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m17:32:18.153564 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m17:32:18.154567 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m17:32:18.155566 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m17:32:18.155566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m17:32:18.155566 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m17:32:18.157569 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m17:32:18.158569 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m17:32:18.158569 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m17:32:18.159569 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m17:32:18.160569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m17:32:18.160569 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m17:32:18.166566 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:18.167564 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m17:32:18.210181 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:18.213183 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:18.214183 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:32:18.214183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:18.215181 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:18.215181 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:18.398434 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:18.399435 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:18.399435 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m17:32:28.013142 [debug] [Thread-1 (]: SQL status: SUCCESS in 10.0 seconds
[0m17:32:28.020492 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.021523 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m17:32:28.079678 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.096695 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:32:28.097696 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.097696 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:32:28.241022 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.242032 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.242032 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:32:28.262819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.269824 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m17:32:28.274824 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.275824 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m17:32:28.296684 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.297686 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:32:28.298686 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.298686 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:32:28.324069 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.324069 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:32:28.325070 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:32:28.335914 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.337923 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m17:32:28.356718 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m17:32:28.357728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE4E8F770>]}
[0m17:32:28.358727 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 10.20s]
[0m17:32:28.359729 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m17:32:28.360728 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m17:32:28.360728 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m17:32:28.361727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m17:32:28.361727 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m17:32:28.375729 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:32:28.376727 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m17:32:28.402324 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:32:28.408324 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:32:28.408324 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m17:32:28.409324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:28.409324 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:28.410324 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:28.617606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:28.617606 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:32:28.618603 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
)
SELECT 
    left(signguCode,5) signgucode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM
    src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON a.signguCode = b.signguCode
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m17:32:36.962487 [debug] [Thread-1 (]: SQL status: SUCCESS in 8.0 seconds
[0m17:32:36.964492 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m17:32:36.965492 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:32:36.965492 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m17:32:37.043167 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:37.044167 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m17:32:37.046301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE294EDE0>]}
[0m17:32:37.046840 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 8.68s]
[0m17:32:37.047907 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m17:32:37.048957 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:32:37.049479 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m17:32:37.050084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m17:32:37.050610 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:32:37.054289 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:37.055346 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:32:37.058860 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:37.062860 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:37.063860 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:32:37.063860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:37.064859 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:37.064859 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:37.240147 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:37.241148 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:37.241148 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m17:32:52.261183 [debug] [Thread-1 (]: SQL status: SUCCESS in 15.0 seconds
[0m17:32:52.264564 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.265100 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m17:32:52.319773 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.321775 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:32:52.322775 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.322775 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:32:52.373972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.374972 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.376974 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:32:52.395975 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.397973 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m17:32:52.400973 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.400973 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m17:32:52.419637 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.421638 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:32:52.422638 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.422638 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m17:32:52.442641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.443641 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m17:32:52.443641 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m17:32:52.453641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.455639 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m17:32:52.475641 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m17:32:52.476641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE714D6D0>]}
[0m17:32:52.476641 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 15.43s]
[0m17:32:52.477640 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:32:52.478642 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:32:52.479640 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m17:32:52.479640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m17:32:52.480640 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:32:52.482641 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:32:52.483640 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:32:52.488346 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:32:52.491346 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:32:52.491346 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:32:52.492346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:52.492346 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:32:52.493346 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:32:52.676029 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:32:52.676029 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:32:52.677027 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m17:33:04.352535 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m17:33:04.356539 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.356539 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.422940 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.425944 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:33:04.426944 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.426944 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:33:04.490828 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.491828 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.492828 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:33:04.513345 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.516344 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m17:33:04.517344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.517344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m17:33:04.538343 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.539344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:33:04.540344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.541344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m17:33:04.561345 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.562344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m17:33:04.562344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m17:33:04.573342 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.575344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m17:33:04.596345 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m17:33:04.597343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a381b6dd-288c-4225-869d-6a8e10a84fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE714D6A0>]}
[0m17:33:04.598344 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 12.12s]
[0m17:33:04.598344 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:33:04.600344 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:04.600344 [debug] [MainThread]: On master: BEGIN
[0m17:33:04.601343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:04.601343 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:33:04.602344 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:04.809047 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.810046 [debug] [MainThread]: On master: COMMIT
[0m17:33:04.810046 [debug] [MainThread]: Using redshift connection "master"
[0m17:33:04.811047 [debug] [MainThread]: On master: COMMIT
[0m17:33:04.830572 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:33:04.831572 [debug] [MainThread]: On master: Close
[0m17:33:04.831572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:04.832572 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:33:04.832572 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:33:04.832572 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m17:33:04.833572 [info ] [MainThread]: 
[0m17:33:04.834573 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 48.32 seconds (48.32s).
[0m17:33:04.836575 [debug] [MainThread]: Command end result
[0m17:33:04.871725 [info ] [MainThread]: 
[0m17:33:04.872725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:04.873725 [info ] [MainThread]: 
[0m17:33:04.873725 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:33:04.874724 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:04.874724 after 49.18 seconds
[0m17:33:04.875724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE5912A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE16553D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE5681BB0>]}
[0m17:33:04.875724 [debug] [MainThread]: Flushing usage events
[0m17:58:48.799151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543DF88FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543A644BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543DA27D70>]}


============================== 17:58:48.804152 | 7cb551eb-cac8-4005-af33-a3aa99ba6374 ==============================
[0m17:58:48.804152 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:58:48.805153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:58:49.020764 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:58:49.020764 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:58:49.175823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543E9815B0>]}
[0m17:58:49.226092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543E9A4050>]}
[0m17:58:49.228017 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:58:49.240061 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:58:49.415057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m17:58:49.416060 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://seeds\zNex~$haresigngu.csv
[0m17:58:49.416060 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m17:58:49.417059 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m17:58:49.750238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543F415C10>]}
[0m17:58:49.821238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543F52F5C0>]}
[0m17:58:49.821238 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m17:58:49.822238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543FB63380>]}
[0m17:58:49.824238 [info ] [MainThread]: 
[0m17:58:49.825238 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:58:49.829238 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:58:49.844235 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:58:49.844235 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:58:49.845236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:49.849236 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:49.850236 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:50.376148 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:58:50.378145 [debug] [ThreadPool]: On list_dev: Close
[0m17:58:50.380146 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:58:50.387149 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:58:50.387149 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:58:50.388149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:50.388149 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:50.389148 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:50.567524 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:50.568524 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:58:50.568524 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:58:50.627523 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:50.629525 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:58:50.655525 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:58:50.666525 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:50.667525 [debug] [MainThread]: On master: BEGIN
[0m17:58:50.667525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:50.667525 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:50.668525 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:50.855677 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:50.856677 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:50.856677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:58:50.982828 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:50.985826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543E9A4470>]}
[0m17:58:50.985826 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:51.029828 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:51.030829 [debug] [MainThread]: On master: BEGIN
[0m17:58:51.039826 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.039826 [debug] [MainThread]: On master: COMMIT
[0m17:58:51.040824 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:51.040824 [debug] [MainThread]: On master: COMMIT
[0m17:58:51.059356 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.060355 [debug] [MainThread]: On master: Close
[0m17:58:51.061356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:51.062358 [info ] [MainThread]: 
[0m17:58:51.065355 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m17:58:51.066357 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m17:58:51.066357 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m17:58:51.068358 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m17:58:51.069359 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m17:58:51.070359 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m17:58:51.070359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m17:58:51.071358 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m17:58:51.072359 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m17:58:51.073358 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m17:58:51.074383 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m17:58:51.074383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m17:58:51.075371 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m17:58:51.077372 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m17:58:51.078374 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m17:58:51.079372 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m17:58:51.079372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m17:58:51.080375 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m17:58:51.086374 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m17:58:51.087375 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m17:58:51.088375 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m17:58:51.088375 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m17:58:51.089371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m17:58:51.090373 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m17:58:51.097053 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.099054 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m17:58:51.142083 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.146623 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.147697 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:58:51.147697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:51.148777 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:51.148777 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:51.354000 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.354000 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.355000 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m17:58:51.655765 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.662791 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.663333 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m17:58:51.751104 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.754320 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.754863 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m17:58:51.788255 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.811807 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:58:51.812888 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.813400 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:58:51.885713 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.886714 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.887713 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:58:51.910811 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.917576 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m17:58:51.922360 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.922894 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m17:58:51.947767 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:51.949772 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:58:51.949772 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:51.950772 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:58:52.003585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.004099 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:58:52.005098 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:58:52.015931 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.018031 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m17:58:52.076099 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m17:58:52.078356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543B5ECBC0>]}
[0m17:58:52.078888 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.99s]
[0m17:58:52.079949 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m17:58:52.080493 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m17:58:52.081035 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m17:58:52.082105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m17:58:52.082638 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m17:58:52.094274 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:58:52.095275 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m17:58:52.123727 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:58:52.134215 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:58:52.134215 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m17:58:52.135215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:52.135215 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:52.136216 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:52.328815 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.328815 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:58:52.329812 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a 
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m17:58:52.347483 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column reference "signgucode" is ambiguous
[0m17:58:52.348010 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m17:58:52.371681 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m17:58:52.397880 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column reference "signgucode" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m17:58:52.398879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb551eb-cac8-4005-af33-a3aa99ba6374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254404453D0>]}
[0m17:58:52.398879 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.32s]
[0m17:58:52.400880 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m17:58:52.401880 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:58:52.401880 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m17:58:52.402880 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:58:52.403879 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:58:52.403879 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m17:58:52.404880 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:58:52.405881 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:52.406880 [debug] [MainThread]: On master: BEGIN
[0m17:58:52.406880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:52.407878 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:58:52.407878 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:52.623674 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.624676 [debug] [MainThread]: On master: COMMIT
[0m17:58:52.625676 [debug] [MainThread]: Using redshift connection "master"
[0m17:58:52.625676 [debug] [MainThread]: On master: COMMIT
[0m17:58:52.651270 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:58:52.651270 [debug] [MainThread]: On master: Close
[0m17:58:52.652270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:52.652270 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:58:52.653270 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:58:52.653270 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m17:58:52.654270 [info ] [MainThread]: 
[0m17:58:52.654270 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m17:58:52.656271 [debug] [MainThread]: Command end result
[0m17:58:52.685270 [info ] [MainThread]: 
[0m17:58:52.686271 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:58:52.686271 [info ] [MainThread]: 
[0m17:58:52.687271 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column reference "signgucode" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m17:58:52.687271 [info ] [MainThread]: 
[0m17:58:52.688270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m17:58:52.689269 [debug] [MainThread]: Command `dbt run` failed at 17:58:52.689269 after 3.98 seconds
[0m17:58:52.690271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543D426570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543E95F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002543E95F5C0>]}
[0m17:58:52.690271 [debug] [MainThread]: Flushing usage events
[0m17:59:17.345504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E363DA8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3666308F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E365577FB0>]}


============================== 17:59:17.350954 | 7045a9a8-6095-4b5c-8ec6-e5e03c043580 ==============================
[0m17:59:17.350954 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:59:17.352042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:59:17.617443 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m17:59:17.617983 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m17:59:17.782118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E366631CD0>]}
[0m17:59:17.835949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E366982BA0>]}
[0m17:59:17.836950 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m17:59:17.847967 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:59:18.023437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:18.024529 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m17:59:18.244626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E367AB1430>]}
[0m17:59:18.319704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E36782CE90>]}
[0m17:59:18.320791 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m17:59:18.321327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3679F1130>]}
[0m17:59:18.323450 [info ] [MainThread]: 
[0m17:59:18.323981 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:59:18.328201 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:59:18.343741 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:59:18.344728 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m17:59:18.344728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:18.348728 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:18.349729 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:18.920152 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m17:59:18.922150 [debug] [ThreadPool]: On list_dev: Close
[0m17:59:18.925151 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m17:59:18.932150 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:59:18.933152 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m17:59:18.933152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:18.934152 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:18.934152 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:19.138213 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.139212 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m17:59:19.139212 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m17:59:19.196754 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.198754 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m17:59:19.227280 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m17:59:19.238866 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:19.238866 [debug] [MainThread]: On master: BEGIN
[0m17:59:19.239867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:19.239867 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:19.239867 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:19.435550 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.436076 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:19.436076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m17:59:19.560558 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.563561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3679F1790>]}
[0m17:59:19.563561 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:19.625709 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:19.626259 [debug] [MainThread]: On master: BEGIN
[0m17:59:19.646503 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.648126 [debug] [MainThread]: On master: COMMIT
[0m17:59:19.648632 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:19.649461 [debug] [MainThread]: On master: COMMIT
[0m17:59:19.690192 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.691192 [debug] [MainThread]: On master: Close
[0m17:59:19.691192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:19.692192 [info ] [MainThread]: 
[0m17:59:19.697738 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m17:59:19.698826 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m17:59:19.699371 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m17:59:19.702714 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m17:59:19.704348 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m17:59:19.705452 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m17:59:19.706530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m17:59:19.707080 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m17:59:19.708703 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m17:59:19.709826 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m17:59:19.710487 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m17:59:19.711008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m17:59:19.712072 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m17:59:19.713655 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m17:59:19.715277 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m17:59:19.715815 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m17:59:19.716337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m17:59:19.716875 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m17:59:19.723813 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m17:59:19.726143 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m17:59:19.726699 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m17:59:19.727227 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m17:59:19.728322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m17:59:19.729417 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m17:59:19.736735 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:19.737733 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m17:59:19.786735 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:19.790732 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:19.791733 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:59:19.791733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:19.792734 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:19.792734 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:19.980255 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:19.981314 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:19.981852 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m17:59:20.080697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.088084 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.088084 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m17:59:20.161046 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.164047 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.165047 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m17:59:20.204167 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.225090 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:59:20.225090 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.226090 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:59:20.307105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.308105 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.308105 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:59:20.336102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.342102 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m17:59:20.348102 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.348102 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m17:59:20.377747 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.379748 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:59:20.379748 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.380748 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m17:59:20.431789 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.432790 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m17:59:20.432790 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m17:59:20.456790 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.458792 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m17:59:20.504014 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m17:59:20.505013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3633EC800>]}
[0m17:59:20.506014 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.78s]
[0m17:59:20.507115 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m17:59:20.508022 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m17:59:20.509110 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m17:59:20.510177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m17:59:20.510729 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m17:59:20.526711 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:59:20.528710 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m17:59:20.568285 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m17:59:20.575774 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:59:20.576772 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m17:59:20.577774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:20.578416 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:20.578950 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:20.861743 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:20.862830 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m17:59:20.863359 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a 
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m17:59:20.882417 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column reference "signgucode" is ambiguous
[0m17:59:20.882957 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m17:59:20.902801 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m17:59:20.908168 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column reference "signgucode" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m17:59:20.908703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7045a9a8-6095-4b5c-8ec6-e5e03c043580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E36822E630>]}
[0m17:59:20.909780 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.40s]
[0m17:59:20.910862 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m17:59:20.911943 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:59:20.912581 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m17:59:20.913459 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m17:59:20.914563 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:59:20.915459 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m17:59:20.916461 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m17:59:20.917461 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:20.917461 [debug] [MainThread]: On master: BEGIN
[0m17:59:20.918461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:20.918461 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m17:59:20.919463 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:59:21.110580 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:21.110580 [debug] [MainThread]: On master: COMMIT
[0m17:59:21.111581 [debug] [MainThread]: Using redshift connection "master"
[0m17:59:21.111581 [debug] [MainThread]: On master: COMMIT
[0m17:59:21.133173 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m17:59:21.134169 [debug] [MainThread]: On master: Close
[0m17:59:21.135170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:21.135170 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:59:21.135170 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m17:59:21.136168 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m17:59:21.136168 [info ] [MainThread]: 
[0m17:59:21.137170 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:59:21.138169 [debug] [MainThread]: Command end result
[0m17:59:21.171688 [info ] [MainThread]: 
[0m17:59:21.172690 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:21.173688 [info ] [MainThread]: 
[0m17:59:21.174685 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column reference "signgucode" is ambiguous
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m17:59:21.174685 [info ] [MainThread]: 
[0m17:59:21.175685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m17:59:21.177684 [debug] [MainThread]: Command `dbt run` failed at 17:59:21.177684 after 3.94 seconds
[0m17:59:21.178685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E363DA8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3655D3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E36686E9F0>]}
[0m17:59:21.178685 [debug] [MainThread]: Flushing usage events
[0m18:01:00.873285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F9DB9DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F9DB9D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA03309B0>]}


============================== 18:01:00.877283 | 6f7501d9-8d22-4dd9-b68c-988e87f2f227 ==============================
[0m18:01:00.877283 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:01:00.878285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:01:01.095117 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:01:01.096117 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:01:01.241529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA02397F0>]}
[0m18:01:01.290111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F9D4235F0>]}
[0m18:01:01.292110 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:01:01.303111 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:01:01.462213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:01.462213 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m18:01:01.654209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA1990FE0>]}
[0m18:01:01.724019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA1956A50>]}
[0m18:01:01.725018 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m18:01:01.725018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA196E630>]}
[0m18:01:01.727020 [info ] [MainThread]: 
[0m18:01:01.728018 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:01:01.731019 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:01:01.747021 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:01:01.747021 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:01:01.748023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:01.751022 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:01.752022 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:02.331660 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:01:02.333660 [debug] [ThreadPool]: On list_dev: Close
[0m18:01:02.335660 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:01:02.341660 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:01:02.342660 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:01:02.342660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:02.343662 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:02.343662 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:02.531720 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:02.532725 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:01:02.533725 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:01:02.594663 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:02.596663 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:01:02.623644 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:01:02.634650 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:02.635649 [debug] [MainThread]: On master: BEGIN
[0m18:01:02.635649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:02.636649 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:02.636649 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:02.817686 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:02.817686 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:02.818686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:01:02.942825 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:02.944824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA183E2D0>]}
[0m18:01:02.945826 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:02.989030 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:02.990030 [debug] [MainThread]: On master: BEGIN
[0m18:01:03.003030 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.004030 [debug] [MainThread]: On master: COMMIT
[0m18:01:03.004030 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:03.005030 [debug] [MainThread]: On master: COMMIT
[0m18:01:03.023028 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.024030 [debug] [MainThread]: On master: Close
[0m18:01:03.025030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:03.025030 [info ] [MainThread]: 
[0m18:01:03.029030 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:01:03.029030 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:01:03.030033 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:01:03.031033 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:01:03.033029 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:01:03.033029 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:01:03.034032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:01:03.034032 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:01:03.036032 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:01:03.037032 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:01:03.037032 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:01:03.038032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:01:03.038032 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:01:03.040032 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:01:03.041032 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:01:03.041032 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:01:03.042032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:01:03.042032 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:01:03.048030 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:01:03.049031 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:01:03.050032 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:01:03.051028 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:01:03.051028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:01:03.052029 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:01:03.059028 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.060031 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:01:03.108725 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.113726 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.113726 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:01:03.114725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:03.115726 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:03.116726 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:03.324283 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.324283 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.325284 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:01:03.428212 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.434212 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.434212 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:01:03.512100 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.515110 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.516112 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:01:03.552787 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.571631 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:01:03.572630 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.573632 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:01:03.665636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.666636 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.666636 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:01:03.691795 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.697794 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:01:03.701794 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.702794 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:01:03.727930 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.728928 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:01:03.728928 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.729929 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:01:03.772928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.773928 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:01:03.773928 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:01:03.787928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:03.789928 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:01:03.813584 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:01:03.815592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F9D1ECAD0>]}
[0m18:01:03.815592 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.76s]
[0m18:01:03.816592 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:01:03.817592 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:01:03.818590 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:01:03.818590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:01:03.819592 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:01:03.833591 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:01:03.834591 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:01:03.861590 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:01:03.870591 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:01:03.870591 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:01:03.870591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:03.871592 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:03.871592 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:04.048233 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:04.049233 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:01:04.050232 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    a.signguCode,
    cityNm,
    signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a 
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:01:04.070233 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column b.signgunm does not exist
[0m18:01:04.070233 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m18:01:04.089723 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:01:04.094725 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:01:04.094725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f7501d9-8d22-4dd9-b68c-988e87f2f227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA203F6E0>]}
[0m18:01:04.095724 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.28s]
[0m18:01:04.096724 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:01:04.097723 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:01:04.098725 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m18:01:04.098725 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:01:04.099722 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:01:04.099722 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m18:01:04.100724 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:01:04.101721 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:04.102722 [debug] [MainThread]: On master: BEGIN
[0m18:01:04.102722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:04.102722 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:01:04.103722 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:01:04.284606 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:04.285702 [debug] [MainThread]: On master: COMMIT
[0m18:01:04.286231 [debug] [MainThread]: Using redshift connection "master"
[0m18:01:04.286762 [debug] [MainThread]: On master: COMMIT
[0m18:01:04.304915 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:01:04.304915 [debug] [MainThread]: On master: Close
[0m18:01:04.305915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:04.306916 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:01:04.306916 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:01:04.306916 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m18:01:04.307915 [info ] [MainThread]: 
[0m18:01:04.308916 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m18:01:04.309916 [debug] [MainThread]: Command end result
[0m18:01:04.343489 [info ] [MainThread]: 
[0m18:01:04.343489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:04.345632 [info ] [MainThread]: 
[0m18:01:04.346711 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:01:04.347247 [info ] [MainThread]: 
[0m18:01:04.347778 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m18:01:04.349375 [debug] [MainThread]: Command `dbt run` failed at 18:01:04.349375 after 3.56 seconds
[0m18:01:04.349902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA0300440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA1860F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FA0265D60>]}
[0m18:01:04.350431 [debug] [MainThread]: Flushing usage events
[0m18:01:09.944402 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:03:14.879885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C650FEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C654C9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C677294C0>]}


============================== 18:03:14.883884 | b6acfd30-1fae-473a-b256-0270a0a3de22 ==============================
[0m18:03:14.883884 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:03:14.883884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:03:15.099582 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:03:15.100587 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:03:15.247762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C6954BE60>]}
[0m18:03:15.295764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C69433E90>]}
[0m18:03:15.296764 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:03:15.307763 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:03:15.469763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:15.470764 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m18:03:15.654791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C69D90DA0>]}
[0m18:03:15.723790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C69D56990>]}
[0m18:03:15.723790 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m18:03:15.724791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C69D6A5A0>]}
[0m18:03:15.727791 [info ] [MainThread]: 
[0m18:03:15.728791 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:03:15.731790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:03:15.746792 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:03:15.747792 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:03:15.747792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:15.751792 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:15.752792 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:16.292363 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:03:16.294362 [debug] [ThreadPool]: On list_dev: Close
[0m18:03:16.296364 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:03:16.302362 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:03:16.303362 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:03:16.303362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:16.303362 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:16.304362 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:16.499813 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.500812 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:03:16.500812 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:03:16.559572 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.561571 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:03:16.587959 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:03:16.598161 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:16.599162 [debug] [MainThread]: On master: BEGIN
[0m18:03:16.599162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:16.600163 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:16.600163 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:16.783536 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.783536 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:16.784535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:03:16.905155 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.908155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C69C3CD70>]}
[0m18:03:16.908155 [debug] [MainThread]: On master: ROLLBACK
[0m18:03:16.957222 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:16.958223 [debug] [MainThread]: On master: BEGIN
[0m18:03:16.969222 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.969222 [debug] [MainThread]: On master: COMMIT
[0m18:03:16.970222 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:16.970222 [debug] [MainThread]: On master: COMMIT
[0m18:03:16.989819 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:16.990822 [debug] [MainThread]: On master: Close
[0m18:03:16.991820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:16.991820 [info ] [MainThread]: 
[0m18:03:16.996822 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:03:16.997823 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:03:16.997823 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:03:17.000819 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:03:17.002819 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:03:17.002819 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:03:17.003821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tour_api)
[0m18:03:17.004821 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:03:17.006824 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:03:17.008822 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:03:17.008822 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:03:17.009820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.src_tourist_spot)
[0m18:03:17.010823 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:03:17.012821 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:03:17.014822 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:03:17.015822 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:03:17.016823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:03:17.017821 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:03:17.019822 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:03:17.020820 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:03:17.021820 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:03:17.022820 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:03:17.022820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:03:17.023823 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:03:17.034042 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.035112 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:03:17.097931 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.102931 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.103933 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:03:17.104932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:17.105931 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:17.105931 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:17.309222 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.310222 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.311222 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:03:17.412273 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.419271 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.419271 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:03:17.479271 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.482271 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.482271 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:03:17.508361 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.528374 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:03:17.528374 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.529374 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:03:17.610898 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.611898 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.612899 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:03:17.630071 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.636072 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:03:17.641073 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.642071 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:03:17.662884 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.663884 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:03:17.663884 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.664884 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:03:17.708390 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.709390 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:03:17.709390 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:03:17.719389 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.721390 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:03:17.739671 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:03:17.741671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C658EC8F0>]}
[0m18:03:17.742670 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.72s]
[0m18:03:17.743671 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:03:17.743671 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:03:17.744672 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:03:17.745673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:03:17.746672 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:03:17.760670 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:03:17.762673 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:03:17.789671 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:03:17.798670 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:03:17.798670 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:03:17.799672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:17.799672 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:17.800671 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:17.975895 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:17.975895 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:03:17.976896 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT 
        "시군구코드" signguCode, 
        "시도명" cityNm,
        "시군구명" signguNm
    FROM
        wnsldjqja.signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    a.signguCode,
    cityNm,
    signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a 
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:03:17.995195 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column b.signgunm does not exist
[0m18:03:17.995195 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m18:03:18.015586 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:03:18.019586 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:03:18.020586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6acfd30-1fae-473a-b256-0270a0a3de22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C6A4588F0>]}
[0m18:03:18.021586 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.27s]
[0m18:03:18.022585 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:03:18.023586 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:03:18.023586 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m18:03:18.024585 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:03:18.025588 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:03:18.026586 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m18:03:18.026586 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:03:18.027587 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:18.028589 [debug] [MainThread]: On master: BEGIN
[0m18:03:18.028589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:18.029589 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:18.029589 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:18.205764 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:18.205764 [debug] [MainThread]: On master: COMMIT
[0m18:03:18.206765 [debug] [MainThread]: Using redshift connection "master"
[0m18:03:18.206765 [debug] [MainThread]: On master: COMMIT
[0m18:03:18.225775 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:03:18.226777 [debug] [MainThread]: On master: Close
[0m18:03:18.226777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:18.227778 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:03:18.227778 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:03:18.227778 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m18:03:18.228777 [info ] [MainThread]: 
[0m18:03:18.229776 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m18:03:18.230777 [debug] [MainThread]: Command end result
[0m18:03:18.258417 [info ] [MainThread]: 
[0m18:03:18.258417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:03:18.259414 [info ] [MainThread]: 
[0m18:03:18.260416 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:03:18.261416 [info ] [MainThread]: 
[0m18:03:18.261416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m18:03:18.263416 [debug] [MainThread]: Command `dbt run` failed at 18:03:18.263416 after 3.49 seconds
[0m18:03:18.263416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C68930B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C67DBDAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C688BFA70>]}
[0m18:03:18.264416 [debug] [MainThread]: Flushing usage events
[0m18:04:36.249207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB783DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB7810A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB780200>]}


============================== 18:04:36.253208 | c13ac9e4-ada7-40ac-b835-ae20e879e935 ==============================
[0m18:04:36.253208 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:04:36.254204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:04:36.470166 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:04:36.470700 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:04:36.634089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC0A3E90>]}
[0m18:04:36.692234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC07F320>]}
[0m18:04:36.693868 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:04:36.704829 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:04:36.864501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:36.866121 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m18:04:37.056250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC891070>]}
[0m18:04:37.139978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC8933E0>]}
[0m18:04:37.139978 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m18:04:37.140979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AC857050>]}
[0m18:04:37.142978 [info ] [MainThread]: 
[0m18:04:37.143978 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:04:37.149889 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:04:37.175895 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:04:37.176971 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:04:37.177697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:37.181965 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:37.183576 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:37.764412 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:04:37.767198 [debug] [ThreadPool]: On list_dev: Close
[0m18:04:37.769868 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:04:37.777306 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:04:37.777832 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:04:37.778360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:37.778892 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:37.779419 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:37.985919 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:37.986917 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:04:37.986917 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:04:38.045326 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.047328 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:04:38.076329 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:04:38.087947 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:38.088946 [debug] [MainThread]: On master: BEGIN
[0m18:04:38.089946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:38.089946 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:38.090947 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:38.289710 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.289710 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:38.290711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:04:38.412705 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.414710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB75FEC0>]}
[0m18:04:38.415710 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:38.466710 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:38.466710 [debug] [MainThread]: On master: BEGIN
[0m18:04:38.478710 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.478710 [debug] [MainThread]: On master: COMMIT
[0m18:04:38.479710 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:38.479710 [debug] [MainThread]: On master: COMMIT
[0m18:04:38.498313 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.499310 [debug] [MainThread]: On master: Close
[0m18:04:38.499310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:38.500310 [info ] [MainThread]: 
[0m18:04:38.504309 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:04:38.504309 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:04:38.505309 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:04:38.507310 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:04:38.508310 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:04:38.509310 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:04:38.509310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:04:38.510309 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:04:38.511309 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:04:38.512309 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:04:38.513310 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:04:38.514307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:04:38.515309 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:04:38.517309 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:04:38.518307 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:04:38.519307 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:04:38.519307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:04:38.520308 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:04:38.526308 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:04:38.528309 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:04:38.528309 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:04:38.529307 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:04:38.530309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:04:38.530309 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:04:38.537309 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.538309 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:04:38.582309 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.586307 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.587309 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:04:38.587309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:38.588309 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:38.588309 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:38.774489 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.775050 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.776050 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:04:38.876062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.883061 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.883061 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:04:38.942958 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:38.946640 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:38.947162 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:04:38.980166 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.000272 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:04:39.000272 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:39.001275 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:04:39.076380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.076380 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:39.077382 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:04:39.098448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.104252 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:04:39.110243 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:39.111293 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:04:39.134405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.135496 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:04:39.136038 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:39.136571 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:04:39.189316 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.190394 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:04:39.190915 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:04:39.201333 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.203333 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:04:39.226887 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:04:39.227887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A81ECA70>]}
[0m18:04:39.228886 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.70s]
[0m18:04:39.229887 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:04:39.230886 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:04:39.230886 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:04:39.231887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:04:39.232887 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:04:39.247887 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:04:39.248886 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:04:39.275887 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:04:39.283882 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:04:39.284883 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:04:39.284883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:39.285885 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:39.285885 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:39.493882 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.493882 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:04:39.494882 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    a.signguCode,
    cityNm,
    signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a 
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:04:39.516934 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column b.signgunm does not exist
[0m18:04:39.518019 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m18:04:39.537329 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:04:39.541573 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:04:39.542100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13ac9e4-ada7-40ac-b835-ae20e879e935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9ACF436B0>]}
[0m18:04:39.543154 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.31s]
[0m18:04:39.543674 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:04:39.544739 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:04:39.545738 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m18:04:39.546738 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:04:39.546738 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:04:39.547738 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m18:04:39.547738 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:04:39.549738 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:39.549738 [debug] [MainThread]: On master: BEGIN
[0m18:04:39.550737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:39.550737 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:04:39.551736 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:04:39.745056 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.745056 [debug] [MainThread]: On master: COMMIT
[0m18:04:39.746058 [debug] [MainThread]: Using redshift connection "master"
[0m18:04:39.746058 [debug] [MainThread]: On master: COMMIT
[0m18:04:39.766140 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:04:39.767303 [debug] [MainThread]: On master: Close
[0m18:04:39.767834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:39.768369 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:04:39.768369 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:04:39.768900 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m18:04:39.769428 [info ] [MainThread]: 
[0m18:04:39.770476 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m18:04:39.771530 [debug] [MainThread]: Command end result
[0m18:04:39.801410 [info ] [MainThread]: 
[0m18:04:39.801944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:39.802466 [info ] [MainThread]: 
[0m18:04:39.803467 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:04:39.803467 [info ] [MainThread]: 
[0m18:04:39.804467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m18:04:39.805467 [debug] [MainThread]: Command `dbt run` failed at 18:04:39.805467 after 3.65 seconds
[0m18:04:39.806468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB577470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB575B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9AB2C53A0>]}
[0m18:04:39.806468 [debug] [MainThread]: Flushing usage events
[0m18:06:11.464360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEABDB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEAA8FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEA966420>]}


============================== 18:06:11.469359 | 8fc84d82-0eb5-4002-b972-1ee535fb33b6 ==============================
[0m18:06:11.469359 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:06:11.470358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:06:11.701490 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:06:11.701490 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:06:11.862505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEB6140E0>]}
[0m18:06:11.926022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEB67F320>]}
[0m18:06:11.928025 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:06:11.938025 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:06:12.110087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:12.110087 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m18:06:12.355842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEBE910A0>]}
[0m18:06:12.439842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEBE579B0>]}
[0m18:06:12.440844 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m18:06:12.441844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEBE687D0>]}
[0m18:06:12.442845 [info ] [MainThread]: 
[0m18:06:12.443845 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:06:12.447842 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:06:12.464844 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:06:12.465844 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:06:12.465844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:12.469845 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:12.470843 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:13.034332 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:06:13.037328 [debug] [ThreadPool]: On list_dev: Close
[0m18:06:13.039329 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:06:13.046332 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:06:13.046332 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:06:13.047333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:13.047333 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:13.048333 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:13.241375 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.241375 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:06:13.242375 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:06:13.307392 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.309568 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:06:13.348536 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:06:13.364753 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:13.365289 [debug] [MainThread]: On master: BEGIN
[0m18:06:13.366540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:13.367070 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:13.368127 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:13.738072 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.739072 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:13.739072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:06:13.923275 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.925275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEB525DC0>]}
[0m18:06:13.926275 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:13.968929 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:13.969929 [debug] [MainThread]: On master: BEGIN
[0m18:06:13.981534 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:13.981534 [debug] [MainThread]: On master: COMMIT
[0m18:06:13.982533 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:13.982533 [debug] [MainThread]: On master: COMMIT
[0m18:06:14.002536 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.003535 [debug] [MainThread]: On master: Close
[0m18:06:14.004536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:14.005330 [info ] [MainThread]: 
[0m18:06:14.008901 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:06:14.009902 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:06:14.009902 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:06:14.011902 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:06:14.013902 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:06:14.013902 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:06:14.014903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:06:14.014903 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:06:14.016901 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:06:14.017904 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:06:14.018902 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:06:14.019903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:06:14.019903 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:06:14.021902 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:06:14.022902 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:06:14.023904 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:06:14.023904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:06:14.024904 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:06:14.030901 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:06:14.032901 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:06:14.032901 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:06:14.033903 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:06:14.033903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:06:14.034903 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:06:14.043931 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.045572 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:06:14.095728 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.099725 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.100726 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:06:14.100726 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:14.101727 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:14.101727 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:14.276972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.277970 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.277970 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:06:14.381661 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.388182 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.388182 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:06:14.442181 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.446181 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.447181 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:06:14.473183 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.494184 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:06:14.495183 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.496186 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:06:14.580322 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.581324 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.582326 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:06:14.603001 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.611110 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:06:14.616683 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.617687 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:06:14.638405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.639499 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:06:14.640040 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.640582 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:06:14.684821 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.685930 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:06:14.687018 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:06:14.698952 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:14.701104 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:06:14.719133 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:06:14.721377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE77ECBC0>]}
[0m18:06:14.722454 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.69s]
[0m18:06:14.724069 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:06:14.725338 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:06:14.726445 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:06:14.728061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:06:14.728600 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:06:14.747504 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:06:14.749116 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:06:14.790263 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:06:14.800630 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:06:14.801179 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:06:14.801714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:14.802853 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:14.803933 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:15.005028 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:15.006028 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:06:15.006028 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    a.signguCode,
    b.cityNm,
    b.signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN __dbt__cte__src_tourist_spot b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:06:15.023689 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column b.signgunm does not exist
[0m18:06:15.024691 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m18:06:15.043319 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:06:15.048320 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:06:15.049320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc84d82-0eb5-4002-b972-1ee535fb33b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEC54F410>]}
[0m18:06:15.050318 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.32s]
[0m18:06:15.051316 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:06:15.052318 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:06:15.053320 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m18:06:15.053320 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:06:15.054321 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:06:15.055402 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m18:06:15.056470 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:06:15.058212 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:15.058763 [debug] [MainThread]: On master: BEGIN
[0m18:06:15.059304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:15.060357 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:06:15.060393 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:06:15.254410 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:15.255410 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.255410 [debug] [MainThread]: Using redshift connection "master"
[0m18:06:15.256410 [debug] [MainThread]: On master: COMMIT
[0m18:06:15.278409 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:06:15.279409 [debug] [MainThread]: On master: Close
[0m18:06:15.280413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:15.280413 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:06:15.280413 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:06:15.281413 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m18:06:15.281413 [info ] [MainThread]: 
[0m18:06:15.282412 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m18:06:15.283410 [debug] [MainThread]: Command end result
[0m18:06:15.314409 [info ] [MainThread]: 
[0m18:06:15.314409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:15.315410 [info ] [MainThread]: 
[0m18:06:15.315410 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  column b.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:06:15.316411 [info ] [MainThread]: 
[0m18:06:15.316411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m18:06:15.318411 [debug] [MainThread]: Command `dbt run` failed at 18:06:15.318411 after 3.97 seconds
[0m18:06:15.318411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEAC320C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEAA308F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AEAA332F0>]}
[0m18:06:15.319411 [debug] [MainThread]: Flushing usage events
[0m18:13:49.210060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78630CAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78630F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7855C7230>]}


============================== 18:13:49.214061 | 8ff5562b-97e1-412f-ba1e-c5c3e0496474 ==============================
[0m18:13:49.214061 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:13:49.215061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:13:49.423670 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:13:49.423670 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:13:49.569480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A786B98C50>]}
[0m18:13:49.615479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78787F3E0>]}
[0m18:13:49.616479 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:13:49.627482 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:13:49.790540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:49.791542 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m18:13:49.978164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7880B1430>]}
[0m18:13:50.046165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A787E74A10>]}
[0m18:13:50.047165 [info ] [MainThread]: Found 8 models, 3 seeds, 479 macros
[0m18:13:50.048169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7880B3650>]}
[0m18:13:50.050162 [info ] [MainThread]: 
[0m18:13:50.050162 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:13:50.054166 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:13:50.070165 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:13:50.070165 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:13:50.071167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:50.074874 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:50.075872 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:50.660944 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:13:50.663040 [debug] [ThreadPool]: On list_dev: Close
[0m18:13:50.664076 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:13:50.671068 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:13:50.672067 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:13:50.672067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:50.673067 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:50.673067 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:50.860777 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:50.861835 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:13:50.861835 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:13:50.944375 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:50.946377 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:13:50.975868 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:13:50.986878 [debug] [MainThread]: Using redshift connection "master"
[0m18:13:50.986878 [debug] [MainThread]: On master: BEGIN
[0m18:13:50.986878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:50.987880 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:50.987880 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:51.180106 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.181116 [debug] [MainThread]: Using redshift connection "master"
[0m18:13:51.181116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:13:51.368837 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.370847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7876DD880>]}
[0m18:13:51.370847 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:51.425515 [debug] [MainThread]: Using redshift connection "master"
[0m18:13:51.426518 [debug] [MainThread]: On master: BEGIN
[0m18:13:51.435712 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.435712 [debug] [MainThread]: On master: COMMIT
[0m18:13:51.436711 [debug] [MainThread]: Using redshift connection "master"
[0m18:13:51.436711 [debug] [MainThread]: On master: COMMIT
[0m18:13:51.456800 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.456800 [debug] [MainThread]: On master: Close
[0m18:13:51.457799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:51.458801 [info ] [MainThread]: 
[0m18:13:51.460800 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:13:51.461799 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:13:51.461799 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:13:51.463801 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:13:51.464799 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:13:51.465800 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:13:51.466457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:13:51.466457 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:13:51.468467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:13:51.469468 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:13:51.469468 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:13:51.470468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:13:51.471468 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:13:51.472468 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:13:51.473467 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:13:51.474467 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:13:51.474467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:13:51.474467 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:13:51.481466 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:13:51.482467 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:13:51.482467 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:13:51.483471 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:13:51.483471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:13:51.484468 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:13:51.491467 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.492469 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:13:51.535086 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.539085 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.540086 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:13:51.540086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:51.541087 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:51.541087 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:51.740486 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.740486 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.741485 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:13:51.906761 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.912761 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.912761 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:13:51.979165 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:51.982175 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:51.983175 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:13:52.017076 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.035431 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:13:52.036433 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:52.037431 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:13:52.125584 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.126587 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:52.126587 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:13:52.151237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.157236 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:13:52.161236 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:52.162236 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:13:52.190231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.191233 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:13:52.192232 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:52.192232 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:13:52.265830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.266842 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:13:52.267841 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:13:52.277839 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.279841 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:13:52.300868 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:13:52.302873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A783AE4B60>]}
[0m18:13:52.303873 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.82s]
[0m18:13:52.304873 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:13:52.305871 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:13:52.305871 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:13:52.306870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:13:52.306870 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:13:52.318868 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:13:52.319869 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:13:52.347868 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:13:52.354451 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:13:52.355452 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:13:52.355452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:52.356455 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:52.356455 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:52.539077 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:13:52.540087 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:13:52.540087 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
), tmp AS(
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
)
SELECT
    a.signguCode,
    b.cityNm,
    b.signguNm,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM tmp a
JOIN src_signgu b
ON a.signguCode = b.signguCode
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT * FROM __dbt__cte__src_tour_api
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:14:25.849620 [debug] [Thread-1 (]: SQL status: SUCCESS in 33.0 seconds
[0m18:14:25.851622 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m18:14:25.852622 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:14:25.852622 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m18:14:25.961367 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:25.962368 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:14:25.963371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78852F7D0>]}
[0m18:14:25.964368 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 33.66s]
[0m18:14:25.965368 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:14:25.966369 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:14:25.967368 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m18:14:25.968371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m18:14:25.968371 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:14:25.973800 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:25.974849 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:14:25.978600 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:25.983896 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:25.983896 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:14:25.983896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:25.984892 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:14:25.984892 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:14:26.186298 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:26.187297 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:26.187297 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m18:14:28.170698 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m18:14:28.173695 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.174696 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m18:14:28.237664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.238664 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:14:28.239664 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.240666 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:14:28.350836 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.351837 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.351837 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:14:28.372766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.374769 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m18:14:28.376774 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.376774 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m18:14:28.395926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.396925 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:14:28.396925 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.397925 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:14:28.420842 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.421842 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:14:28.422842 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:14:28.431842 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.431842 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m18:14:28.450243 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m18:14:28.451243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A788095250>]}
[0m18:14:28.451243 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 2.48s]
[0m18:14:28.452243 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:14:28.453244 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:14:28.453244 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m18:14:28.454246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m18:14:28.454246 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:14:28.457244 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:28.458244 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:14:28.461245 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:28.464243 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:28.465244 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:14:28.465244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:28.466245 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:14:28.466245 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:14:28.649593 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:28.649593 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:28.650592 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m18:14:29.668503 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:14:29.674503 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.674503 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.734629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.735628 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:14:29.736629 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.736629 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:14:29.863657 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.864658 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.864658 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:14:29.886657 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.888657 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m18:14:29.889656 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.890659 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m18:14:29.916644 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.918222 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:14:29.918747 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.919273 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:14:29.944543 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.945545 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:14:29.945545 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:14:29.955544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:29.956545 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m18:14:29.975894 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m18:14:29.976939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ff5562b-97e1-412f-ba1e-c5c3e0496474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78857DDC0>]}
[0m18:14:29.977454 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 1.52s]
[0m18:14:29.978497 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:14:29.980080 [debug] [MainThread]: Using redshift connection "master"
[0m18:14:29.980598 [debug] [MainThread]: On master: BEGIN
[0m18:14:29.981121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:29.981644 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:14:29.981644 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:14:30.203624 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:30.204624 [debug] [MainThread]: On master: COMMIT
[0m18:14:30.204624 [debug] [MainThread]: Using redshift connection "master"
[0m18:14:30.205625 [debug] [MainThread]: On master: COMMIT
[0m18:14:30.227624 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:14:30.228625 [debug] [MainThread]: On master: Close
[0m18:14:30.229626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:30.229626 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:14:30.229626 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:14:30.230626 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m18:14:30.230626 [info ] [MainThread]: 
[0m18:14:30.231626 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 40.18 seconds (40.18s).
[0m18:14:30.233626 [debug] [MainThread]: Command end result
[0m18:14:30.261209 [info ] [MainThread]: 
[0m18:14:30.261209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:30.262207 [info ] [MainThread]: 
[0m18:14:30.263210 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:14:30.264208 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:30.264208 after 41.14 seconds
[0m18:14:30.264208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A786E872C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A786F80B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A787F29D60>]}
[0m18:14:30.265206 [debug] [MainThread]: Flushing usage events
[0m18:24:00.497810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492280290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144922812B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492280260>]}


============================== 18:24:00.502809 | eecdfecf-8848-496f-b837-834dac103a8c ==============================
[0m18:24:00.502809 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:24:00.504811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:00.786515 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:24:00.787037 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:24:00.967181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014490A00A40>]}
[0m18:24:01.020789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492B1B7D0>]}
[0m18:24:01.021789 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:24:01.037308 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:24:01.231003 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m18:24:01.232005 [debug] [MainThread]: Partial parsing: deleted file: weather_tour_dbt://seeds\zNex~$haresigngu.csv
[0m18:24:01.233006 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\src\src_tour_api.sql
[0m18:24:01.233006 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m18:24:01.443997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014493307D70>]}
[0m18:24:01.532439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492F2C620>]}
[0m18:24:01.533441 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m18:24:01.534440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492BCAE40>]}
[0m18:24:01.536441 [info ] [MainThread]: 
[0m18:24:01.537440 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:24:01.541440 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:24:01.558440 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:24:01.558440 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:24:01.559441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:01.562440 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:01.563441 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:02.188108 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:24:02.191108 [debug] [ThreadPool]: On list_dev: Close
[0m18:24:02.193108 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:24:02.201108 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:24:02.202108 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:24:02.202108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:02.203108 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:02.203108 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:02.399759 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:02.399759 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:24:02.400759 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:24:02.473830 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:02.477087 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:24:02.505194 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:24:02.518194 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:02.519193 [debug] [MainThread]: On master: BEGIN
[0m18:24:02.519193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:02.520194 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:02.521195 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:02.737098 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:02.738101 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:02.739101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:24:02.935399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:02.938401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492F74560>]}
[0m18:24:02.938401 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:03.006400 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:03.007399 [debug] [MainThread]: On master: BEGIN
[0m18:24:03.018399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.019400 [debug] [MainThread]: On master: COMMIT
[0m18:24:03.019400 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:03.020399 [debug] [MainThread]: On master: COMMIT
[0m18:24:03.043399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.043399 [debug] [MainThread]: On master: Close
[0m18:24:03.044399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:03.045399 [info ] [MainThread]: 
[0m18:24:03.050401 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:24:03.050401 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:24:03.051400 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:24:03.053401 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:24:03.054401 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:24:03.055402 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:24:03.056403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:24:03.056403 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:24:03.059404 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:24:03.061401 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:24:03.061401 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:24:03.062401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:24:03.062401 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:24:03.065402 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:24:03.066402 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:24:03.067403 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:24:03.068400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:24:03.068400 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:24:03.073402 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:24:03.075405 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:24:03.076405 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:24:03.076405 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:24:03.077403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:24:03.078404 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:24:03.086402 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.087402 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:24:03.152403 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.157403 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.158402 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:24:03.158402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:03.159402 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:03.159402 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:03.372972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.373972 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.374972 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:24:03.657147 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.664151 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.665148 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:24:03.726007 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.729601 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.729601 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:24:03.761540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.781542 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:24:03.782541 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.783541 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:24:03.883097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.884097 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.885098 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:24:03.903940 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.909948 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:24:03.914947 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.914947 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:24:03.939944 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:03.940943 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:24:03.942066 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:03.942600 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:24:04.014296 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:04.014296 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:24:04.015295 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:24:04.026245 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:04.028243 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:24:04.048566 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:24:04.050563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001448EBE8A10>]}
[0m18:24:04.050563 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.97s]
[0m18:24:04.051563 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:24:04.052563 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:24:04.053564 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:24:04.053564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:24:04.054564 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:24:04.068565 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:24:04.069563 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:24:04.098563 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:24:04.106563 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:24:04.106563 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:24:04.107563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:04.107563 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:04.108563 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:04.299775 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:04.299775 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:24:04.300776 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
)
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT
        a.signguCode,
        b.cityNm,
        b.signguNm,
        baseYmd,
        daywkDivNm,
        touDivNm,
        touNum
    FROM __dbt__cte__src_tour_api a
    JOIN src_signgu b
    ON a.signguCode = b.signguCode
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:24:04.323591 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "src_signgu" does not exist
[0m18:24:04.323591 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: ROLLBACK
[0m18:24:04.342591 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:24:04.347261 [debug] [Thread-1 (]: Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  relation "src_signgu" does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:24:04.347261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eecdfecf-8848-496f-b837-834dac103a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014493A28980>]}
[0m18:24:04.348264 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model wnsldjqja.fact_tour_weather ........ [[31mERROR[0m in 0.29s]
[0m18:24:04.349262 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:24:04.350263 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:24:04.351261 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m18:24:04.351261 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:24:04.352263 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:24:04.353261 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m18:24:04.353261 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:24:04.354262 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:04.355261 [debug] [MainThread]: On master: BEGIN
[0m18:24:04.355261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:04.356263 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:04.357263 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:04.541895 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:04.541895 [debug] [MainThread]: On master: COMMIT
[0m18:24:04.542909 [debug] [MainThread]: Using redshift connection "master"
[0m18:24:04.542909 [debug] [MainThread]: On master: COMMIT
[0m18:24:04.562309 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:24:04.562309 [debug] [MainThread]: On master: Close
[0m18:24:04.563320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:04.563320 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:24:04.564320 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:24:04.564320 [debug] [MainThread]: Connection 'model.weather_tour_dbt.fact_tour_weather' was properly closed.
[0m18:24:04.565322 [info ] [MainThread]: 
[0m18:24:04.565322 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m18:24:04.566322 [debug] [MainThread]: Command end result
[0m18:24:04.593321 [info ] [MainThread]: 
[0m18:24:04.594324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:04.594324 [info ] [MainThread]: 
[0m18:24:04.596321 [error] [MainThread]:   Database Error in model fact_tour_weather (models\fact\fact_tour_weather.sql)
  relation "src_signgu" does not exist
  compiled Code at target\run\weather_tour_dbt\models\fact\fact_tour_weather.sql
[0m18:24:04.596321 [info ] [MainThread]: 
[0m18:24:04.597321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m18:24:04.598322 [debug] [MainThread]: Command `dbt run` failed at 18:24:04.598322 after 4.24 seconds
[0m18:24:04.599320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144905D9C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014491E98740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014492B18530>]}
[0m18:24:04.599320 [debug] [MainThread]: Flushing usage events
[0m18:25:20.461269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BF183B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BF06F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BF06FE00>]}


============================== 18:25:20.465269 | ac7271b3-7e37-412a-a57e-4b8205fe951d ==============================
[0m18:25:20.465269 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:25:20.466270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:25:20.688932 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m18:25:20.689932 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m18:25:20.843590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BFA9CCB0>]}
[0m18:25:20.891589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BFE5F320>]}
[0m18:25:20.892589 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m18:25:20.904589 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:25:21.079008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:21.080008 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\fact\fact_tour_weather.sql
[0m18:25:21.301089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C0FACFE0>]}
[0m18:25:21.404422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C077EC30>]}
[0m18:25:21.404957 [info ] [MainThread]: Found 8 models, 2 seeds, 479 macros
[0m18:25:21.405505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C07A4590>]}
[0m18:25:21.408796 [info ] [MainThread]: 
[0m18:25:21.410511 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:25:21.415192 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:25:21.437873 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:25:21.438872 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m18:25:21.438872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:21.443872 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:21.445874 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:22.081687 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m18:25:22.084686 [debug] [ThreadPool]: On list_dev: Close
[0m18:25:22.087689 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m18:25:22.097686 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:25:22.098686 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m18:25:22.099687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:22.099687 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:22.100687 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:22.348565 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:22.349566 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m18:25:22.349566 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m18:25:22.442144 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:22.443144 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m18:25:22.485048 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m18:25:22.499044 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:22.500043 [debug] [MainThread]: On master: BEGIN
[0m18:25:22.500043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:22.501046 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:22.501046 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:22.718581 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:22.719583 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:22.720583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m18:25:22.904660 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:22.907659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C0FAF290>]}
[0m18:25:22.908657 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:22.975657 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:22.976657 [debug] [MainThread]: On master: BEGIN
[0m18:25:22.987258 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:22.988260 [debug] [MainThread]: On master: COMMIT
[0m18:25:22.989262 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:22.989262 [debug] [MainThread]: On master: COMMIT
[0m18:25:23.007260 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.008259 [debug] [MainThread]: On master: Close
[0m18:25:23.009260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:23.010259 [info ] [MainThread]: 
[0m18:25:23.013259 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m18:25:23.014260 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_signgu'
[0m18:25:23.015260 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m18:25:23.017259 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m18:25:23.018259 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m18:25:23.019259 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m18:25:23.019259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m18:25:23.020260 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m18:25:23.021259 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m18:25:23.022260 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m18:25:23.023259 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m18:25:23.023259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m18:25:23.024260 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m18:25:23.027260 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m18:25:23.028259 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m18:25:23.029259 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m18:25:23.029259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m18:25:23.030260 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m18:25:23.035260 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m18:25:23.036259 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m18:25:23.036259 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m18:25:23.037259 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m18:25:23.038259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m18:25:23.039259 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m18:25:23.047258 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.048259 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m18:25:23.092258 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.096259 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.096259 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:25:23.097258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:23.097258 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:23.098260 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:23.307235 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.308236 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.308236 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
)
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
  );
[0m18:25:23.475918 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.482921 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.482921 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m18:25:23.551887 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.556888 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.557889 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m18:25:23.588888 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.611893 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:25:23.612889 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.613888 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:25:23.715868 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.716868 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.717871 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:25:23.738868 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.747869 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m18:25:23.752870 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.753870 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m18:25:23.817498 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.818498 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:25:23.819496 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.819496 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m18:25:23.894495 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.895496 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m18:25:23.896497 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m18:25:23.907497 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:23.910497 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m18:25:23.930499 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m18:25:23.933499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BCAEC800>]}
[0m18:25:23.934499 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.89s]
[0m18:25:23.935499 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m18:25:23.937496 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m18:25:23.937496 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m18:25:23.939498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m18:25:23.939498 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m18:25:23.957496 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:25:23.958498 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m18:25:23.996496 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m18:25:24.005122 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:25:24.006124 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m18:25:24.006124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:24.007125 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:24.007125 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:24.208456 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:24.208456 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:25:24.209456 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
  
    

  create  table
    "dev"."wnsldjqja"."fact_tour_weather"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
)
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT
        a.signguCode,
        b.cityNm,
        b.signguNm,
        baseYmd,
        daywkDivNm,
        touDivNm,
        touNum
    FROM __dbt__cte__src_tour_api a
    JOIN __dbt__cte__src_signgu b
    ON a.signguCode = b.signguCode
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

  );
[0m18:25:35.966312 [debug] [Thread-1 (]: SQL status: SUCCESS in 12.0 seconds
[0m18:25:35.968400 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m18:25:35.968920 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m18:25:35.969454 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m18:25:36.081564 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:36.082564 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m18:25:36.083564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C171CA70>]}
[0m18:25:36.083564 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 12.15s]
[0m18:25:36.085566 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m18:25:36.086564 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:25:36.087564 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m18:25:36.087564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m18:25:36.088565 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:25:36.092564 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:36.092564 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:25:36.096859 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:36.105852 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:36.106931 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:25:36.107479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:36.108569 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:36.109116 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:36.305170 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:36.306170 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:36.307170 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm
  );
[0m18:25:37.418000 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m18:25:37.422998 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.423997 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m18:25:37.494847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.497550 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:25:37.498084 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.498612 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:25:37.562454 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.563502 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.564036 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:25:37.588582 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.590754 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m18:25:37.591885 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.592823 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m18:25:37.614342 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.616345 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:25:37.617344 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.617344 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m18:25:37.636872 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.637870 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m18:25:37.638870 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m18:25:37.651949 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:37.653020 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m18:25:37.679687 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m18:25:37.680752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C0EBD250>]}
[0m18:25:37.681799 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 1.59s]
[0m18:25:37.682858 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m18:25:37.683921 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:25:37.684452 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m18:25:37.684997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m18:25:37.685741 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:25:37.689014 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:37.690089 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:25:37.696322 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:37.700607 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:37.701759 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:25:37.702289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:37.703356 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:37.703876 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:38.014222 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.015321 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.015852 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm
  );
[0m18:25:38.431010 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.434065 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.435059 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.499057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.503058 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:25:38.503058 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.504059 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:25:38.582747 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.583748 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.584746 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:25:38.607747 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.611746 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m18:25:38.613746 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.614748 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m18:25:38.644272 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.646273 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:25:38.647274 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.648274 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m18:25:38.668274 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.669275 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m18:25:38.669275 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m18:25:38.679271 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.681271 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m18:25:38.701768 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m18:25:38.703220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7271b3-7e37-412a-a57e-4b8205fe951d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C175E5D0>]}
[0m18:25:38.704283 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 1.02s]
[0m18:25:38.705959 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m18:25:38.708081 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:38.708106 [debug] [MainThread]: On master: BEGIN
[0m18:25:38.708634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:38.709164 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:25:38.709693 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:25:38.902316 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.903313 [debug] [MainThread]: On master: COMMIT
[0m18:25:38.903313 [debug] [MainThread]: Using redshift connection "master"
[0m18:25:38.904313 [debug] [MainThread]: On master: COMMIT
[0m18:25:38.923894 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m18:25:38.924893 [debug] [MainThread]: On master: Close
[0m18:25:38.925895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:38.925895 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:25:38.926895 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m18:25:38.926895 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m18:25:38.927894 [info ] [MainThread]: 
[0m18:25:38.927894 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 17.52 seconds (17.52s).
[0m18:25:38.929894 [debug] [MainThread]: Command end result
[0m18:25:38.962560 [info ] [MainThread]: 
[0m18:25:38.963563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:38.963563 [info ] [MainThread]: 
[0m18:25:38.964562 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:25:38.966560 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:38.966560 after 18.60 seconds
[0m18:25:38.967560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BE500DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7BFB30800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C0A2EE70>]}
[0m18:25:38.967560 [debug] [MainThread]: Flushing usage events
[0m10:04:26.169231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FD380EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FD000A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FB79DEE0>]}


============================== 10:04:26.176230 | 93178b3c-bb95-409a-b606-5958c44b8a0c ==============================
[0m10:04:26.176230 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:04:26.178233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:04:26.817825 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:04:26.818827 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:04:26.996827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FD3D8110>]}
[0m10:04:27.042827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FDADC830>]}
[0m10:04:27.044827 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m10:04:27.058827 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:04:27.390827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m10:04:27.391827 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://seeds\korea_dept.csv
[0m10:04:27.391827 [debug] [MainThread]: Partial parsing: added file: weather_tour_dbt://models\src\src_korea_dept.sql
[0m10:04:27.392827 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city.sql
[0m10:04:27.392827 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m10:04:27.393827 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\dim\dim_tourist_spot.sql
[0m10:04:27.707827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FE44B080>]}
[0m10:04:27.807827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FE581070>]}
[0m10:04:27.808827 [info ] [MainThread]: Found 9 models, 3 seeds, 479 macros
[0m10:04:27.809828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FC6594F0>]}
[0m10:04:27.810828 [info ] [MainThread]: 
[0m10:04:27.811828 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:04:27.815827 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m10:04:27.830827 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m10:04:27.831827 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m10:04:27.831827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:27.835826 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:27.836827 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:28.431027 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:04:28.434029 [debug] [ThreadPool]: On list_dev: Close
[0m10:04:28.439028 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m10:04:28.451027 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:04:28.452028 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m10:04:28.453027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:28.454028 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:28.454028 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:28.675928 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:28.676929 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:04:28.676929 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m10:04:28.738218 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:28.740220 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m10:04:28.774979 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m10:04:28.785990 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:28.785990 [debug] [MainThread]: On master: BEGIN
[0m10:04:28.786990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:28.786990 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:28.787990 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:28.985184 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:28.985184 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:28.986194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:04:29.114331 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.116333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FB14C200>]}
[0m10:04:29.117332 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:29.158740 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:29.159752 [debug] [MainThread]: On master: BEGIN
[0m10:04:29.168585 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.168585 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.169597 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:29.169597 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.189603 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.189603 [debug] [MainThread]: On master: Close
[0m10:04:29.190614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:29.191613 [info ] [MainThread]: 
[0m10:04:29.195660 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.korea_dept
[0m10:04:29.196659 [info ] [Thread-1 (]: 1 of 3 START seed file wnsldjqja.korea_dept .................................... [RUN]
[0m10:04:29.197661 [debug] [Thread-1 (]: Acquiring new redshift connection 'seed.weather_tour_dbt.korea_dept'
[0m10:04:29.197661 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.korea_dept
[0m10:04:29.198661 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.korea_dept
[0m10:04:29.224660 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.korea_dept"
[0m10:04:29.225660 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: BEGIN
[0m10:04:29.225660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:29.226660 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:29.226660 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:29.412997 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.413998 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.korea_dept"
[0m10:04:29.413998 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.korea_dept"} */

    create table "dev"."wnsldjqja"."korea_dept" ("지역코드" varchar(5),"지역이름" varchar(6))
[0m10:04:29.469004 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.492004 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.korea_dept"
[0m10:04:29.493004 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: insert into "dev"."wnsldjqja"."korea_dept" ("지역코드", "지역이름") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m10:04:29.725029 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.731029 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.korea_dept"
[0m10:04:29.749029 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: COMMIT
[0m10:04:29.750029 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.korea_dept"
[0m10:04:29.750029 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: COMMIT
[0m10:04:29.807936 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:29.809945 [debug] [Thread-1 (]: On seed.weather_tour_dbt.korea_dept: Close
[0m10:04:29.810949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240F9DEC920>]}
[0m10:04:29.811947 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file wnsldjqja.korea_dept ................................ [[32mINSERT 17[0m in 0.61s]
[0m10:04:29.812946 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.korea_dept
[0m10:04:29.812946 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.signgu
[0m10:04:29.813947 [info ] [Thread-1 (]: 2 of 3 START seed file wnsldjqja.signgu ........................................ [RUN]
[0m10:04:29.814947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.korea_dept, now seed.weather_tour_dbt.signgu)
[0m10:04:29.814947 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.signgu
[0m10:04:29.815946 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.signgu
[0m10:04:29.828946 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m10:04:29.829945 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: BEGIN
[0m10:04:29.829945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:29.830947 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:29.830947 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:30.020424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:30.021423 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m10:04:30.021423 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.signgu"} */
truncate table "dev"."wnsldjqja"."signgu"
[0m10:04:30.122266 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:30.309271 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m10:04:30.310271 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: insert into "dev"."wnsldjqja"."signgu" ("시군구코드", "시도명", "시군구명") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m10:04:30.494084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:30.495084 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.signgu"
[0m10:04:30.497086 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m10:04:30.498084 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.signgu"
[0m10:04:30.498084 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: COMMIT
[0m10:04:30.520528 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:30.521539 [debug] [Thread-1 (]: On seed.weather_tour_dbt.signgu: Close
[0m10:04:30.522540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FB0276E0>]}
[0m10:04:30.522540 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file wnsldjqja.signgu .................................... [[32mINSERT 250[0m in 0.71s]
[0m10:04:30.523537 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.signgu
[0m10:04:30.523537 [debug] [Thread-1 (]: Began running node seed.weather_tour_dbt.tourist_spot
[0m10:04:30.524538 [info ] [Thread-1 (]: 3 of 3 START seed file wnsldjqja.tourist_spot .................................. [RUN]
[0m10:04:30.524538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.weather_tour_dbt.signgu, now seed.weather_tour_dbt.tourist_spot)
[0m10:04:30.525538 [debug] [Thread-1 (]: Began compiling node seed.weather_tour_dbt.tourist_spot
[0m10:04:30.525538 [debug] [Thread-1 (]: Began executing node seed.weather_tour_dbt.tourist_spot
[0m10:04:30.633537 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:30.633537 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: BEGIN
[0m10:04:30.634537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:30.634537 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:30.635540 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:30.829873 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:30.830873 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:30.830873 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "seed.weather_tour_dbt.tourist_spot"} */
truncate table "dev"."wnsldjqja"."tourist_spot"
[0m10:04:30.921292 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:31.841292 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:31.842295 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:32.162291 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:33.064222 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:33.065222 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:33.235062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:34.182073 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:34.183073 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:34.375821 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:35.277924 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:35.278924 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:35.459970 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:36.356970 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:36.357970 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:36.539445 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:37.118375 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:37.119375 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: insert into "dev"."wnsldjqja"."tourist_spot" ("테마분류", "코스 아이디", "관광지 아이디", "시/군/구 코드", "관광지명", "경도(도)", "위도(도)", "코스순서", "이동시간", "실내구분", "테마명") values
          (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(...
[0m10:04:37.348063 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:37.349074 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.weather_tour_dbt.tourist_spot"
[0m10:04:37.351075 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m10:04:37.352073 [debug] [Thread-1 (]: Using redshift connection "seed.weather_tour_dbt.tourist_spot"
[0m10:04:37.352073 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: COMMIT
[0m10:04:37.369958 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:37.370971 [debug] [Thread-1 (]: On seed.weather_tour_dbt.tourist_spot: Close
[0m10:04:37.371970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93178b3c-bb95-409a-b606-5958c44b8a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FD287A10>]}
[0m10:04:37.371970 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file wnsldjqja.tourist_spot .............................. [[32mINSERT 2785[0m in 6.85s]
[0m10:04:37.372969 [debug] [Thread-1 (]: Finished running node seed.weather_tour_dbt.tourist_spot
[0m10:04:37.373972 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:37.374969 [debug] [MainThread]: On master: BEGIN
[0m10:04:37.374969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:37.374969 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:37.375970 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:37.548400 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:37.548400 [debug] [MainThread]: On master: COMMIT
[0m10:04:37.549414 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:37.549414 [debug] [MainThread]: On master: COMMIT
[0m10:04:37.568378 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:37.568378 [debug] [MainThread]: On master: Close
[0m10:04:37.569379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:37.569379 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:04:37.570379 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m10:04:37.570379 [debug] [MainThread]: Connection 'seed.weather_tour_dbt.tourist_spot' was properly closed.
[0m10:04:37.571378 [info ] [MainThread]: 
[0m10:04:37.572379 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m10:04:37.573380 [debug] [MainThread]: Command end result
[0m10:04:37.600758 [info ] [MainThread]: 
[0m10:04:37.601769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:37.601769 [info ] [MainThread]: 
[0m10:04:37.602769 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:04:37.603769 [debug] [MainThread]: Command `dbt seed` succeeded at 10:04:37.603769 after 11.53 seconds
[0m10:04:37.604770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FB79DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FDB31580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FCF603B0>]}
[0m10:04:37.604770 [debug] [MainThread]: Flushing usage events
[0m10:04:49.430527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F4833E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76BC452E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76BC44C50>]}


============================== 10:04:49.434527 | 1e84cd4d-3e73-46ea-a0aa-3cd776af151a ==============================
[0m10:04:49.434527 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:04:49.435526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:04:49.628527 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:04:49.628527 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:04:49.768527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F770903410>]}
[0m10:04:49.818535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7701A4F50>]}
[0m10:04:49.820114 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m10:04:49.832837 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:04:49.988969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:49.989969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:50.017969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F770B2DD00>]}
[0m10:04:50.084969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F771146360>]}
[0m10:04:50.084969 [info ] [MainThread]: Found 9 models, 3 seeds, 479 macros
[0m10:04:50.085969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77114DDF0>]}
[0m10:04:50.087969 [info ] [MainThread]: 
[0m10:04:50.088971 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:04:50.091969 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m10:04:50.106969 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m10:04:50.107969 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m10:04:50.107969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:50.111969 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:50.111969 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:50.599231 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:50.601230 [debug] [ThreadPool]: On list_dev: Close
[0m10:04:50.602231 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m10:04:50.608231 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:04:50.609230 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m10:04:50.609230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:50.609230 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:50.610231 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:50.781752 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:50.781752 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:04:50.782752 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m10:04:50.839544 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:50.841554 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m10:04:50.869555 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m10:04:50.880555 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:50.880555 [debug] [MainThread]: On master: BEGIN
[0m10:04:50.881557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:50.881557 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:50.882559 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:51.066202 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.066202 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:51.067213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:04:51.187251 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.189261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F770A7E990>]}
[0m10:04:51.189261 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:51.230688 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:51.230688 [debug] [MainThread]: On master: BEGIN
[0m10:04:51.240249 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.240249 [debug] [MainThread]: On master: COMMIT
[0m10:04:51.241256 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:51.241256 [debug] [MainThread]: On master: COMMIT
[0m10:04:51.258932 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.258932 [debug] [MainThread]: On master: Close
[0m10:04:51.259936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:51.259936 [info ] [MainThread]: 
[0m10:04:51.264932 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_korea_dept
[0m10:04:51.264932 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_korea_dept'
[0m10:04:51.265938 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_korea_dept
[0m10:04:51.266933 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_korea_dept"
[0m10:04:51.267933 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_korea_dept
[0m10:04:51.268934 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m10:04:51.268934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_korea_dept, now model.weather_tour_dbt.src_signgu)
[0m10:04:51.268934 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m10:04:51.270936 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m10:04:51.272747 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m10:04:51.273758 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m10:04:51.273758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m10:04:51.273758 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m10:04:51.275758 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m10:04:51.276685 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m10:04:51.276685 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m10:04:51.277694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m10:04:51.277694 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m10:04:51.279693 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m10:04:51.280694 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m10:04:51.280694 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m10:04:51.281693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m10:04:51.281693 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m10:04:51.285694 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m10:04:51.286696 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m10:04:51.287694 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m10:04:51.287694 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m10:04:51.288694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m10:04:51.288694 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m10:04:51.296694 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:04:51.297834 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m10:04:51.338844 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:04:51.343843 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:04:51.344844 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:04:51.344844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:04:51.345845 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:51.345845 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:51.535850 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.536673 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:04:51.536673 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_korea_dept as (
WITH src_korea_dept AS (
    SELECT * FROM wnsldjqja.korea_dept
)
SELECT 
    "지역코드" deptId, 
    "지역이름" cityNm
FROM
    src_korea_dept
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
), kd AS(
    SELECT * FROM __dbt__cte__src_korea_dept
), tmp AS(
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
)

SELECT
    spotName,
    thema,
    signguCode,
    cityNm,
    tmp.signguNm,
    deptId
FROM tmp
LEFT JOIN kd ON tmp.signguNm = kd.signguNm
  );
[0m10:04:51.557373 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column kd.signgunm does not exist
[0m10:04:51.557373 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m10:04:51.580345 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m10:04:51.607345 [debug] [Thread-1 (]: Database Error in model dim_tourist_spot (models\dim\dim_tourist_spot.sql)
  column kd.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\dim\dim_tourist_spot.sql
[0m10:04:51.609345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e84cd4d-3e73-46ea-a0aa-3cd776af151a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F483C80>]}
[0m10:04:51.609345 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model wnsldjqja.dim_tourist_spot ............... [[31mERROR[0m in 0.32s]
[0m10:04:51.610345 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m10:04:51.611345 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m10:04:51.612346 [info ] [Thread-1 (]: 2 of 4 SKIP relation wnsldjqja.fact_tour_weather ............................... [[33mSKIP[0m]
[0m10:04:51.612346 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m10:04:51.613347 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:04:51.613347 [info ] [Thread-1 (]: 3 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city .................. [[33mSKIP[0m]
[0m10:04:51.614346 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:04:51.614346 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:04:51.615347 [info ] [Thread-1 (]: 4 of 4 SKIP relation wnsldjqja.analytics_tour_weather_by_city_not_toudiv ....... [[33mSKIP[0m]
[0m10:04:51.616346 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:04:51.617346 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:51.617346 [debug] [MainThread]: On master: BEGIN
[0m10:04:51.618345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:51.618345 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:04:51.618345 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:04:51.787648 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.788114 [debug] [MainThread]: On master: COMMIT
[0m10:04:51.789126 [debug] [MainThread]: Using redshift connection "master"
[0m10:04:51.789126 [debug] [MainThread]: On master: COMMIT
[0m10:04:51.808037 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:51.808037 [debug] [MainThread]: On master: Close
[0m10:04:51.809053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:51.809053 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:04:51.810050 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m10:04:51.810050 [debug] [MainThread]: Connection 'model.weather_tour_dbt.dim_tourist_spot' was properly closed.
[0m10:04:51.810050 [info ] [MainThread]: 
[0m10:04:51.811050 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m10:04:51.812048 [debug] [MainThread]: Command end result
[0m10:04:51.841051 [info ] [MainThread]: 
[0m10:04:51.841051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:04:51.842049 [info ] [MainThread]: 
[0m10:04:51.842049 [error] [MainThread]:   Database Error in model dim_tourist_spot (models\dim\dim_tourist_spot.sql)
  column kd.signgunm does not exist
  compiled Code at target\run\weather_tour_dbt\models\dim\dim_tourist_spot.sql
[0m10:04:51.843052 [info ] [MainThread]: 
[0m10:04:51.843052 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m10:04:51.844050 [debug] [MainThread]: Command `dbt run` failed at 10:04:51.844050 after 2.49 seconds
[0m10:04:51.845049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77002D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7705D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76FD66030>]}
[0m10:04:51.845049 [debug] [MainThread]: Flushing usage events
[0m10:05:47.703782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA244EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BDA2A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA245520>]}


============================== 10:05:47.707782 | b8997e6c-b3d6-47eb-94a2-93e1aeb149a7 ==============================
[0m10:05:47.707782 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:05:47.708781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:05:47.901781 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:05:47.901781 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:05:48.044105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BE398CB0>]}
[0m10:05:48.091239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BC2ED7F0>]}
[0m10:05:48.092238 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m10:05:48.103240 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:05:48.254238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:05:48.255238 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\dim\dim_tourist_spot.sql
[0m10:05:48.431239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF88D760>]}
[0m10:05:48.495239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF87F1D0>]}
[0m10:05:48.495239 [info ] [MainThread]: Found 9 models, 3 seeds, 479 macros
[0m10:05:48.496239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF86AE10>]}
[0m10:05:48.497240 [info ] [MainThread]: 
[0m10:05:48.498239 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:05:48.501240 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m10:05:48.516239 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m10:05:48.516239 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m10:05:48.516239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:48.520242 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:05:48.522239 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:05:49.010042 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.013052 [debug] [ThreadPool]: On list_dev: Close
[0m10:05:49.014052 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m10:05:49.021053 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:05:49.021053 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m10:05:49.021053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:49.022052 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:05:49.022052 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:05:49.217408 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.218410 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:05:49.218410 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m10:05:49.280982 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.282993 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m10:05:49.312248 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m10:05:49.324259 [debug] [MainThread]: Using redshift connection "master"
[0m10:05:49.324259 [debug] [MainThread]: On master: BEGIN
[0m10:05:49.324259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:49.325260 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:05:49.325260 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:05:49.505365 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.505365 [debug] [MainThread]: Using redshift connection "master"
[0m10:05:49.506377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:05:49.655309 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.657308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF0A1400>]}
[0m10:05:49.657308 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:49.698317 [debug] [MainThread]: Using redshift connection "master"
[0m10:05:49.698317 [debug] [MainThread]: On master: BEGIN
[0m10:05:49.707327 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.707327 [debug] [MainThread]: On master: COMMIT
[0m10:05:49.708327 [debug] [MainThread]: Using redshift connection "master"
[0m10:05:49.708327 [debug] [MainThread]: On master: COMMIT
[0m10:05:49.728035 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.728035 [debug] [MainThread]: On master: Close
[0m10:05:49.729046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:49.730045 [info ] [MainThread]: 
[0m10:05:49.733045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_korea_dept
[0m10:05:49.734046 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_korea_dept'
[0m10:05:49.734046 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_korea_dept
[0m10:05:49.736046 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_korea_dept"
[0m10:05:49.737045 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_korea_dept
[0m10:05:49.737045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m10:05:49.738046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_korea_dept, now model.weather_tour_dbt.src_signgu)
[0m10:05:49.738046 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m10:05:49.739045 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m10:05:49.740046 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m10:05:49.741045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m10:05:49.741045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m10:05:49.742047 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m10:05:49.743046 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m10:05:49.744046 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m10:05:49.745045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m10:05:49.745045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m10:05:49.746048 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m10:05:49.747045 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m10:05:49.748046 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m10:05:49.748046 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m10:05:49.749046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m10:05:49.749046 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m10:05:49.753045 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m10:05:49.754045 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m10:05:49.754045 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m10:05:49.755047 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m10:05:49.756047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m10:05:49.756047 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m10:05:49.765047 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:05:49.766045 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m10:05:49.807045 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:05:49.812045 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:05:49.812045 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:05:49.813045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:05:49.813045 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:05:49.814045 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:05:49.983428 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:05:49.984429 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:05:49.984429 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_korea_dept as (
WITH src_korea_dept AS (
    SELECT * FROM wnsldjqja.korea_dept
)
SELECT 
    "지역코드" deptId, 
    "지역이름" cityNm
FROM
    src_korea_dept
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
), kd AS(
    SELECT * FROM __dbt__cte__src_korea_dept
), tmp AS(
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
)

SELECT
    spotName,
    thema,
    signguCode,
    tmp.cityNm,
    signguNm,
    deptId
FROM tmp
LEFT JOIN kd ON tmp.cityNm = kd.cityNm
  );
[0m10:06:04.275745 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m10:06:04.282768 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.282768 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m10:06:04.348148 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.351171 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.351171 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m10:06:04.380446 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.398470 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:06:04.398470 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.399470 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:06:04.471878 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.472889 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.472889 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:06:04.492878 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.498879 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m10:06:04.503879 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.504880 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m10:06:04.531879 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.532879 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:06:04.533883 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.533883 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:06:04.591877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.591877 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:06:04.592880 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:06:04.601877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:04.603879 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m10:06:04.621879 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m10:06:04.623879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BC2ECA70>]}
[0m10:06:04.624880 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 14.87s]
[0m10:06:04.625880 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m10:06:04.626880 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m10:06:04.627880 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m10:06:04.628880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m10:06:04.628880 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m10:06:04.656878 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:04.657880 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m10:06:04.694878 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:04.695879 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp100604677877"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
)
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT
        a.signguCode,
        b.cityNm,
        b.signguNm,
        baseYmd,
        daywkDivNm,
        touDivNm,
        touNum
    FROM __dbt__cte__src_tour_api a
    JOIN __dbt__cte__src_signgu b
    ON a.signguCode = b.signguCode
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m10:06:04.695879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:04.696878 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:06:04.697878 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:06:19.371046 [debug] [Thread-1 (]: SQL status: SUCCESS in 15.0 seconds
[0m10:06:19.387070 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:19.387070 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m10:06:19.408220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:19.409220 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:19.409220 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp100604677877'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp100604677877'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp100604677877'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:06:19.676937 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:19.690961 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:19.690961 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:06:19.894516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:19.916540 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:19.917528 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp100604677877'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp100604677877'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp100604677877'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:06:20.098854 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:20.111878 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:20.112878 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:06:20.283697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:20.291721 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:06:20.302708 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:20.306710 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:20.306710 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp100604677877"
            );
[0m10:06:20.853758 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:06:20.854770 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:20.854770 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp100604677877"
    )
[0m10:06:20.911944 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:20.913952 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:06:20.914952 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:06:20.914952 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:06:20.967810 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:20.968810 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m10:06:20.969810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BFF3AF60>]}
[0m10:06:20.969810 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 16.34s]
[0m10:06:20.970810 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m10:06:20.971812 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:06:20.972810 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m10:06:20.973811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m10:06:20.973811 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:06:20.976810 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:20.979162 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:06:20.983172 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:20.987874 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:20.987874 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:06:20.988876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:20.988876 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:06:20.989876 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:06:21.164356 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:21.165356 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:21.166356 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode,
        deptId
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    deptId,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm, deptId
  );
[0m10:06:45.898683 [debug] [Thread-1 (]: SQL status: SUCCESS in 25.0 seconds
[0m10:06:45.902683 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:45.902683 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m10:06:45.958684 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:45.963683 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:45.963683 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m10:06:45.992137 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:45.994137 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:06:45.995137 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:45.995137 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:06:46.047927 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.048937 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:46.048937 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:06:46.068388 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.070398 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m10:06:46.071398 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:46.071398 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m10:06:46.093116 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.094117 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:06:46.095116 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:46.095116 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:06:46.147101 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.148103 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:06:46.148103 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:06:46.159159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.160211 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m10:06:46.178983 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m10:06:46.180056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF9EB200>]}
[0m10:06:46.181098 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 25.21s]
[0m10:06:46.181636 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:06:46.182693 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:06:46.183227 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m10:06:46.183748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m10:06:46.184838 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:06:46.187480 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:06:46.188475 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:06:46.191991 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:06:46.195990 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:06:46.195990 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:06:46.195990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:46.196992 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:06:46.196992 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:06:46.371785 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.371785 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:06:46.372797 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    deptId
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm, deptId
  );
[0m10:06:46.384464 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "("
[0m10:06:46.384464 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m10:06:46.402402 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m10:06:46.407402 [debug] [Thread-1 (]: Database Error in model analytics_tour_weather_by_city_not_toudiv (models\analytics\analytics_tour_weather_by_city_not_toudiv.sql)
  syntax error at or near "("
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m10:06:46.407402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8997e6c-b3d6-47eb-94a2-93e1aeb149a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BFFE1B50>]}
[0m10:06:46.408402 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[31mERROR[0m in 0.22s]
[0m10:06:46.409402 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:06:46.411404 [debug] [MainThread]: Using redshift connection "master"
[0m10:06:46.411404 [debug] [MainThread]: On master: BEGIN
[0m10:06:46.411404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:46.412402 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:06:46.412402 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:06:46.600799 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.600799 [debug] [MainThread]: On master: COMMIT
[0m10:06:46.601814 [debug] [MainThread]: Using redshift connection "master"
[0m10:06:46.601814 [debug] [MainThread]: On master: COMMIT
[0m10:06:46.623438 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:06:46.623438 [debug] [MainThread]: On master: Close
[0m10:06:46.624448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:46.624448 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:06:46.625448 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m10:06:46.625448 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m10:06:46.625448 [info ] [MainThread]: 
[0m10:06:46.626448 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 58.13 seconds (58.13s).
[0m10:06:46.628449 [debug] [MainThread]: Command end result
[0m10:06:46.713448 [info ] [MainThread]: 
[0m10:06:46.714448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:06:46.714448 [info ] [MainThread]: 
[0m10:06:46.715448 [error] [MainThread]:   Database Error in model analytics_tour_weather_by_city_not_toudiv (models\analytics\analytics_tour_weather_by_city_not_toudiv.sql)
  syntax error at or near "("
  compiled Code at target\run\weather_tour_dbt\models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m10:06:46.715448 [info ] [MainThread]: 
[0m10:06:46.716449 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:06:46.717449 [debug] [MainThread]: Command `dbt run` failed at 10:06:46.717449 after 59.09 seconds
[0m10:06:46.717449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BE5DB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BE3BFA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BC2ECA70>]}
[0m10:06:46.718448 [debug] [MainThread]: Flushing usage events
[0m10:07:06.255789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BB2778C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BA5837A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BA583380>]}


============================== 10:07:06.259788 | 849c10a9-3607-4a30-b7de-1f5dff595121 ==============================
[0m10:07:06.259788 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:07:06.260789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:07:06.452789 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:07:06.453788 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:07:06.591788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BADDE870>]}
[0m10:07:06.636789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BBD17320>]}
[0m10:07:06.637788 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m10:07:06.648790 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:07:06.802789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:07:06.803789 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m10:07:06.977789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BBD7F350>]}
[0m10:07:07.041789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC58F2C0>]}
[0m10:07:07.042789 [info ] [MainThread]: Found 9 models, 3 seeds, 479 macros
[0m10:07:07.042789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BA5594C0>]}
[0m10:07:07.044789 [info ] [MainThread]: 
[0m10:07:07.045789 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:07:07.048789 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m10:07:07.063789 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m10:07:07.064789 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m10:07:07.064789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:07.068789 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:07.069789 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:07.596790 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:07:07.598792 [debug] [ThreadPool]: On list_dev: Close
[0m10:07:07.601790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m10:07:07.607791 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:07:07.608790 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m10:07:07.608790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:07.609789 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:07.609789 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:07.798024 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:07.799027 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:07:07.799027 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m10:07:07.855588 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:07.857589 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m10:07:07.882588 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m10:07:07.893586 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:07.894588 [debug] [MainThread]: On master: BEGIN
[0m10:07:07.894588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:07.894588 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:07.895588 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:08.082587 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.083588 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:08.083588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:07:08.205587 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.207587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC445940>]}
[0m10:07:08.208587 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:08.263587 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:08.264586 [debug] [MainThread]: On master: BEGIN
[0m10:07:08.274588 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.275588 [debug] [MainThread]: On master: COMMIT
[0m10:07:08.275588 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:08.276587 [debug] [MainThread]: On master: COMMIT
[0m10:07:08.294587 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.294587 [debug] [MainThread]: On master: Close
[0m10:07:08.295588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:08.296588 [info ] [MainThread]: 
[0m10:07:08.300588 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_korea_dept
[0m10:07:08.300588 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_korea_dept'
[0m10:07:08.301587 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_korea_dept
[0m10:07:08.302586 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_korea_dept"
[0m10:07:08.304587 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_korea_dept
[0m10:07:08.304587 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m10:07:08.305587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_korea_dept, now model.weather_tour_dbt.src_signgu)
[0m10:07:08.306588 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m10:07:08.307587 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m10:07:08.308588 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m10:07:08.309587 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m10:07:08.310588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m10:07:08.310588 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m10:07:08.312589 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m10:07:08.313587 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m10:07:08.313587 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m10:07:08.314588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m10:07:08.314588 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m10:07:08.315587 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m10:07:08.316589 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m10:07:08.317586 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m10:07:08.317586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m10:07:08.318586 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m10:07:08.323587 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m10:07:08.324589 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m10:07:08.325588 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m10:07:08.325588 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m10:07:08.326587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m10:07:08.326587 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m10:07:08.335587 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.336586 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m10:07:08.378589 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.383588 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.384586 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:07:08.384586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:07:08.385587 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:08.385587 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:08.581584 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.581584 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.582596 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_korea_dept as (
WITH src_korea_dept AS (
    SELECT * FROM wnsldjqja.korea_dept
)
SELECT 
    "지역코드" deptId, 
    "지역이름" cityNm
FROM
    src_korea_dept
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
), kd AS(
    SELECT * FROM __dbt__cte__src_korea_dept
), tmp AS(
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
)

SELECT
    spotName,
    thema,
    signguCode,
    tmp.cityNm,
    signguNm,
    deptId
FROM tmp
LEFT JOIN kd ON tmp.cityNm = kd.cityNm
  );
[0m10:07:08.882424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.889435 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.889435 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m10:07:08.956295 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:08.959307 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:08.959307 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m10:07:08.992008 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.010006 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:07:09.011006 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:09.011006 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:07:09.087582 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.088586 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:09.088586 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:07:09.110633 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.115619 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m10:07:09.120619 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:09.120619 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m10:07:09.143934 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.144936 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:07:09.145937 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:09.145937 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:07:09.189961 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.189961 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:07:09.190965 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:07:09.200862 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:09.201876 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m10:07:09.221487 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m10:07:09.222486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B7EEC920>]}
[0m10:07:09.223487 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.90s]
[0m10:07:09.224486 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m10:07:09.225487 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m10:07:09.225487 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m10:07:09.226489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m10:07:09.226489 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m10:07:09.250488 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:09.251488 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m10:07:09.283488 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:09.283488 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp100709271487"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
)
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT
        a.signguCode,
        b.cityNm,
        b.signguNm,
        baseYmd,
        daywkDivNm,
        touDivNm,
        touNum
    FROM __dbt__cte__src_tour_api a
    JOIN __dbt__cte__src_signgu b
    ON a.signguCode = b.signguCode
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m10:07:09.284487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:09.284487 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:09.285486 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:12.474343 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m10:07:12.491353 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:12.492353 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m10:07:12.514320 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:12.514320 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:12.515320 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp100709271487'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp100709271487'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp100709271487'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:07:12.774402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:12.790425 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:12.790425 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:07:12.990728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:13.014752 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:13.015741 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp100709271487'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp100709271487'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp100709271487'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:07:13.197411 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:13.211361 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:13.211361 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:07:13.385646 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:13.393669 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:07:13.404669 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:13.407667 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:13.407667 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp100709271487"
            );
[0m10:07:18.969735 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.0 seconds
[0m10:07:18.970744 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:18.970744 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp100709271487"
    )
[0m10:07:19.051721 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:19.053731 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:07:19.053731 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:07:19.054733 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:07:19.126023 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:19.127025 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m10:07:19.128023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC9862D0>]}
[0m10:07:19.129024 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 9.90s]
[0m10:07:19.130024 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m10:07:19.131024 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:07:19.131024 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m10:07:19.132024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m10:07:19.132024 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:07:19.135025 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:19.136023 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:07:19.140023 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:19.145023 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:19.145023 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:07:19.146023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:19.146023 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:19.146023 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:19.332062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:19.333064 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:19.334064 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode,
        deptId
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    touDivNm,
    daywkDivNm,
    deptId,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, touDivNm, daywkDivNm, deptId
  );
[0m10:07:20.794441 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:07:20.798442 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.798442 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m10:07:20.857053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:20.861059 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.862061 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m10:07:20.888139 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:20.890138 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:07:20.890138 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.891140 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:07:20.946364 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:20.946364 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.947377 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:07:20.968208 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:20.970219 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m10:07:20.971217 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.971217 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m10:07:20.993133 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:20.994135 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:07:20.994135 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:20.995133 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:07:21.037418 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:21.037418 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:07:21.038431 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:07:21.047430 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:21.048430 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m10:07:21.065821 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m10:07:21.065821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BCCC52B0>]}
[0m10:07:21.066831 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 1.93s]
[0m10:07:21.067830 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:07:21.068832 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:07:21.068832 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m10:07:21.069835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m10:07:21.069835 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:07:21.072831 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:21.073831 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:07:21.076830 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:21.080830 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:21.080830 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:07:21.081831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:21.081831 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:21.082833 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:21.282544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:21.282544 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:21.283546 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    tm_hour,
    daywkDivNm,
    deptId,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, tm_hour, daywkDivNm, deptId
  );
[0m10:07:38.674407 [debug] [Thread-1 (]: SQL status: SUCCESS in 17.0 seconds
[0m10:07:38.678407 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.679411 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m10:07:38.748407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.752407 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.752407 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.786407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.788410 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:07:38.789408 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.789408 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:07:38.856407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.857409 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.858409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:07:38.880407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.883409 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m10:07:38.884410 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.884410 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m10:07:38.910408 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.912409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:07:38.912409 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.913409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:07:38.962410 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.963409 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:07:38.963409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:07:38.974407 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:38.975409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m10:07:38.996409 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m10:07:38.997409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '849c10a9-3607-4a30-b7de-1f5dff595121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC99D0D0>]}
[0m10:07:38.998408 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 17.93s]
[0m10:07:38.999408 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:07:39.000409 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:39.001409 [debug] [MainThread]: On master: BEGIN
[0m10:07:39.001409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:39.002409 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:07:39.002409 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:07:39.181409 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:39.182411 [debug] [MainThread]: On master: COMMIT
[0m10:07:39.183408 [debug] [MainThread]: Using redshift connection "master"
[0m10:07:39.183408 [debug] [MainThread]: On master: COMMIT
[0m10:07:39.201408 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:07:39.202408 [debug] [MainThread]: On master: Close
[0m10:07:39.203408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:39.203408 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:07:39.203408 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m10:07:39.204409 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m10:07:39.204409 [info ] [MainThread]: 
[0m10:07:39.205408 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 32.16 seconds (32.16s).
[0m10:07:39.206408 [debug] [MainThread]: Command end result
[0m10:07:39.309409 [info ] [MainThread]: 
[0m10:07:39.310408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:39.311410 [info ] [MainThread]: 
[0m10:07:39.311410 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:07:39.313412 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:39.313412 after 33.14 seconds
[0m10:07:39.313412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BA5EC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B698BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219BC49E4E0>]}
[0m10:07:39.314410 [debug] [MainThread]: Flushing usage events
[0m10:15:15.779125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1F68B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1F68B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1F688A10>]}


============================== 10:15:15.783125 | 9f43dcfa-6035-4cee-83c2-8a1850253f03 ==============================
[0m10:15:15.783125 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:15.784124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\skqlt\\.dbt', 'log_path': 'C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:15:15.976124 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m10:15:15.977126 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m10:15:16.119124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1E900890>]}
[0m10:15:16.164124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1C682A50>]}
[0m10:15:16.165124 [info ] [MainThread]: Registered adapter: redshift=1.8.0
[0m10:15:16.176124 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:15:16.328124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:15:16.328124 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city.sql
[0m10:15:16.329125 [debug] [MainThread]: Partial parsing: updated file: weather_tour_dbt://models\analytics\analytics_tour_weather_by_city_not_toudiv.sql
[0m10:15:16.505124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D20C4FF50>]}
[0m10:15:16.569124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D2148F350>]}
[0m10:15:16.570125 [info ] [MainThread]: Found 9 models, 3 seeds, 479 macros
[0m10:15:16.570125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1F65D040>]}
[0m10:15:16.572125 [info ] [MainThread]: 
[0m10:15:16.573125 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m10:15:16.576125 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m10:15:16.592124 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m10:15:16.592124 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m10:15:16.593124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:16.597127 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:16.598125 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:17.146767 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:15:17.149777 [debug] [ThreadPool]: On list_dev: Close
[0m10:15:17.151778 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_wnsldjqja'
[0m10:15:17.158779 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:15:17.158779 [debug] [ThreadPool]: On list_dev_wnsldjqja: BEGIN
[0m10:15:17.159780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:17.159780 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:17.160781 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:17.340544 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.341545 [debug] [ThreadPool]: Using redshift connection "list_dev_wnsldjqja"
[0m10:15:17.341545 [debug] [ThreadPool]: On list_dev_wnsldjqja: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev_wnsldjqja"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'wnsldjqja'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'wnsldjqja'
[0m10:15:17.400094 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.403094 [debug] [ThreadPool]: On list_dev_wnsldjqja: ROLLBACK
[0m10:15:17.430091 [debug] [ThreadPool]: On list_dev_wnsldjqja: Close
[0m10:15:17.441091 [debug] [MainThread]: Using redshift connection "master"
[0m10:15:17.442092 [debug] [MainThread]: On master: BEGIN
[0m10:15:17.442092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:17.443093 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:17.443093 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:17.626904 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.626904 [debug] [MainThread]: Using redshift connection "master"
[0m10:15:17.627914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m10:15:17.744376 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.746385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D20B25E50>]}
[0m10:15:17.747386 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:17.803958 [debug] [MainThread]: Using redshift connection "master"
[0m10:15:17.803958 [debug] [MainThread]: On master: BEGIN
[0m10:15:17.814373 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.814373 [debug] [MainThread]: On master: COMMIT
[0m10:15:17.815375 [debug] [MainThread]: Using redshift connection "master"
[0m10:15:17.815375 [debug] [MainThread]: On master: COMMIT
[0m10:15:17.833929 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:17.833929 [debug] [MainThread]: On master: Close
[0m10:15:17.834942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:17.835940 [info ] [MainThread]: 
[0m10:15:17.838943 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_korea_dept
[0m10:15:17.838943 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.weather_tour_dbt.src_korea_dept'
[0m10:15:17.839944 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_korea_dept
[0m10:15:17.840944 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_korea_dept"
[0m10:15:17.841944 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_korea_dept
[0m10:15:17.842944 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_signgu
[0m10:15:17.842944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_korea_dept, now model.weather_tour_dbt.src_signgu)
[0m10:15:17.843944 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_signgu
[0m10:15:17.844944 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_signgu"
[0m10:15:17.845945 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_signgu
[0m10:15:17.846944 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tourist_spot
[0m10:15:17.846944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_signgu, now model.weather_tour_dbt.src_tourist_spot)
[0m10:15:17.847940 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tourist_spot
[0m10:15:17.848941 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tourist_spot"
[0m10:15:17.849944 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tourist_spot
[0m10:15:17.850944 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_weather_api
[0m10:15:17.850944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tourist_spot, now model.weather_tour_dbt.src_weather_api)
[0m10:15:17.851944 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_weather_api
[0m10:15:17.852944 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_weather_api"
[0m10:15:17.853944 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_weather_api
[0m10:15:17.853944 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.src_tour_api
[0m10:15:17.854944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_weather_api, now model.weather_tour_dbt.src_tour_api)
[0m10:15:17.854944 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.src_tour_api
[0m10:15:17.858942 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.src_tour_api"
[0m10:15:17.859943 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.src_tour_api
[0m10:15:17.860945 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.dim_tourist_spot
[0m10:15:17.860945 [info ] [Thread-1 (]: 1 of 4 START sql table model wnsldjqja.dim_tourist_spot ........................ [RUN]
[0m10:15:17.861944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.src_tour_api, now model.weather_tour_dbt.dim_tourist_spot)
[0m10:15:17.861944 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.dim_tourist_spot
[0m10:15:17.870941 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:17.871945 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.dim_tourist_spot
[0m10:15:17.914943 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:17.919943 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:17.919943 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:15:17.919943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:17.920944 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:17.920944 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:18.120931 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.120931 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.121931 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */

  
    

  create  table
    "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp"
    
    
    
  as (
    WITH  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tourist_spot as (
WITH src_tourist_spot AS (
    SELECT * FROM wnsldjqja.tourist_spot 
)
SELECT 
    "관광지명" spotName,
    "시/군/구 코드" signguCode,
    "테마명" thema
FROM
    src_tourist_spot
),  __dbt__cte__src_korea_dept as (
WITH src_korea_dept AS (
    SELECT * FROM wnsldjqja.korea_dept
)
SELECT 
    "지역코드" deptId, 
    "지역이름" cityNm
FROM
    src_korea_dept
), sg AS (
    SELECT
        signguCode,
        cityNm,
        signguNm
    FROM __dbt__cte__src_signgu
), ts AS(
    SELECT 
        spotName,
        signguCode,
        thema
    FROM __dbt__cte__src_tourist_spot
), kd AS(
    SELECT * FROM __dbt__cte__src_korea_dept
), tmp AS(
SELECT
    ts.spotName,
    ts.thema,
    sg.signguCode,
    sg.cityNm,
    sg.signguNm
FROM ts
LEFT JOIN sg ON ts.signguCode = sg.signguCode
)

SELECT
    spotName,
    thema,
    signguCode,
    tmp.cityNm,
    signguNm,
    deptId
FROM tmp
LEFT JOIN kd ON tmp.cityNm = kd.cityNm
  );
[0m10:15:18.310105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.317115 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.317115 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot" rename to "dim_tourist_spot__dbt_backup"
[0m10:15:18.383368 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.387368 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.387368 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
alter table "dev"."wnsldjqja"."dim_tourist_spot__dbt_tmp" rename to "dim_tourist_spot"
[0m10:15:18.425858 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.443860 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:15:18.444862 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.444862 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:15:18.532114 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.533114 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.534114 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:15:18.555116 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.561116 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup"
[0m10:15:18.566115 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.567116 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.dim_tourist_spot"} */
drop table if exists "dev"."wnsldjqja"."dim_tourist_spot__dbt_backup" cascade
[0m10:15:18.593121 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.594121 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:15:18.595120 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.595120 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: COMMIT
[0m10:15:18.666999 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.667999 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.dim_tourist_spot"
[0m10:15:18.669000 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: BEGIN
[0m10:15:18.679711 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:18.681721 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: ROLLBACK
[0m10:15:18.703757 [debug] [Thread-1 (]: On model.weather_tour_dbt.dim_tourist_spot: Close
[0m10:15:18.704768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D214E9D90>]}
[0m10:15:18.705766 [info ] [Thread-1 (]: 1 of 4 OK created sql table model wnsldjqja.dim_tourist_spot ................... [[32mSUCCESS[0m in 0.84s]
[0m10:15:18.706770 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.dim_tourist_spot
[0m10:15:18.707771 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.fact_tour_weather
[0m10:15:18.707771 [info ] [Thread-1 (]: 2 of 4 START sql incremental model wnsldjqja.fact_tour_weather ................. [RUN]
[0m10:15:18.708770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.dim_tourist_spot, now model.weather_tour_dbt.fact_tour_weather)
[0m10:15:18.708770 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.fact_tour_weather
[0m10:15:18.730769 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:18.731770 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.fact_tour_weather
[0m10:15:18.763771 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:18.763771 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

    
  
    

  create temporary table
    "fact_tour_weather__dbt_tmp101518751770"
    
    
    
  as (
    
WITH  __dbt__cte__src_weather_api as (
WITH src_weather_api AS (
    SELECT * FROM wnsldjqja.weather_info
)
SELECT
    spotName,
    tm,
    courseAreaId,
    spotAreaName,
    th3,
    ws,
    sky,
    rhm,
    pop
FROM
    src_weather_api
),  __dbt__cte__src_signgu as (
WITH src_signgu AS (
    SELECT * FROM wnsldjqja.signgu
)
SELECT 
    "시군구코드" signguCode, 
    "시도명" cityNm,
    "시군구명" signguNm
FROM
    src_signgu
),  __dbt__cte__src_tour_api as (
WITH src_tour_api AS (
    SELECT * FROM wnsldjqja.tourism
), src_signgu AS(
    SELECT * FROM __dbt__cte__src_signgu
)
SELECT 
    left(signguCode,5) signguCode,
    baseYmd,
    daywkDivNm,
    touDivNm,
    touNum
FROM src_tour_api
), src_weather_tot AS (
    SELECT
        a.spotName,
        tm,
        th3,
        ws,
        sky,
        rhm,
        pop,
        b.signguCode,
        b.signguNm,
        b.cityNm
    FROM __dbt__cte__src_weather_api a
    LEFT JOIN "dev"."wnsldjqja"."dim_tourist_spot" b
    ON a.spotName = b.spotName
), src_tour_api AS (
    SELECT
        a.signguCode,
        b.cityNm,
        b.signguNm,
        baseYmd,
        daywkDivNm,
        touDivNm,
        touNum
    FROM __dbt__cte__src_tour_api a
    JOIN __dbt__cte__src_signgu b
    ON a.signguCode = b.signguCode
), tmp AS(
    SELECT
        baseYmd,
        date_part('hour',tm) tm_hour,
        spotName,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm
    FROM src_weather_tot a
    JOIN src_tour_api b
    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)
    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')
)
SELECT * FROM tmp
WHERE baseYmd is not NULL

    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from "dev"."wnsldjqja"."fact_tour_weather")

  );
[0m10:15:18.764770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:18.764770 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:18.765771 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:23.087941 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m10:15:23.103944 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:23.104946 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: BEGIN
[0m10:15:23.129381 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:23.129381 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:23.130384 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp101518751770'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp101518751770'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp101518751770'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:15:23.547717 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:23.561729 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:23.562728 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:15:23.938103 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:23.962103 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:23.963105 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather__dbt_tmp101518751770'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather__dbt_tmp101518751770'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'None'
        and tablename = 'fact_tour_weather__dbt_tmp101518751770'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    order by ordinal_position
[0m10:15:24.357102 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:24.370102 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:24.371103 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      with bound_views as (
        select
          ordinal_position,
          table_schema,
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

        from information_schema."columns"
        where table_name = 'fact_tour_weather'
    ),

    unbound_views as (
      select
        ordinal_position,
        view_schema,
        col_name,
        case
          when col_type ilike 'character varying%' then
            'character varying'
          when col_type ilike 'numeric%' then 'numeric'
          else col_type
        end as col_type,
        case
          when col_type like 'character%'
          then nullif(REGEXP_SUBSTR(col_type, '[0-9]+'), '')::int
          else null
        end as character_maximum_length,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when col_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(col_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale

      from pg_get_late_binding_view_cols()
      cols(view_schema name, view_name name, col_name name,
           col_type varchar, ordinal_position int)
      where view_name = 'fact_tour_weather'
    ),

    external_views as (
      select
        columnnum,
        schemaname,
        columnname,
        case
          when external_type ilike 'character varying%' or external_type ilike 'varchar%'
          then 'character varying'
          when external_type ilike 'numeric%' then 'numeric'
          else external_type
        end as external_type,
        case
          when external_type like 'character%' or external_type like 'varchar%'
          then nullif(
            REGEXP_SUBSTR(external_type, '[0-9]+'),
            '')::int
          else null
        end as character_maximum_length,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 1),
            '')::int
          else null
        end as numeric_precision,
        case
          when external_type like 'numeric%'
          then nullif(
            SPLIT_PART(REGEXP_SUBSTR(external_type, '[0-9,]+'), ',', 2),
            '')::int
          else null
        end as numeric_scale
      from
        pg_catalog.svv_external_columns
      where
        schemaname = 'wnsldjqja'
        and tablename = 'fact_tour_weather'

    ),

    unioned as (
      select * from bound_views
      union all
      select * from unbound_views
      union all
      select * from external_views
    )

    select
      column_name,
      data_type,
      character_maximum_length,
      numeric_precision,
      numeric_scale

    from unioned
    
    where table_schema = 'wnsldjqja'
    
    order by ordinal_position
[0m10:15:24.550657 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:24.559656 [debug] [Thread-1 (]: 
    In "dev"."wnsldjqja"."fact_tour_weather":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:15:24.570654 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:24.573654 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:24.574654 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.fact_tour_weather"} */

      
        
            delete from "dev"."wnsldjqja"."fact_tour_weather"
            where (
                baseYmd || tm_hour || spotName) in (
                select (baseYmd || tm_hour || spotName)
                from "fact_tour_weather__dbt_tmp101518751770"
            );
[0m10:15:25.356761 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m10:15:25.356761 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:25.357761 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: insert into "dev"."wnsldjqja"."fact_tour_weather" ("baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm")
    (
        select "baseymd", "tm_hour", "spotname", "th3", "ws", "sky", "rhm", "pop", "daywkdivnm", "tounum", "toudivnm"
        from "fact_tour_weather__dbt_tmp101518751770"
    )
[0m10:15:25.429490 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:25.431492 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:15:25.431492 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.fact_tour_weather"
[0m10:15:25.432490 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: COMMIT
[0m10:15:25.484781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:25.485780 [debug] [Thread-1 (]: On model.weather_tour_dbt.fact_tour_weather: Close
[0m10:15:25.486781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D21AFFE00>]}
[0m10:15:25.487780 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model wnsldjqja.fact_tour_weather ............ [[32mSUCCESS[0m in 6.78s]
[0m10:15:25.488783 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.fact_tour_weather
[0m10:15:25.489781 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:15:25.490780 [info ] [Thread-1 (]: 3 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city .......... [RUN]
[0m10:15:25.491780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.fact_tour_weather, now model.weather_tour_dbt.analytics_tour_weather_by_city)
[0m10:15:25.491780 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:15:25.494780 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:25.495780 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:15:25.499780 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:25.506780 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:25.507780 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:15:25.507780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:25.508781 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:25.508781 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:25.698801 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:25.699800 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:25.699800 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp"
    
    
    
  as (
    WITH dim_tourist_spot AS (
    SELECT * FROM "dev"."wnsldjqja"."dim_tourist_spot"
), fact_tour_weather AS(
    SELECT * FROM "dev"."wnsldjqja"."fact_tour_weather"
), tmp1 AS(
    SELECT
        a.spotName,
        signguNm,
        baseYmd,
        CASE WHEN extract('MONTH' from baseYmd) in (3,4,5) THEN 'SPRING'
        WHEN extract('MONTH' from baseYmd) in (6,7,8) THEN 'SUMMER'
        WHEN extract('MONTH' from baseYmd) in (9,10,11) THEN 'FALL'
        ELSE 'WINTER'
        END AS season,
        tm_hour,
        th3,
        ws,
        sky,
        rhm,
        pop,
        daywkDivNm,
        touNum,
        touDivNm,
        cityNm,
        signguCode,
        deptId
    FROM fact_tour_weather a
    LEFT JOIN dim_tourist_spot b
    ON a.spotName = b.spotName
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    season,
    tm_hour,
    touDivNm,
    daywkDivNm,
    deptId,
    AVG(touNum) touNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM tmp1
GROUP BY signguCode, cityNm, signguNm, baseYmd, season, tm_hour, touDivNm, daywkDivNm, deptId
  );
[0m10:15:49.735663 [debug] [Thread-1 (]: SQL status: SUCCESS in 24.0 seconds
[0m10:15:49.739356 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.739883 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city" rename to "analytics_tour_weather_by_city__dbt_backup"
[0m10:15:49.796445 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.801444 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.801444 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_tmp" rename to "analytics_tour_weather_by_city"
[0m10:15:49.832109 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.834111 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:15:49.834111 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.835109 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:15:49.886513 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.886513 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.887526 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:15:49.904538 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.907538 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup"
[0m10:15:49.908539 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.908539 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city__dbt_backup" cascade
[0m10:15:49.930854 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.931866 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:15:49.931866 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.932866 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: COMMIT
[0m10:15:49.984769 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.984769 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city"
[0m10:15:49.985781 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: BEGIN
[0m10:15:49.994702 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:49.995703 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: ROLLBACK
[0m10:15:50.013730 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city: Close
[0m10:15:50.014740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D21BC63F0>]}
[0m10:15:50.014740 [info ] [Thread-1 (]: 3 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city ..... [[32mSUCCESS[0m in 24.52s]
[0m10:15:50.015739 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city
[0m10:15:50.016742 [debug] [Thread-1 (]: Began running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:15:50.016742 [info ] [Thread-1 (]: 4 of 4 START sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [RUN]
[0m10:15:50.017741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.weather_tour_dbt.analytics_tour_weather_by_city, now model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv)
[0m10:15:50.017741 [debug] [Thread-1 (]: Began compiling node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:15:50.020740 [debug] [Thread-1 (]: Writing injected SQL for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:15:50.021740 [debug] [Thread-1 (]: Began executing node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:15:50.024741 [debug] [Thread-1 (]: Writing runtime sql for node "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:15:50.027739 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:15:50.028743 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:15:50.028743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:50.029740 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:15:50.029740 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:15:50.204273 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:15:50.205273 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:15:50.205273 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */

  
    

  create  table
    "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp"
    
    
    
  as (
    WITH analytics_tour_weather_by_city AS (
    SELECT * FROM "dev"."wnsldjqja"."analytics_tour_weather_by_city"
)
SELECT
    signguCode,
    cityNm,
    signguNm,
    baseYmd,
    season,
    tm_hour,
    daywkDivNm,
    deptId,
    SUM(touNum) totTouNum,
    ROUND(AVG(th3),0) th3,
    ROUND(AVG(ws),0) ws,
    ROUND(AVG(sky),0) sky,
    ROUND(AVG(rhm),0) rhm,
    ROUND(AVG(pop),0) pop
FROM analytics_tour_weather_by_city
GROUP BY signguCode, cityNm, signguNm, baseYmd, season, tm_hour, daywkDivNm, deptId
  );
[0m10:16:08.960096 [debug] [Thread-1 (]: SQL status: SUCCESS in 19.0 seconds
[0m10:16:08.964100 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:08.965101 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv" rename to "analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m10:16:09.022098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.025100 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.025100 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
alter table "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_tmp" rename to "analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.055096 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.057102 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:16:09.058100 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.058100 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:16:09.113096 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.114097 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.115101 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:16:09.136100 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.139098 [debug] [Thread-1 (]: Applying DROP to: "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup"
[0m10:16:09.140100 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.141099 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "weather_tour_dbt", "target_name": "dev", "node_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"} */
drop table if exists "dev"."wnsldjqja"."analytics_tour_weather_by_city_not_toudiv__dbt_backup" cascade
[0m10:16:09.163097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.165099 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:16:09.166099 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.167099 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: COMMIT
[0m10:16:09.210847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.211889 [debug] [Thread-1 (]: Using redshift connection "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv"
[0m10:16:09.212413 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: BEGIN
[0m10:16:09.222993 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.224041 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: ROLLBACK
[0m10:16:09.242347 [debug] [Thread-1 (]: On model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv: Close
[0m10:16:09.243347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f43dcfa-6035-4cee-83c2-8a1850253f03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D21B44FE0>]}
[0m10:16:09.244346 [info ] [Thread-1 (]: 4 of 4 OK created sql table model wnsldjqja.analytics_tour_weather_by_city_not_toudiv  [[32mSUCCESS[0m in 19.23s]
[0m10:16:09.245348 [debug] [Thread-1 (]: Finished running node model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv
[0m10:16:09.247189 [debug] [MainThread]: Using redshift connection "master"
[0m10:16:09.247716 [debug] [MainThread]: On master: BEGIN
[0m10:16:09.248224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:09.248821 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:16:09.249327 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:16:09.432425 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.433426 [debug] [MainThread]: On master: COMMIT
[0m10:16:09.433426 [debug] [MainThread]: Using redshift connection "master"
[0m10:16:09.434426 [debug] [MainThread]: On master: COMMIT
[0m10:16:09.452427 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m10:16:09.453426 [debug] [MainThread]: On master: Close
[0m10:16:09.454427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:09.454427 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:16:09.454427 [debug] [MainThread]: Connection 'list_dev_wnsldjqja' was properly closed.
[0m10:16:09.455427 [debug] [MainThread]: Connection 'model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv' was properly closed.
[0m10:16:09.455427 [info ] [MainThread]: 
[0m10:16:09.456426 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 52.88 seconds (52.88s).
[0m10:16:09.457426 [debug] [MainThread]: Command end result
[0m10:16:09.563426 [info ] [MainThread]: 
[0m10:16:09.564428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:09.565428 [info ] [MainThread]: 
[0m10:16:09.566427 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:16:09.567428 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:09.567428 after 53.87 seconds
[0m10:16:09.568427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1F6BDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1BE44EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1BDB98B0>]}
[0m10:16:09.569427 [debug] [MainThread]: Flushing usage events
[0m14:24:17.312956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de6bfc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de6427fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de719aa90>]}


============================== 14:24:17.321014 | bc2f4392-5f5d-4030-bd0a-e5a86cf419e9 ==============================
[0m14:24:17.321014 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:24:17.322031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m14:24:17.418504 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:24:17.419423 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:24:17.616752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de31f3a90>]}
[0m14:24:17.680256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de4f11d00>]}
[0m14:24:17.681429 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:24:17.705748 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:24:17.835724 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:24:17.836602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de5d0b9a0>]}
[0m14:24:19.395968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de21171f0>]}
[0m14:24:19.686424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de20137c0>]}
[0m14:24:19.811510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de201cf10>]}
[0m14:24:19.812349 [info ] [MainThread]: Found 9 models, 3 seeds, 486 macros
[0m14:24:19.812991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc2f4392-5f5d-4030-bd0a-e5a86cf419e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de201caf0>]}
[0m14:24:19.814879 [info ] [MainThread]: 
[0m14:24:19.815690 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:24:19.820995 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m14:24:19.840940 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:24:19.841668 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:24:19.842190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:19.846607 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:24:19.847802 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:24:20.142047 [debug] [ThreadPool]: Redshift adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:24:20.143026 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m14:24:20.143813 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m14:24:20.144440 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m14:24:20.145077 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m14:24:20.146170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:20.146700 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:24:20.147270 [info ] [MainThread]: 
[0m14:24:20.147984 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:24:20.148820 [error] [MainThread]: Encountered an error:
Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "wnsldjqja"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}
[0m14:24:20.150048 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.910402, "process_user_time": 3.908139, "process_kernel_time": 0.200417, "process_mem_max_rss": "225472", "process_in_blocks": "9352", "process_out_blocks": "952", "command_success": false}
[0m14:24:20.150967 [debug] [MainThread]: Command `dbt seed` failed at 14:24:20.150819 after 2.91 seconds
[0m14:24:20.151716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de6bfc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de1f61460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1de1fcba30>]}
[0m14:24:20.152352 [debug] [MainThread]: Flushing usage events
[0m14:24:55.166784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2df1ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c46a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c46ad30>]}


============================== 14:24:55.172489 | cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670 ==============================
[0m14:24:55.172489 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:24:55.173287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:55.259847 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m14:24:55.260762 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m14:24:55.457225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2a38c340>]}
[0m14:24:55.517096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2c425d00>]}
[0m14:24:55.518313 [info ] [MainThread]: Registered adapter: redshift=1.8.1
[0m14:24:55.541513 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m14:24:55.904032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:55.904889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:55.957100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2a0b88e0>]}
[0m14:24:56.090930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2a2f7040>]}
[0m14:24:56.092003 [info ] [MainThread]: Found 9 models, 3 seeds, 486 macros
[0m14:24:56.092706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb75a5f3-8bdf-493b-bcc2-dbc1ac9fe670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2a435040>]}
[0m14:24:56.095025 [info ] [MainThread]: 
[0m14:24:56.096160 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m14:24:56.101713 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m14:24:56.123652 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m14:24:56.124492 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:24:56.125061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:56.129695 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m14:24:56.131079 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m14:24:56.337747 [debug] [ThreadPool]: Redshift adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "weather_tour_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m14:24:56.338553 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m14:24:56.339397 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m14:24:56.339931 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m14:24:56.340501 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m14:24:56.341565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:56.342113 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m14:24:56.342670 [info ] [MainThread]: 
[0m14:24:56.343318 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:24:56.344121 [error] [MainThread]: Encountered an error:
Database Error
  {'S': 'FATAL', 'C': '28000', 'M': 'password authentication failed for user "wnsldjqja"', 'F': '/home/ec2-user/padb/src/pg/src/backend/libpq/auth.c', 'L': '425', 'R': 'auth_failed'}
[0m14:24:56.345262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2465469, "process_user_time": 2.490782, "process_kernel_time": 0.109157, "process_mem_max_rss": "225472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:24:56.346072 [debug] [MainThread]: Command `dbt run` failed at 14:24:56.345965 after 1.25 seconds
[0m14:24:56.346688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2df1ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f29fd06a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2a1facd0>]}
[0m14:24:56.347261 [debug] [MainThread]: Flushing usage events
